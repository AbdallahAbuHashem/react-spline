(this["webpackJsonpreact-spline-example"]=this["webpackJsonpreact-spline-example"]||[]).push([[0],[,,,,function(module,exports,__webpack_require__){function _interopDefault(e){return e&&"object"===typeof e&&"default"in e?e.default:e}var React=__webpack_require__(0),three=__webpack_require__(14),anime$1=_interopDefault(__webpack_require__(12)),styles={canvas:"_styles-module__canvas__3yjUb",container:"_styles-module__container__1Lxpd"};function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _unsupportedIterableToArray(e,t){if(e){if("string"===typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function _createForOfIteratorHelperLoose(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=e[Symbol.iterator]()).next.bind(i)}window.THREE=three,window.anime=anime$1,window.SPE=window.SPE||{},window.SPE_USES_PREVIEW_IMAGE=!1,window.SPE=window.SPE||{};var UNSIGNED_BYTE=5121,UNSIGNED_SHORT=5123,UNSIGNED_INT=5125,FLOAT=5126,SPE_LAYER_TYPE_LIGHTING="light",SPE_LAYER_TYPE_COLOR="color",SPE_LAYER_TYPE_GRADIENT="gradient",SPE_LAYER_TYPE_NORMAL="normal",SPE_LAYER_TYPE_DEPTH="depth",SPE_LAYER_TYPE_TEXTURE="texture",SPE_LAYER_TYPE_NOISE="noise",SPE_LAYER_TYPE_FRESNEL="fresnel",SPE_LAYER_TYPE_POINTS="points",SPE_LAYER_TYPE_LINES="lines",SPE_LAYER_UNIFORM_TYPE_BOOL=0,SPE_LAYER_UNIFORM_TYPE_INT=1,SPE_LAYER_UNIFORM_TYPE_FLOAT=2,SPE_LAYER_UNIFORM_TYPE_VEC2=3,SPE_LAYER_UNIFORM_TYPE_VEC3=4,SPE_LAYER_UNIFORM_TYPE_VEC4=5,SPE_LAYER_UNIFORM_TYPE_COLOR=6,SPE_LAYER_UNIFORM_TYPE_ARRAY_INT=7,SPE_LAYER_UNIFORM_TYPE_ARRAY_FLOAT=8,SPE_LAYER_UNIFORM_TYPE_ARRAY_VEC2=9,SPE_LAYER_UNIFORM_TYPE_ARRAY_VEC3=10,SPE_LAYER_UNIFORM_TYPE_ARRAY_VEC4=11,SPE_LAYER_UNIFORM_TYPE_ARRAY_COLOR=12,SPE_LAYER_UNIFORM_TYPE_MAT3=13,SPE_LAYER_UNIFORM_TYPE_MAT4=14,SPE_LAYER_UNIFORM_TYPE_SAMPLER_2D=15,SPE_COLOR_DEFAULT=8026746,SPE_BLENDING_NORMAL=0,SPE_RUNTIME_VIEWMODE_FULLSCREEN=1,SPE_RUNTIME_VIEWMODE_FULL_WIDTH=3,SPE_RUNTIME_VIEWMODE_FULL_HEIGHT=4,SPE_RUNTIME_QUALITY_DEFAULT="default";SPE.QualityModifiers={SphereGeometry:{widthSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:128},heightSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:128}},CubeGeometry:{cornerSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:128}},ConeGeometry:{radialSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:64},heightSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:64},cornerSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:64}},CylinderGeometry:{radialSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:64},cornerSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:64}},EllipseGeometry:{spikes:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:64}},PolygonGeometry:{extrudeBevelSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:16}},RectangleGeometry:{extrudeBevelSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:16}},StarGeometry:{extrudeBevelSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:16}},TorusGeometry:{radialSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:64},tubularSegments:{scalers:{high:2,middle:1,low:.5,default:1},minValue:1,maxValue:128}}};var SpeGltfDecoder=function(){function e(e){this.mGltfSceneGraph=e,this.mSceneGraph=null,this.mSceneCamera=null,this.mSceneOptions={},this.mNodes=[],this.mCameras=[],this.mLights=[],this.mGeometries=[],this.mGeometriesSpe=[],this.mAccessors=[],this.mMaterials=[]}var t=e.prototype;return t.decode=function(e){e&&(this.mGltfSceneGraph=e),this.mSceneGraph=new SpeScene,this.mSceneCamera=null,this.mSceneOptions={},this.mNodes=[this.mSceneGraph],this.mObjects={},this.mCameras=[],this.mLights=[],this.mGeometries=[],this.mGeometriesSpe=[],this.mAccessors=[],this.mMaterials=[],this.mInteractionStates={},void 0!==this.mGltfSceneGraph.spline&&(this.mSceneOptions.usePrimitives=void 0===this.mGltfSceneGraph.spline.usePrimitives||this.mGltfSceneGraph.spline.usePrimitives,this.mSceneOptions.useOrbitControls=void 0===this.mGltfSceneGraph.spline.useOrbitControls||this.mGltfSceneGraph.spline.useOrbitControls,this.mSceneOptions.bgColor=void 0!==this.mGltfSceneGraph.spline.bgColor?this.mGltfSceneGraph.spline.bgColor:new THREE.Color(1644825),this.mSceneOptions.bgAlpha=void 0!==this.mGltfSceneGraph.spline.bgAlpha?this.mGltfSceneGraph.spline.bgAlpha:0,this.mSceneOptions.orbitDamped=void 0!==this.mGltfSceneGraph.spline.orbitDamped&&this.mGltfSceneGraph.spline.orbitDamped,this.mSceneOptions.orbitTarget=void 0!==this.mGltfSceneGraph.spline.orbitTarget?this.mGltfSceneGraph.spline.orbitTarget:[0,0,0],this.mSceneOptions.cameraType=void 0!==this.mGltfSceneGraph.spline.cameraType?this.mGltfSceneGraph.spline.cameraType:"Orthographic",this.mSceneOptions.cameraRotate=void 0===this.mGltfSceneGraph.spline.cameraRotate||this.mGltfSceneGraph.spline.cameraRotate,this.mSceneOptions.cameraPan=void 0===this.mGltfSceneGraph.spline.cameraPan||this.mGltfSceneGraph.spline.cameraPan,this.mSceneOptions.cameraZoom=void 0===this.mGltfSceneGraph.spline.cameraZoom||this.mGltfSceneGraph.spline.cameraZoom,this.mSceneOptions.viewMode=void 0!==this.mGltfSceneGraph.spline.viewMode?this.mGltfSceneGraph.spline.viewMode:SPE_RUNTIME_VIEWMODE_FULLSCREEN,this.mSceneOptions.viewWidth=void 0!==this.mGltfSceneGraph.spline.viewWidth?this.mGltfSceneGraph.spline.viewWidth:1024,this.mSceneOptions.viewHeight=void 0!==this.mGltfSceneGraph.spline.viewHeight?this.mGltfSceneGraph.spline.viewHeight:768,this.mSceneOptions.quality=void 0!==this.mGltfSceneGraph.spline.quality?this.mGltfSceneGraph.spline.quality:SPE_RUNTIME_QUALITY_DEFAULT);var t="function"==typeof Interaction;if(t){if(SPE.CachedImages={},this.mGltfSceneGraph.spline&&this.mGltfSceneGraph.spline.images)for(var i=this.mGltfSceneGraph.spline.images,r=0,a=Object.entries(i);r<a.length;r++){var n=a[r],o=n[0],s=n[1],h=new Image;h.src=s.url,SPE.CachedImages[o]=h}if(SPE.CachedTextures={},this.mGltfSceneGraph.spline&&this.mGltfSceneGraph.spline.textures)for(var l=this.mGltfSceneGraph.spline.textures,d=0,c=Object.entries(l);d<c.length;d++){var m=c[d],u=m[0],p=m[1],f=p.image,v=SPE.CachedImages[f],E=new THREE.Texture(v,p.mapping,p.wrap[0],p.wrap[1],p.magFilter,p.minFilter,p.format,p.type,p.anisotropy,p.encoding);E.offset.fromArray(p.offset),E.repeat.fromArray(p.repeat),E.center.fromArray(p.center),E.updateMatrix(),SPE.CachedTextures[u]=E}if(this.mGltfSceneGraph.spline&&this.mGltfSceneGraph.spline.interactionStates)for(var g=this.mGltfSceneGraph.spline.interactionStates,y=0,_=Object.entries(g);y<_.length;y++){var S=_[y],x=S[0],b=S[1];this.mInteractionStates[x]=(new InteractionState).fromJSON(b,SPE.CachedTextures)}}for(var w=this.mGltfSceneGraph.cameras||[],T=0;T<w.length;T++)this._decodeCamera(w[T]);if(this.mGltfSceneGraph.extensions&&this.mGltfSceneGraph.extensions.KHR_lights_punctual&&this.mGltfSceneGraph.extensions.KHR_lights_punctual.lights)for(var R=this.mGltfSceneGraph.extensions.KHR_lights_punctual.lights,M=0;M<R.length;M++)this._decodeLight(R[M]);this._constructGeometricData();for(var L=this.mGltfSceneGraph.materials||[],I=0;I<L.length;I++)this._decodeMaterial(L[I]);for(var P=this.mGltfSceneGraph.meshes_spe||[],H=0;H<P.length;H++)this._decodeSpeGeometry(P[H]);for(var A=this.mGltfSceneGraph.meshes||[],C=0;C<A.length;C++)this._decodeGeometry(A[C]);for(var D=this.mGltfSceneGraph.nodes||[],O=1;O<D.length;O++)this._decodeNode(D[O]);if(t&&this.mGltfSceneGraph.spline&&this.mGltfSceneGraph.spline.interactions)for(var B=this.mGltfSceneGraph.spline.interactions,U=0;U<D.length;U++){var G=D[U];if(void 0!==G.spe_interaction&&null!==G.spe_interaction){var z=G.spe_interaction;if(z<B.length&&z>=0){var N=B[z],V=this.mInteractionStates,F=this.mObjects;this.mNodes[U].interaction.fromJSON(N,F,V)}}}for(var j=this.mGltfSceneGraph.nodes[0],Y=new SpeStack,k=0;k<j.children.length;k++)Y.push([j.children[k],this.mSceneGraph]);for(;!Y.empty();){var W=Y.pop(),X=W[0],q=W[1];if(X<this.mNodes.length&&X>=0){var J=this.mNodes[X];if(!J)continue;q&&q.add(J);var K=this.mGltfSceneGraph.nodes[X].children;if(void 0!==K)for(var Z=0;Z<K.length;Z++)Y.push([K[Z],J])}}if(void 0!==this.mGltfSceneGraph.spline&&this.mGltfSceneGraph.spline.fog){var Q=this.mGltfSceneGraph.spline.fog,$=void 0!==Q.color?Q.color:16777215,ee=void 0!==Q.near?Q.near:500,te=void 0!==Q.far?Q.far:2e3;this.mSceneGraph.fog=new THREE.Fog($,ee,te)}if(void 0!==this.mGltfSceneGraph.spline&&void 0!==this.mGltfSceneGraph.spline.mainCameraIndex){var ie=this.mGltfSceneGraph.spline.mainCameraIndex;ie<this.mNodes.length&&ie>=0&&(this.mSceneCamera=this.mNodes[ie])}return[this.mSceneGraph,this.mSceneCamera,this.mSceneOptions]},t._decodeCamera=function(e){var t=void 0!==e.type?e.type:"Perspective",i=100,r=100,a=45,n=.1,o=5e4,s=null;if("Perspective"===t){var h=e.perspective?e.perspective:{},l=e.spe_options?e.spe_options:{};a=void 0!==h.yfov?h.yfov:45,n=void 0!==h.znear?h.znear:.1,o=void 0!==h.zfar?h.zfar:5e4,(s=new SPE.CombinedCamera(i,r,a,n,o)).toPerspective();var d=void 0!==l.zoom?l.zoom:1;s.zoom=d}else if("Orthographic"===t){var c=e.orthographic?e.orthographic:{},m=e.spe_options?e.spe_options:{};i=void 0!==c.xmag?c.xmag:100,r=void 0!==c.ymag?c.ymag:100,n=void 0!==c.znear?c.znear:.1,o=void 0!==c.zfar?c.zfar:5e4,(s=new SPE.CombinedCamera(i,r,a,n,o)).toOrthographic();var u=void 0!==m.zoom?m.zoom:1;s.zoom=u}else console.warn("SpeGltfDecoder::_decodeCamera >>> unsupported camera type: "+t+". Using Orthographic instead"),(s=new SPE.CombinedCamera(i,r,a,n,o)).toOrthographic();this.mCameras.push(s)},t._decodeLight=function(e){if("hemispheric"===e.type){var t=(new THREE.Color).fromArray(void 0!==e.color?e.color:[1,1,1]),i=(new THREE.Color).setHex(8553090),r=e.intensity?e.intensity:1;this.mLights.push(new THREE.HemisphereLight(t,i,r))}else if("directional"===e.type){var a=new SPE.LightDirectional((new THREE.Color).fromArray(e.color),e.intensity),n=e.shadows||{};a.castShadow=void 0!==n.castShadow&&n.castShadow,a.shadow.camera.right=void 0!==n.shadowmapViewRight?n.shadowmapViewRight:1250,a.shadow.camera.left=void 0!==n.shadowmapViewLeft?n.shadowmapViewLeft:-1250,a.shadow.camera.top=void 0!==n.shadowmapViewTop?n.shadowmapViewTop:1250,a.shadow.camera.bottom=void 0!==n.shadowmapViewBottom?n.shadowmapViewBottom:-1250,a.shadow.camera.near=void 0!==n.shadowmapViewNear?n.shadowmapViewNear:1,a.shadow.camera.far=void 0!==n.shadowmapViewFar?n.shadowmapViewFar:2500,this.mLights.push(a)}else if("point"===e.type){var o=(new THREE.Color).fromArray(void 0!==e.color?e.color:[1,1,1]),s=e.intensity?e.intensity:1,h=void 0!==e.range?e.range:0,l=void 0!==e.decay?e.decay:1,d=new SPE.LightPoint(o,s,h,l),c=e.shadows||{};d.castShadow=void 0!==c.castShadow&&c.castShadow,d.shadow.camera.near=void 0!==c.shadowmapViewNear?c.shadowmapViewNear:1,d.shadow.camera.far=void 0!==c.shadowmapViewFar?c.shadowmapViewFar:2500,this.mLights.push(d)}else if("spot"===e.type){var m=(new THREE.Color).fromArray(void 0!==e.color?e.color:[1,1,1]),u=e.intensity?e.intensity:1,p=void 0!==e.range?e.range:0,f=void 0!==e.decay?e.decay:1,v=void 0!==e.innerConeAngle?e.innerConeAngle:Math.PI/3,E=void 0!==e.penumbra?e.penumbra:0,g=new SPE.LightSpot(m,u,p,v,E,f),y=e.shadows||{};g.castShadow=void 0!==y.castShadow&&y.castShadow,g.shadow.camera.fov=void 0!==y.shadowmapViewFov?y.shadowmapViewFov:2*THREE.MathUtils.RAD2DEG*v,g.shadow.camera.near=void 0!==y.shadowmapViewNear?y.shadowmapViewNear:1,g.shadow.camera.far=void 0!==y.shadowmapViewFar?y.shadowmapViewFar:2500,this.mLights.push(g)}else console.error("SpeGltfDecoder::_decodeLight >>> unsupported light type: ",e.type)},t._constructGeometricData=function(){for(var e=this.mGltfSceneGraph.buffers,t=[],i=0;i<e.length;i++)t.push(this._decodeBuffer(e[i]));for(var r=this.mGltfSceneGraph.bufferViews,a=[],n=0;n<r.length;n++)a.push(this._decodeBufferView(r[n],t));for(var o=this.mGltfSceneGraph.accessors,s=0;s<o.length;s++)this.mAccessors.push(this._decodeAccessor(o[s],a))},t._decodeBuffer=function(e){var t=e.byteLength,i=e.uri;if(i.indexOf("base64")){for(var r=i.slice(i.indexOf("base64")+7),a=atob(r),n=new Uint8Array(r.length),o=0;o<a.length;o++)n[o]=a.charCodeAt(o);return{data:n,length:t}}return i.indexOf(".bin")?(console.error("SpeGltfDecoder::_decodeBuffer >>> encode-from-.bin is not implement yet"),""):(console.error("SpeGltfDecoder::_decodeBuffer >>> invalid options to parse buffer data"),"")},t._decodeBufferView=function(e,t){var i=e.byteLength,r=e.byteOffset,a=e.buffer,n=e.target;return a<t.length&&a>=0?{data:t[a].data.slice(r,r+i),length:i,target:n}:(console.error("SpeGltfDecoder::_decodeBufferView >>> index-out-of-range in buffers array"),{})},t._decodeAccessor=function(e,t){var i=e.bufferView,r=e.byteOffset,a=e.componentType,n=e.count,o=e.type;if(i<t.length&&i>=0){var s=t[i].data,h=this._getAccessorItemSize(o),l=n*h*this._getAccessorComponentSize(a),d=s.slice(r,r+l),c=null;return a===UNSIGNED_SHORT?c=this._createUint16Buffer(d):a===UNSIGNED_INT?c=this._createUint32Buffer(d):a===FLOAT&&(c=this._createFloat32Buffer(d)),c?this._createBufferAttribute(c,h):(console.error("SpeGltfDecoder::_decodeAccessor >>> invalid component-type given"),null)}return console.error("SpeGltfDecoder::_decodeAccessor >>> index-out-of-range in bufferViews array"),null},t._decodeMaterial=function(e){var t=Object.entries(e)[0][1];void 0!==t.extensions&&void 0!==t.extensions.KHR_materials_common?this._decodeSimpleMaterial(t.extensions.KHR_materials_common,t.spe_options,t.spe_layers):this._decodePbrMaterial(t)},t._decodeSimpleMaterial=function(e,t,i){var r=e.technique||"PHONG",a=e.values||{},n=t||{},o=i||{};if("PHONG"===r){var s=(new THREE.Color).fromArray(void 0!==a.diffuse?a.diffuse:[.5,.5,.5]),h=(new THREE.Color).fromArray(void 0!==a.specular?a.specular:[.5,.5,.5]),l=(new THREE.Color).fromArray(void 0!==a.emission?a.emission:[0,0,0]),d=void 0!==a.shininess?a.shininess:32,c=void 0!==a.transparent&&a.transparent,m=void 0!==a.transparency?a.transparency:1,u=void 0===n.visible||n.visible,p=void 0!==n.wireframe&&n.wireframe,f=void 0!==n.side?n.side:THREE.FrontSide,v=void 0!==n.flatShading&&n.flatShading,E=new SpePhongMaterial(o,{color:s,specular:h,emissive:l,shininess:d,transparent:c,opacity:m,flatShading:v,side:f,wireframe:p,visible:u});this.mMaterials.push(E)}else if("LAMBERT"===r){var g=(new THREE.Color).fromArray(void 0!==a.diffuse?a.diffuse:[.5,.5,.5]),y=(new THREE.Color).fromArray(void 0!==a.emission?a.emission:[0,0,0]),_=void 0!==a.transparent&&a.transparent,S=void 0!==a.transparency?a.transparency:1,x=void 0===n.visible||n.visible,b=void 0!==n.wireframe&&n.wireframe,w=void 0!==n.side?n.side:THREE.FrontSide,T=void 0!==n.flatShading&&n.flatShading,R=new SpeLambertMaterial(o,{color:g,emissive:y,transparent:_,opacity:S,flatShading:T,side:w,wireframe:b,visible:x});this.mMaterials.push(R)}else if("CONSTANT"===r){var M=(new THREE.Color).fromArray(void 0!==a.ambient?a.ambient:[.5,.5,.5]),L=void 0!==a.transparent&&a.transparent,I=void 0!==a.transparency?a.transparency:1,P=void 0===n.visible||n.visible,H=void 0!==n.wireframe&&n.wireframe,A=void 0!==n.side?n.side:THREE.FrontSide,C=void 0!==n.flatShading&&n.flatShading,D=new SpeBasicMaterial(o,{color:M,transparent:L,opacity:I,flatShading:C,side:A,wireframe:H,visible:P});this.mMaterials.push(D)}else if("TOON"===r){var O=(new THREE.Color).fromArray(void 0!==a.ambient?a.ambient:[.5,.5,.5]),B=void 0!==a.transparent&&a.transparent,U=void 0!==a.transparency?a.transparency:1,G=void 0===n.visible||n.visible,z=void 0!==n.wireframe&&n.wireframe,N=void 0!==n.side?n.side:THREE.FrontSide,V=void 0!==n.flatShading&&n.flatShading,F=new SpeToonMaterial(o,{color:O,transparent:B,opacity:U,flatShading:V,side:N,wireframe:z,visible:G});this.mMaterials.push(F)}else if("PHYSICAL"===r){var j=(new THREE.Color).fromArray(void 0!==a.ambient?a.ambient:[.5,.5,.5]),Y=void 0!==a.transparent&&a.transparent,k=void 0!==a.transparency?a.transparency:1,W=void 0!==a.roughness?a.roughness:.3,X=void 0!==a.metalness?a.metalness:0,q=void 0!==a.reflectivity?a.reflectivity:.5,J=void 0===n.visible||n.visible,K=void 0!==n.wireframe&&n.wireframe,Z=void 0!==n.side?n.side:THREE.FrontSide,Q=void 0!==n.flatShading&&n.flatShading,$=new SpePhysicalMaterial(o,{color:j,transparent:Y,opacity:k,roughness:W,metalness:X,reflectivity:q,flatShading:Q,side:Z,wireframe:K,visible:J});this.mMaterials.push($)}else if("ARRAY"===r){for(var ee=void 0!==a.techniques?a.techniques:new Array(o.length).fill("CONSTANT"),te=[],ie=0;ie<o.length;ie++)"CONSTANT"===ee[ie]?te.push(new SpeBasicMaterial(o[ie],{})):"LAMBERT"===ee[ie]?te.push(new SpeLambertMaterial(o[ie],{})):"PHONG"===ee[ie]?te.push(new SpePhongMaterial(o[ie],{})):"TOON"===ee[ie]?te.push(new SpeToonMaterial(o[ie],{})):"PHYSICAL"===ee[ie]?te.push(new SpePhysicalMaterial(o[ie],{})):(console.error("SpeGltfDecoder::_decodeSimpleMaterial >>> unsupported technique ("+ee[ie]+") for element of array of materials"),te.push(new SpeBasicMaterial(o[ie],{})));this.mMaterials.push(te)}else console.error("SpeGltfDecoder::_decodeSimpleMaterial >>> unsupported material type: ",e.technique)},t._decodePbrMaterial=function(e){},t._decodeSpeGeometry=function(e){var t=void 0!==e.type?e.type:"SphereGeometry",i=this._applyQualityScalers(t,void 0!==e.parameters?_extends({},e.parameters):{width:100,height:100,depth:100});if("CharacterGeometry"===t)SpeLoadCharData(void 0!==i.char?i.char:".",void 0!==i.fontFamily?i.fontFamily:"roboto_regular",void 0!==i.lod?i.lod:1),this.mGeometriesSpe.push(i);else{var r=(0,SPE[t].build)(i);this.mGeometriesSpe.push(r)}},t._applyQualityScalers=function(e,t){if(void 0===SPE.QualityModifiers[e])return t;for(var i={},r=this.mSceneOptions.quality,a=0,n=Object.entries(t);a<n.length;a++){var o=n[a],s=o[0],h=o[1];if(void 0!==SPE.QualityModifiers[e][s]){var l=SPE.QualityModifiers[e][s].minValue,d=SPE.QualityModifiers[e][s].maxValue,c=SPE.QualityModifiers[e][s].scalers[r];i[s]=Math.max(l,Math.min(d,c*h))}else i[s]=h}return i},t._decodeGeometry=function(e){var t=e.primitives,i=e.groups,r=e.parameters,a=t[0],n=a.indices,o=a.attributes,s=this.mAccessors[n],h={};for(var l in o)h[l]=this.mAccessors[o[l]];var d=new THREE.BufferGeometry;for(var c in s&&d.setIndex(s),h)d.setAttribute(c.toLowerCase(),h[c]);if(void 0!==i)for(var m=0;m<i.length;m++)d.addGroup(i[m].start,i[m].count,i[m].materialIndex);if(void 0!==r){var u=new THREE.Vector3;d.computeBoundingBox(),d.boundingBox.getSize(u);var p=void 0!==r.width?r.width:u.x,f=void 0!==r.height?r.height:u.y,v=void 0!==r.depth?r.depth:u.z;d.scale(Math.abs(u.x)<1e-5?1:p/u.x,Math.abs(u.y)<1e-5?1:f/u.y,Math.abs(u.z)<1e-5?1:v/u.z),d.userData={type:"NonParametricGeometry",parameters:{width:p,height:f,depth:v}}}this.mGeometries.push(d)},t._decodeNode=function(e){if(void 0!==e.camera){var t=e.camera;if(t<this.mCameras.length&&t>=0){var i=this.mCameras[t];i.visible=void 0===e.visible||e.visible,i.position.copy((new THREE.Vector3).fromArray(e.translation?e.translation:[0,0,0])),i.quaternion.copy((new THREE.Quaternion).fromArray(e.rotation?e.rotation:[0,0,0,1])),i.hiddenMatrix.copy((new THREE.Matrix4).fromArray(e.hiddenMatrix?e.hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),i.updateMatrix(),this.mNodes.push(i);var r=void 0!==e.uuid?e.uuid:THREE.MathUtils.generateUUID();this.mObjects[r]=i}else console.error("SpeGltfDecoder::_decodeNode >>> couldnt create node for associated camera (index out of bounds)")}else if(void 0!==e.mesh_spe){var a=e.mesh_spe,n=null;a<this.mGeometriesSpe.length&&a>=0?n=this.mGeometriesSpe[a]:(console.warn("SpeGltfDecoder::_decodeNode >>> couldnt grab any associated geometry for a mesh-node (index out of bounds). Creating a default sphere instead"),n=new THREE.SphereBufferGeometry(1,10,10));var o=null;if(void 0!==e.material){var s=e.material;s<this.mMaterials.length&&s>=0?o=this.mMaterials[s]:console.warn("SpeGltfDecoder::_decodeNode >>> couldnt grab any associated material for a mesh-node (index out of bounds)")}o||(console.error("SpeGltfDecoder::_decodeNode >>> mesh-node doesnt have a material. Creating a default phong-material instead"),o=new SpePhongMaterial({},{color:new THREE.Color(16777215),specular:new THREE.Color(16777215)}));var h=void 0!==e.type?e.type:"mesh3d",l=null;"mesh3d"===h?l=new SpeMesh3D(n,o):"mesh2d"===h?l=new SpeMesh2D(n,o):"text"===h?l=new SpeTextContainer(n,o):"character"===h?l=new SpeTextChar3D(n,o):(console.error("SpeGltfDecoder::_decodeNode >>> mesh-type "+h+" not supported"),l=new SpeMesh3D(n,o)),l.visible=void 0===e.visible||e.visible,l.castShadow=void 0===e.castShadow||e.castShadow,l.receiveShadow=void 0===e.receiveShadow||e.receiveShadow,l.position.copy((new THREE.Vector3).fromArray(e.translation?e.translation:[0,0,0])),l.quaternion.copy((new THREE.Quaternion).fromArray(e.rotation?e.rotation:[0,0,0,1])),l.scale.copy((new THREE.Vector3).fromArray(e.scale?e.scale:[1,1,1])),l.hiddenMatrix.copy((new THREE.Matrix4).fromArray(e.hiddenMatrix?e.hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),l.updateMatrix(),this.mNodes.push(l);var d=void 0!==e.uuid?e.uuid:THREE.MathUtils.generateUUID();this.mObjects[d]=l,e.spe_cloner&&(l.cloner=new Cloner(l).fromJSON(e.spe_cloner_data),l.add(l.cloner))}else if(void 0!==e.mesh){var c=e.mesh,m=null;c<this.mGeometries.length&&c>=0?m=this.mGeometries[c]:(console.warn("SpeGltfDecoder::_decodeNode >>> couldnt grab any associated geometry for a mesh-node (index out of bounds). Creating a default sphere instead"),m=new THREE.SphereBufferGeometry(1,10,10));var u=null;if(void 0!==e.material){var p=e.material;p<this.mMaterials.length&&p>=0?u=this.mMaterials[p]:console.warn("SpeGltfDecoder::_decodeNode >>> couldnt grab any associated material for a mesh-node (index out of bounds)")}u||(console.warn("SpeGltfDecoder::_decodeNode >>> mesh-node doesnt have a material. Creating a default phong-material instead"),u=new SpePhongMaterial({},{color:new THREE.Color(16777215),specular:new THREE.Color(16777215)}));var f=new SpeMesh3D(m,u);f.visible=void 0===e.visible||e.visible,f.castShadow=void 0===e.castShadow||e.castShadow,f.receiveShadow=void 0===e.receiveShadow||e.receiveShadow,f.position.copy((new THREE.Vector3).fromArray(e.translation?e.translation:[0,0,0])),f.quaternion.copy((new THREE.Quaternion).fromArray(e.rotation?e.rotation:[0,0,0,1])),f.scale.copy((new THREE.Vector3).fromArray(e.scale?e.scale:[1,1,1])),f.hiddenMatrix.copy((new THREE.Matrix4).fromArray(e.hiddenMatrix?e.hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),f.updateMatrix(),this.mNodes.push(f);var v=void 0!==e.uuid?e.uuid:THREE.MathUtils.generateUUID();this.mObjects[v]=f,e.spe_cloner&&(f.cloner=new Cloner(f).fromJSON(e.spe_cloner_data),f.add(f.cloner))}else if(void 0!==e.extensions&&void 0!==e.extensions.KHR_lights_punctual&&void 0!==e.extensions.KHR_lights_punctual.light){var E=e.extensions.KHR_lights_punctual.light;if(E<this.mLights.length&&E>=0){var g=this.mLights[E];if(g.position.copy((new THREE.Vector3).fromArray(e.translation?e.translation:[0,0,0])),"SpotLight"===g.type||"DirectionalLight"===g.type){var y=(new THREE.Quaternion).fromArray(e.rotation?e.rotation:[0,0,0,1]),_=(new THREE.Matrix4).makeRotationFromQuaternion(y),S=new THREE.Vector3(_.elements[8],_.elements[9],_.elements[10]);g.target.position.x=g.position.x+S.x,g.target.position.y=g.position.y+S.y,g.target.position.z=g.position.z+S.z}g.hiddenMatrix&&g.hiddenMatrix.copy((new THREE.Matrix4).fromArray(e.hiddenMatrix?e.hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),g.visible=void 0===e.visible||e.visible,this.mNodes.push(g);var x=void 0!==e.uuid?e.uuid:THREE.MathUtils.generateUUID();this.mObjects[x]=g}else console.error("SpeGltfDecoder::_decodeNode >>> couldnt create node for associated light (index out of bounds)")}else if(e.spe_empty_object){var b=new SpeEmptyObject;b.visible=void 0===e.visible||e.visible,b.position.copy((new THREE.Vector3).fromArray(e.translation?e.translation:[0,0,0])),b.quaternion.copy((new THREE.Quaternion).fromArray(e.rotation?e.rotation:[0,0,0,1])),b.scale.copy((new THREE.Vector3).fromArray(e.scale?e.scale:[1,1,1])),b.hiddenMatrix.copy((new THREE.Matrix4).fromArray(e.hiddenMatrix?e.hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),b.updateMatrix(),this.mNodes.push(b);var w=void 0!==e.uuid?e.uuid:THREE.MathUtils.generateUUID();this.mObjects[w]=b}else{console.warn("SpeGltfDecoder::_decodeNode >>> Unsupported node, creating a default THREE.Object3D instead");var T=new THREE.Object3D;T.position.copy((new THREE.Vector3).fromArray(e.translation?e.translation:[0,0,0])),T.quaternion.copy((new THREE.Quaternion).fromArray(e.rotation?e.rotation:[0,0,0,1])),T.scale.copy((new THREE.Vector3).fromArray(e.scale?e.scale:[1,1,1])),this.mNodes.push(T)}},t._getAccessorItemSize=function(e){return"SCALAR"===e?1:"VEC2"===e?2:"VEC3"===e?3:"VEC4"===e?4:"MAT4"===e?16:(console.error("SpeGltfDecoder::_getAccessorItemSize >>> invalid item-type"),1)},t._getAccessorComponentSize=function(e){return e===UNSIGNED_BYTE?1:e===UNSIGNED_SHORT?2:e===UNSIGNED_INT||e===FLOAT?4:(console.error("SpeGltfDecoder::_getAccessorComponentSize >>> invalid component-type"),1)},t._createUint16Buffer=function(e){return new Uint16Array(e.buffer)},t._createUint32Buffer=function(e){return new Uint32Array(e.buffer)},t._createFloat32Buffer=function(e){for(var t=new Float32Array(e.length/Float32Array.BYTES_PER_ELEMENT),i=new DataView(new ArrayBuffer(Float32Array.BYTES_PER_ELEMENT)),r=0;r<t.length;r++)i.setUint8(0,e[4*r+0]),i.setUint8(1,e[4*r+1]),i.setUint8(2,e[4*r+2]),i.setUint8(3,e[4*r+3]),t[r]=i.getFloat32(0,!0);return t},t._createBufferAttribute=function(e,t){return"Float32Array"===e.constructor.name?new THREE.Float32BufferAttribute(e,t):"Uint16Array"===e.constructor.name?new THREE.Uint16BufferAttribute(e,t):"Uint32Array"===e.constructor.name?new THREE.Uint32BufferAttribute(e,t):(console.error("SpeGltfDecoder::_createBufferAttribute >>> unsupported buffer-array-type"),null)},e}(),SpeIMesh=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).mLocalTransform=new THREE.Matrix4,r.mInteraction="function"==typeof Interaction?new Interaction(_assertThisInitialized(r)):null,r}_inheritsLoose(t,e);var i=t.prototype;return i.updateGeometry=function(e){this.geometry.copy(e)},i.computeSingleBoundingBox=function(){this.singleBoundingBox||(this.singleBoundingBox=new SPE.Box3),this.singleBoundingBox.setFromObjectSize(this,!1),this.singleBoundingBox.computeVertices(),this.singleBoundingBox.computeEdges()},i.computeComplexBoundingBox=function(e){this.complexBoundingBox||(this.complexBoundingBox=new SPE.Box3),this.complexBoundingBox.setFromObjectSize(this,e)},i.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.mLocalTransform,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.mLocalTransform),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)},i.updateWorldMatrix=function(e,t){var i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.mLocalTransform,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.mLocalTransform),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),!0===t)for(var r=this.children,a=0,n=r.length;a<n;a++)r[a].updateWorldMatrix(!1,!0)},i.shallowClone=function(e){return new this.constructor(this.geometry,this.material).shallowCopy(this,e)},i.shallowCopy=function(t,i){void 0===i&&(i=!0);var r=t.children;if(t.children=[],e.prototype.copy.call(this,t),t.children=r,this.userDataFromJson(this.userData),!0===i)for(var a=0,n=r.length;a<n;++a){var o=t.children[a];!0===o.userData.isEntity&&this.add(o.shallowClone())}return this},i.traverseEntity=function(e){!function t(i){if(i.userData.isEntity){e(i);for(var r=i.children,a=0,n=r.length;a<n;++a)t(r[a])}}(this)},i.userDataFromJson=function(e){this.userData=e,this.userData.positionToCenter=new THREE.Vector3,void 0!==e.hiddenMatrix&&(this.userData.hiddenMatrix=(new THREE.Matrix4).fromArray(e.hiddenMatrix.elements)),void 0===e.lock&&(this.userData.lock=!1)},_createClass(t,[{key:"interaction",get:function(){return this.mInteraction},set:function(e){this.mInteraction=e}},{key:"hiddenMatrix",get:function(){return this.mLocalTransform},set:function(e){this.mLocalTransform.copy(e)}},{key:"visibility",set:function(e){this.visible=e;for(var t=0,i=this.children.length;t<i;++t)void 0!==this.children[t].traverseEntity&&this.children[t].traverseEntity((function(t){void 0!==t.objectHelper&&!0===t.visible&&(t.objectHelper.visible=e)}))},get:function(){return this.visible}}]),t}(THREE.Mesh),SpeMesh3D=function(e){function t(t,i){return e.call(this,t,i)||this}return _inheritsLoose(t,e),t}(SpeIMesh),SpeMesh2D=function(e){function t(t,i){return e.call(this,t,i)||this}return _inheritsLoose(t,e),t}(SpeIMesh),SpeEmptyObject=function(e){function t(){var t;return(t=e.call(this)||this).mLocalTransform=new THREE.Matrix4,t.mInteraction="function"==typeof Interaction?new Interaction(_assertThisInitialized(t)):null,t}_inheritsLoose(t,e);var i=t.prototype;return i.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.mLocalTransform,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.mLocalTransform),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)},i.updateWorldMatrix=function(e,t){var i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.mLocalTransform,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.mLocalTransform),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),!0===t)for(var r=this.children,a=0,n=r.length;a<n;a++)r[a].updateWorldMatrix(!1,!0)},_createClass(t,[{key:"interaction",get:function(){return this.mInteraction},set:function(e){this.mInteraction=e}},{key:"hiddenMatrix",get:function(){return this.mLocalTransform},set:function(e){this.mLocalTransform.copy(e)}}]),t}(THREE.Group),SpeLayer=function(){function e(e,t,i){void 0===t&&(t=SPE_LAYER_TYPE_COLOR),void 0===i&&(i={}),this.mId=e,this.mType=t,this.mNext=null,this.mDefines={},this.mUniforms={},this.mProgramVertUniforms="",this.mProgramFragUniforms="",this.initializeUniformsAndDefines(i)}var t=e.prototype;return t.getValues=function(){for(var e="f"+this.mId+"_",t={type:this.type},i=0,r=Object.entries(this.mUniforms);i<r.length;i++){var a=r[i],n=a[0],o=a[1],s=n.slice(n.indexOf(e)+e.length);o.value.toArray?t[s]=o.value.toArray():t[s]=o.value}return t},t.initializeUniformsAndDefines=function(e){console.error("SpeLayer::initializeUniformsAndDefines >>> virtual method")},t.generateUniformsCodeVert=function(){return"\n\r"},t.generateUniformsCodeFrag=function(){return"\n\r"},t.generateShaderCodeVert=function(e){return"\n\r"},t.generateShaderCodeFrag=function(e){return"\n\r"},t.copy=function(e){this.mType===e.mType?(this.mId=e.mId,this.mDefines=_extends({},e.mDefines),this.copyUniforms(e)):console.error("SpeLayer::copy >>> cant copy layer of different type dst="+this.mType+", src="+e.mType)},t.clone=function(){return e.CreateLayer(this.mId,this.mType,this.mUniforms)},t.copyUniforms=function(e){console.error("SpeLayer::copyUniforms >>> virtual method")},e.CreateLayer=function(e,t,i){return t===SPE_LAYER_TYPE_LIGHTING?new SpeLayerLighting(e,i):t===SPE_LAYER_TYPE_COLOR?new SpeLayerColor(e,i):t===SPE_LAYER_TYPE_GRADIENT?new SpeLayerGradient(e,i):t===SPE_LAYER_TYPE_NORMAL?new SpeLayerNormal(e,i):t===SPE_LAYER_TYPE_DEPTH?new SpeLayerDepth(e,i):t===SPE_LAYER_TYPE_TEXTURE?new SpeLayerTexture(e,i):t===SPE_LAYER_TYPE_NOISE?new SpeLayerNoise(e,i):t===SPE_LAYER_TYPE_FRESNEL?new SpeLayerFresnel(e,i):t===SPE_LAYER_TYPE_POINTS?new SpeLayerPoints(e,i):t===SPE_LAYER_TYPE_LINES?new SpeLayerLines(e,i):null},e.DictToUniforms=function(e){for(var t={},i=0,r=Object.entries(e);i<r.length;i++){var a=r[i],n=a[0],o=a[1];t[n]={value:o}}return t},_createClass(e,[{key:"id",get:function(){return this.mId}},{key:"type",get:function(){return this.mType}},{key:"next",get:function(){return this.mNext},set:function(e){this.mNext=e}},{key:"defines",get:function(){return this.mDefines}},{key:"uniforms",get:function(){return this.mUniforms}},{key:"paramNames",get:function(){for(var e=Object.keys(this.mUniforms),t="f"+this.mId+"_",i=[],r=0;r<e.length;r++){var a=e[r];i.push(a.slice(a.indexOf(t)+t.length))}return i}}]),e}(),SpeLayerLighting=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_LIGHTING,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){this.mDefines.SPE_USE_LAYER_LIGHTING="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Lighting layer uniforms *****\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            // **********************************\n        "},i.generateShaderCodeFrag=function(){return"\n            // SPE: Lighting layer frag-shader-code ************************************************\n            // @todo: instead of == use absolute distance for vector comparison\n            if ( outgoingLight != diffuseColor.rgb ) {\n                float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n                accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_alpha * lightAccu;\n                outgoingLight = spe_blend( diffuseColor.rgb, outgoingLight, f"+this.mId+"_alpha, f"+this.mId+"_mode );\n            }\n            // *************************************************************************************\n        "},i.copyUniforms=function(e){e instanceof t&&(this.mUniforms["f"+this.mId+"_alpha"]={value:e.uniforms["f"+e.id+"_alpha"].value},this.mUniforms["f"+this.mId+"_mode"]={value:e.uniforms["f"+e.id+"_mode"].value})},t}(SpeLayer),SpeLayerColor=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_COLOR,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){this.mDefines.SPE_USE_LAYER_COLOR="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL},this.mUniforms["f"+this.mId+"_color"]={value:void 0!==e.color?new THREE.Color(e.color.value):new THREE.Color(SPE_COLOR_DEFAULT)}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Color layer uniforms **********\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            uniform vec3 f"+this.mId+"_color;\n            // ************************************\n        "},i.generateShaderCodeFrag=function(e){return"\n            // SPE: Color layer frag-shader-code ***************************************************\n            float f"+this.mId+"_calpha = f"+this.mId+"_alpha / clamp( f"+this.mId+"_alpha + accumAlpha, 0.00001, 1.0 );\n            accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_alpha;\n            "+e+" = spe_blend( "+e+", f"+this.mId+"_color, f"+this.mId+"_calpha, f"+this.mId+"_mode );\n            // *************************************************************************************\n        "},i.copyUniforms=function(e){e instanceof t&&(this.mUniforms["f"+this.mId+"_alpha"]={value:e.uniforms["f"+e.id+"_alpha"].value},this.mUniforms["f"+this.mId+"_mode"]={value:e.uniforms["f"+e.id+"_mode"].value},this.mUniforms["f"+this.mId+"_color"]={value:e.uniforms["f"+e.id+"_color"].value.clone()})},t}(SpeLayer),SpeLayerTexture=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_TEXTURE,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){var t;this.mDefines.SPE_USE_LAYER_TEXTURE="",this.mDefines.USE_UV="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL},this.mUniforms["f"+this.mId+"_texture"]={value:void 0!==e.texture?(t=e.texture.value,t instanceof THREE.Texture?t:"string"==typeof t?function(e){var t=new Image;t.src=e;var i=new THREE.Texture(t);return i.needsUpdate=!0,i}(t):(console.error("SpeLayerTexture::get_texture >>> cant retrieve texture from given parameters"),new THREE.Texture)):new THREE.Texture},this.mUniforms["f"+this.mId+"_mat"]={value:void 0!==e.mat?this.mUniforms["f"+this.mId+"_texture"].value.matrix.fromArray(void 0!==e.mat.value.elements?e.mat.value.elements:e.mat.value):this.mUniforms["f"+this.mId+"_texture"].value.matrix},this.mUniforms["f"+this.mId+"_crop"]={value:void 0!==e.crop?e.crop.value:0}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Texture layer uniforms ********\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            uniform sampler2D f"+this.mId+"_texture;\n            uniform mat3 f"+this.mId+"_mat;\n            uniform float f"+this.mId+"_crop;\n            // ************************************\n        "},i.generateShaderCodeFrag=function(e){return"\n            // SPE: Texture layer frag-shader-code *************************************************\n            vec2 f"+this.mId+"_vUv = ( f"+this.mId+"_mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n            vec4 f"+this.mId+"_tmp = texture2D( f"+this.mId+"_texture, f"+this.mId+"_vUv );\n            vec3 f"+this.mId+"_col = f"+this.mId+"_tmp.rgb;\n            float f"+this.mId+"_lalpha = f"+this.mId+"_alpha * f"+this.mId+"_tmp.a;\n            if ( f"+this.mId+"_crop > 0.5 ) {\n                if ( f"+this.mId+"_vUv.x < 0.0 || f"+this.mId+"_vUv.x > 1.0 ||\n                     f"+this.mId+"_vUv.y < 0.0 || f"+this.mId+"_vUv.y > 1.0 ) {\n                        f"+this.mId+"_lalpha = 0.0;\n                }\n            }\n            float f"+this.mId+"_calpha =  f"+this.mId+"_lalpha / clamp( f"+this.mId+"_lalpha + accumAlpha, 0.00001, 1.0 );\n            accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_lalpha;\n            "+e+" = spe_blend( "+e+", f"+this.mId+"_col, f"+this.mId+"_calpha, f"+this.mId+"_mode );\n            // *************************************************************************************\n        "},i.copyUniforms=function(e){e instanceof t&&(this.mUniforms["f"+this.mId+"_alpha"]={value:e.uniforms["f"+e.id+"_alpha"].value},this.mUniforms["f"+this.mId+"_mode"]={value:e.uniforms["f"+e.id+"_mode"].value},this.mUniforms["f"+this.mId+"_texture"]={value:e.uniforms["f"+e.id+"_texture"].value.clone()},this.mUniforms["f"+this.mId+"_mat"]={value:this.mUniforms["f"+this.mId+"_texture"].value.matrix},this.mUniforms["f"+this.mId+"_crop"]={value:e.uniforms["f"+e.id+"_crop"].value})},t.DictToUniforms=function(e){return{alpha:{value:e.alpha},mode:{value:e.mode},texture:{value:e.texture},mat:{value:e.texture.matrix},crop:{value:e.crop}}},t}(SpeLayer),SpeLayerNormal=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_NORMAL,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){this.mDefines.SPE_USE_LAYER_NORMAL="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL},this.mUniforms["f"+this.mId+"_cnormal"]={value:void 0!==e.cnormal?(new THREE.Vector3).fromArray(e.cnormal.value):new THREE.Vector3(1,1,1)}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Normal layer uniforms ********\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            uniform vec3 f"+this.mId+"_cnormal;\n            // ***********************************\n        "},i.generateShaderCodeFrag=function(e){return"\n            // SPE: Normal layer frag-shader-code **************************************************\n            vec3 f"+this.mId+"_normal = packNormalToRGB( normal ).rgb;\n            f"+this.mId+"_normal *= step( vec3(0.5), f"+this.mId+"_cnormal );\n            float f"+this.mId+"_calpha = f"+this.mId+"_alpha / clamp( f"+this.mId+"_alpha + accumAlpha, 0.00001, 1.0 );\n            accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_alpha;\n            "+e+" = spe_blend( "+e+", f"+this.mId+"_normal, f"+this.mId+"_calpha, f"+this.mId+"_mode );\n            // *************************************************************************************\n        "},i.copyUniforms=function(e){e instanceof t&&(this.mUniforms["f"+this.mId+"_alpha"]={value:e.uniforms["f"+e.id+"_alpha"].value},this.mUniforms["f"+this.mId+"_mode"]={value:e.uniforms["f"+e.id+"_mode"].value},this.mUniforms["f"+this.mId+"_cnormal"]={value:e.uniforms["f"+e.id+"_cnormal"].value.clone()})},t}(SpeLayer),SpeLayerDepth=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_DEPTH,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){this.mDefines.SPE_USE_LAYER_DEPTH="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL},this.mUniforms["f"+this.mId+"_near"]={value:void 0!==e.near?e.near.value:700},this.mUniforms["f"+this.mId+"_far"]={value:void 0!==e.far?e.far.value:1e3},this.mUniforms["f"+this.mId+"_origin"]={value:void 0!==e.origin?(new THREE.Vector3).fromArray(e.origin.value):new THREE.Vector3},this.mUniforms["f"+this.mId+"_isVector"]={value:void 0!==e.isVector?e.isVector.value:0},this.mUniforms["f"+this.mId+"_colorA"]={value:e.colorA?new THREE.Color(e.colorA.value):new THREE.Color},this.mUniforms["f"+this.mId+"_colorB"]={value:e.colorB?new THREE.Color(e.colorB.value):new THREE.Color(0,0,0)}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Depth layer uniforms *************\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            uniform float f"+this.mId+"_near;\n            uniform float f"+this.mId+"_far;\n            uniform float f"+this.mId+"_isVector;\n            uniform vec3 f"+this.mId+"_origin;\n            uniform vec3 f"+this.mId+"_colorA;\n            uniform vec3 f"+this.mId+"_colorB;\n            // ***************************************\n        "},i.generateShaderCodeFrag=function(e){return"\n            // SPE: Depth layer frag-shader-code ***************************************************\n            vec3 base"+this.mId+" = ( f"+this.mId+"_isVector > 0.5 ) ?  f"+this.mId+"_origin : cameraPosition;\n            float dist"+this.mId+" = length( dWorldPosition.xyz - base"+this.mId+" );\n            float dep"+this.mId+" = ( dist"+this.mId+" - f"+this.mId+"_near ) / ( f"+this.mId+"_far - f"+this.mId+"_near );\n            vec3 f"+this.mId+"_depth =  mix( f"+this.mId+"_colorB, f"+this.mId+"_colorA, 1.0 - clamp( dep"+this.mId+", 0., 1. ) );\n            float f"+this.mId+"_calpha = f"+this.mId+"_alpha / clamp( f"+this.mId+"_alpha + accumAlpha, 0.001, 1.0 );\n            accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_alpha;\n            "+e+" = spe_blend( "+e+", f"+this.mId+"_depth, f"+this.mId+"_calpha, f"+this.mId+"_mode );\n            // *************************************************************************************\n        "},i.copyUniforms=function(e){e instanceof t&&(this.mUniforms["f"+this.mId+"_alpha"]={value:e.uniforms["f"+e.id+"_alpha"].value},this.mUniforms["f"+this.mId+"_mode"]={value:e.uniforms["f"+e.id+"_mode"].value},this.mUniforms["f"+this.mId+"_near"]={value:e.uniforms["f"+e.id+"_near"].value},this.mUniforms["f"+this.mId+"_far"]={value:e.uniforms["f"+e.id+"_far"].value},this.mUniforms["f"+this.mId+"_origin"]={value:e.uniforms["f"+e.id+"_origin"].value.clone()},this.mUniforms["f"+this.mId+"_isVector"]={value:e.uniforms["f"+e.id+"_isVector"].value},this.mUniforms["f"+this.mId+"_colorA"]={value:e.uniforms["f"+e.id+"_colorA"].value.clone()},this.mUniforms["f"+this.mId+"_colorB"]={value:e.uniforms["f"+e.id+"_colorB"].value.clone()})},t}(SpeLayer),SpeLayerNoise=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_NOISE,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){this.mDefines.SPE_USE_LAYER_NOISE="",this.mDefines.SPE_USE_LAYER_TEXTURE="",this.mDefines.SPE_NOISE_NUM_OCTAVES="5",this.mDefines.USE_UV="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL},this.mUniforms["f"+this.mId+"_scale"]={value:void 0!==e.scale?e.scale.value:2},this.mUniforms["f"+this.mId+"_move"]={value:void 0!==e.move?e.move.value:1},this.mUniforms["f"+this.mId+"_distortion"]={value:void 0!==e.distortion?(new THREE.Vector2).fromArray(e.distortion.value):new THREE.Vector2(1,1)},this.mUniforms["f"+this.mId+"_fA"]={value:void 0!==e.fA?(new THREE.Vector2).fromArray(e.fA.value):new THREE.Vector2(1.7,9.2)},this.mUniforms["f"+this.mId+"_fB"]={value:void 0!==e.fB?(new THREE.Vector2).fromArray(e.fB.value):new THREE.Vector2(8.3,2.8)},this.mUniforms["f"+this.mId+"_colorA"]={value:void 0!==e.colorA?new THREE.Color(e.colorA.value):new THREE.Color(.4,.4,.4)},this.mUniforms["f"+this.mId+"_colorB"]={value:void 0!==e.colorB?new THREE.Color(e.colorB.value):new THREE.Color(.4,.4,.4)},this.mUniforms["f"+this.mId+"_colorC"]={value:void 0!==e.colorC?new THREE.Color(e.colorC.value):new THREE.Color(1,1,1)},this.mUniforms["f"+this.mId+"_colorD"]={value:void 0!==e.colorD?new THREE.Color(e.colorD.value):new THREE.Color(1,1,1)},this.mUniforms["f"+this.mId+"_intA"]={value:void 0!==e.intA?e.intA.value:10},this.mUniforms["f"+this.mId+"_intB"]={value:void 0!==e.intB?e.intB.value:10},this.mUniforms["f"+this.mId+"_intC"]={value:void 0!==e.intC?e.intC.value:10},this.mUniforms["f"+this.mId+"_intD"]={value:void 0!==e.intD?e.intD.value:10}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Noise layer uniforms *******************\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            uniform float f"+this.mId+"_scale;\n            uniform float f"+this.mId+"_move;\n            uniform vec2 f"+this.mId+"_fA;\n            uniform vec2 f"+this.mId+"_fB;\n            uniform vec2 f"+this.mId+"_distortion;\n            uniform vec3 f"+this.mId+"_colorA;\n            uniform vec3 f"+this.mId+"_colorB;\n            uniform vec3 f"+this.mId+"_colorC;\n            uniform vec3 f"+this.mId+"_colorD;\n            uniform float f"+this.mId+"_intA;\n            uniform float f"+this.mId+"_intB;\n            uniform float f"+this.mId+"_intC;\n            uniform float f"+this.mId+"_intD;\n            // *********************************************\n        "},i.generateShaderCodeFrag=function(e){return"\n            // SPE: Noise layer frag-shader-code ***************************************************\n            vec2 f"+this.mId+"_st = vUv * f"+this.mId+"_scale;\n            vec3 f"+this.mId+"_color;\n            vec2 f"+this.mId+"_q = vec2( fbm( f"+this.mId+"_st ), fbm( f"+this.mId+"_st + vec2(1.0) ) );\n            vec2 f"+this.mId+"_r = vec2( fbm( f"+this.mId+"_st + f"+this.mId+"_distortion * f"+this.mId+"_q + f"+this.mId+"_fA + f"+this.mId+"_move ),\n                                        fbm( f"+this.mId+"_st + f"+this.mId+"_distortion * f"+this.mId+"_q + f"+this.mId+"_fB + f"+this.mId+"_move ) );\n            float f"+this.mId+"_f = fbm( f"+this.mId+"_st + f"+this.mId+"_r );\n            f"+this.mId+"_color = mix( f"+this.mId+"_colorA * f"+this.mId+"_intA, f"+this.mId+"_colorB * f"+this.mId+"_intB,\n                         clamp((f"+this.mId+"_f*f"+this.mId+"_f)*4.0,0.0,1.0) );\n            f"+this.mId+"_color = mix( f"+this.mId+"_color, f"+this.mId+"_colorC * f"+this.mId+"_intC,\n                         clamp( length(f"+this.mId+"_q), 0.0, 1.0 ) );\n            f"+this.mId+"_color = mix( f"+this.mId+"_color, f"+this.mId+"_colorD * f"+this.mId+"_intD,\n                         clamp( length(f"+this.mId+"_r.x), 0.0, 1.0 ) );\n            vec3 f"+this.mId+"_noise = clamp( vec3( f"+this.mId+"_f * f"+this.mId+"_color ), 0.0, 1.0 );\n            float f"+this.mId+"_calpha = f"+this.mId+"_alpha / clamp( f"+this.mId+"_alpha + accumAlpha, 0.001, 1.0 );\n            accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_alpha;\n            "+e+" = spe_blend( "+e+", f"+this.mId+"_noise, f"+this.mId+"_calpha, f"+this.mId+"_mode );\n            // *************************************************************************************\n        "},i.copyUniforms=function(e){e instanceof t&&(this.mUniforms["f"+this.mId+"_alpha"]={value:e.uniforms["f"+e.id+"_alpha"].value},this.mUniforms["f"+this.mId+"_mode"]={value:e.uniforms["f"+e.id+"_mode"].value},this.mUniforms["f"+this.mId+"_scale"]={value:e.uniforms["f"+e.id+"_scale"].value},this.mUniforms["f"+this.mId+"_move"]={value:e.uniforms["f"+e.id+"_move"].value},this.mUniforms["f"+this.mId+"_distortion"]={value:e.uniforms["f"+e.id+"_distortion"].value.clone()},this.mUniforms["f"+this.mId+"_fA"]={value:e.uniforms["f"+e.id+"_fA"].value.clone()},this.mUniforms["f"+this.mId+"_fB"]={value:e.uniforms["f"+e.id+"_fB"].value.clone()},this.mUniforms["f"+this.mId+"_colorA"]={value:e.uniforms["f"+e.id+"_colorA"].value.clone()},this.mUniforms["f"+this.mId+"_colorB"]={value:e.uniforms["f"+e.id+"_colorB"].value.clone()},this.mUniforms["f"+this.mId+"_colorC"]={value:e.uniforms["f"+e.id+"_colorC"].value.clone()},this.mUniforms["f"+this.mId+"_colorD"]={value:e.uniforms["f"+e.id+"_colorD"].value.clone()},this.mUniforms["f"+this.mId+"_intA"]={value:e.uniforms["f"+e.id+"_intA"].value},this.mUniforms["f"+this.mId+"_intB"]={value:e.uniforms["f"+e.id+"_intB"].value},this.mUniforms["f"+this.mId+"_intC"]={value:e.uniforms["f"+e.id+"_intC"].value},this.mUniforms["f"+this.mId+"_intD"]={value:e.uniforms["f"+e.id+"_intD"].value})},t}(SpeLayer),SpeLayerFresnel=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_FRESNEL,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){this.mDefines.SPE_USE_LAYER_FRESNEL="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL},this.mUniforms["f"+this.mId+"_bias"]={value:void 0!==e.bias?e.bias.value:.1},this.mUniforms["f"+this.mId+"_scale"]={value:void 0!==e.scale?e.scale.value:1},this.mUniforms["f"+this.mId+"_intensity"]={value:void 0!==e.intensity?e.intensity.value:2},this.mUniforms["f"+this.mId+"_factor"]={value:void 0!==e.factor?e.factor.value:1},this.mUniforms["f"+this.mId+"_color"]={value:void 0!==e.color?new THREE.Color(e.color.value):new THREE.Color}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Fresnel layer uniforms *********\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            uniform float f"+this.mId+"_bias;\n            uniform float f"+this.mId+"_scale;\n            uniform float f"+this.mId+"_intensity;\n            uniform float f"+this.mId+"_factor;\n            uniform vec3 f"+this.mId+"_color;\n            // *************************************\n        "},i.generateShaderCodeFrag=function(e){return"\n            // SPE: Fresnel layer frag-shader-code *************************************************\n            float f"+this.mId+"_fresnel = f"+this.mId+"_bias + f"+this.mId+"_scale * pow( f"+this.mId+"_factor + dot( normalize( vWorldViewDir ), normalize( vWorldNormal ) ), f"+this.mId+"_intensity );\n            float f"+this.mId+"_lalpha = clamp( f"+this.mId+"_fresnel, 0.0, 1.0 ) * f"+this.mId+"_alpha;\n            float f"+this.mId+"_calpha = f"+this.mId+"_lalpha / clamp( f"+this.mId+"_lalpha + accumAlpha, 0.001, 1.0 );\n            accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_lalpha;\n            "+e+" = spe_blend( "+e+", f"+this.mId+"_color, f"+this.mId+"_calpha, f"+this.mId+"_mode );\n            // *************************************************************************************\n        "},i.copyUniforms=function(e){e instanceof t&&(this.mUniforms["f"+this.mId+"_alpha"]={value:e.uniforms["f"+e.id+"_alpha"].value},this.mUniforms["f"+this.mId+"_mode"]={value:e.uniforms["f"+e.id+"_mode"].value},this.mUniforms["f"+this.mId+"_bias"]={value:e.uniforms["f"+e.id+"_bias"].value},this.mUniforms["f"+this.mId+"_scale"]={value:e.uniforms["f"+e.id+"_scale"].value},this.mUniforms["f"+this.mId+"_intensity"]={value:e.uniforms["f"+e.id+"_intensity"].value},this.mUniforms["f"+this.mId+"_factor"]={value:e.uniforms["f"+e.id+"_factor"].value},this.mUniforms["f"+this.mId+"_color"]={value:e.uniforms["f"+e.id+"_color"].value.clone()})},t}(SpeLayer),SpeLayerGradient=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_GRADIENT,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){this.mDefines.SPE_USE_LAYER_GRADIENT="",this.mDefines.SPE_GRADIENT_MAX_SIZE="10",this.mDefines.USE_UV="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL},this.mUniforms["f"+this.mId+"_gl_type"]={value:void 0!==e.gl_type?e.gl_type.value:0},this.mUniforms["f"+this.mId+"_num"]={value:void 0!==e.num?e.num.value:2},this.mUniforms["f"+this.mId+"_smooth"]={value:void 0!==e.smooth&&e.smooth.value},this.mUniforms["f"+this.mId+"_colors"]={value:function(e){for(var t=[],i=0;i<Math.floor(e.length/4);i++)t.push(new THREE.Vector4(e[4*i+0],e[4*i+1],e[4*i+2],e[4*i+3]));return t}(void 0!==e.colors?e.colors.value:new Array(40).fill())},this.mUniforms["f"+this.mId+"_steps"]={value:void 0!==e.steps?e.steps.value:new Array(10).fill()},this.mUniforms["f"+this.mId+"_offset"]={value:void 0!==e.offset?(new THREE.Vector2).fromArray(e.offset.value):new THREE.Vector2(0,0)},this.mUniforms["f"+this.mId+"_morph"]={value:void 0!==e.morph?(new THREE.Vector2).fromArray(e.morph.value):new THREE.Vector2(0,0)},this.mUniforms["f"+this.mId+"_angle"]={value:void 0!==e.angle?e.angle.value:0}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Gradient layer uniforms ****************\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            uniform int f"+this.mId+"_gl_type;\n            uniform int f"+this.mId+"_num;\n            uniform bool f"+this.mId+"_smooth;\n            uniform vec4 f"+this.mId+"_colors[SPE_GRADIENT_MAX_SIZE];\n            uniform float f"+this.mId+"_steps[SPE_GRADIENT_MAX_SIZE];\n            uniform vec2 f"+this.mId+"_offset;\n            uniform vec2 f"+this.mId+"_morph;\n            uniform float f"+this.mId+"_angle;\n            // *********************************************\n        "},i.generateShaderCodeFrag=function(e){return"\n            // SPE: Gradient layer frag-shader-code ************************************************\n            vec4 f"+this.mId+"_color = f"+this.mId+"_colors[0];\n            vec2 f"+this.mId+"_m = f"+this.mId+"_morph / vUv.xy;\n            vec2 f"+this.mId+"_rot = vec2( 0.5 + f"+this.mId+"_m.x, f"+this.mId+"_m.y );\n            vec2 f"+this.mId+"_dt = vec2(\n                cos( f"+this.mId+"_angle ) * f"+this.mId+"_rot.x - sin( f"+this.mId+"_angle ) * f"+this.mId+"_rot.y,\n                sin( f"+this.mId+"_angle ) * f"+this.mId+"_rot.x + cos( f"+this.mId+"_angle ) * f"+this.mId+"_rot.y\n            );\n            vec2 f"+this.mId+"_pt = ( vUv - 0.5 + f"+this.mId+"_offset ) / 2.0 + f"+this.mId+"_dt / 2.0;\n            float f"+this.mId+"_t = dot( f"+this.mId+"_pt, f"+this.mId+"_dt ) / dot( f"+this.mId+"_dt, f"+this.mId+"_dt );\n            if ( f"+this.mId+"_gl_type == 1 ) {\n                f"+this.mId+"_t = distance (\n                    ( vUv + f"+this.mId+"_morph ) * 3.0,\n                    ( vUv + f"+this.mId+"_offset ) + 1.0\n                ) + f"+this.mId+"_angle;\n            } else if ( f"+this.mId+"_gl_type == 2 ) {\n                float f"+this.mId+"_polar = atan(\n                    vUv.x + f"+this.mId+"_morph.x - 0.5 + f"+this.mId+"_offset.x,\n                    vUv.y + f"+this.mId+"_morph.y - 0.5 + f"+this.mId+"_offset.y\n                ) * -1.0;\n                f"+this.mId+"_t = fract( ( f"+this.mId+"_angle / PI / -2.0 ) + 0.5 * ( f"+this.mId+"_polar / PI ) );\n            }\n            float f"+this.mId+"_p;\n            for ( int i = 1; i < SPE_GRADIENT_MAX_SIZE; i++ ) {\n                if ( i < f"+this.mId+"_num ) {\n                    f"+this.mId+"_p = clamp( ( f"+this.mId+"_t - f"+this.mId+"_steps[i-1] ) / ( f"+this.mId+"_steps[i] - f"+this.mId+"_steps[i-1] ), 0.0, 1.0 );\n                    f"+this.mId+"_color = mix( f"+this.mId+"_color, f"+this.mId+"_colors[i],\n                        ( f"+this.mId+"_smooth ) ? smoothstep( 0.0, 1.0, f"+this.mId+"_p ) : f"+this.mId+"_p\n                    );\n                } else {\n                    break;\n                }\n            }\n            float f"+this.mId+"_lalpha = f"+this.mId+"_alpha * f"+this.mId+"_color.a;\n            float f"+this.mId+"_calpha =  f"+this.mId+"_lalpha / clamp( f"+this.mId+"_lalpha + accumAlpha, 0.00001, 1.0 );\n            accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_lalpha;\n            "+e+" = spe_blend( "+e+", f"+this.mId+"_color.xyz, f"+this.mId+"_calpha, f"+this.mId+"_mode );\n            // *************************************************************************************\n        "},i.getValues=function(){var e={type:this.type};return e.alpha=this.mUniforms["f"+this.mId+"_alpha"].value,e.mode=this.mUniforms["f"+this.mId+"_mode"].value,e.gl_type=this.mUniforms["f"+this.mId+"_gl_type"].value,e.num=this.mUniforms["f"+this.mId+"_num"].value,e.smooth=this.mUniforms["f"+this.mId+"_smooth"].value,e.colors=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].x,e[i].y,e[i].z,e[i].w);return t}(this.mUniforms["f"+this.mId+"_colors"].value),e.steps=[].concat(this.mUniforms["f"+this.mId+"_steps"].value),e.offset=this.mUniforms["f"+this.mId+"_offset"].value.toArray(),e.morph=this.mUniforms["f"+this.mId+"_morph"].value.toArray(),e.angle=this.mUniforms["f"+this.mId+"_angle"].value,e},i.copyUniforms=function(e){e instanceof t&&(this.mUniforms["f"+this.mId+"_alpha"]={value:e.uniforms["f"+e.id+"_alpha"].value},this.mUniforms["f"+this.mId+"_mode"]={value:e.uniforms["f"+e.id+"_mode"].value},this.mUniforms["f"+this.mId+"_gl_type"]={value:e.uniforms["f"+e.id+"_gl_type"].value},this.mUniforms["f"+this.mId+"_num"]={value:e.uniforms["f"+e.id+"_num"].value},this.mUniforms["f"+this.mId+"_smooth"]={value:e.uniforms["f"+e.id+"_smooth"].value},this.mUniforms["f"+this.mId+"_colors"]={value:function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].clone());return t}(e.uniforms["f"+e.id+"_colors"].value)},this.mUniforms["f"+this.mId+"_steps"]={value:[].concat(e.uniforms["f"+e.id+"_steps"].value)},this.mUniforms["f"+this.mId+"_offset"]={value:e.uniforms["f"+e.id+"_offset"].value.clone()},this.mUniforms["f"+this.mId+"_morph"]={value:e.uniforms["f"+e.id+"_morph"].value.clone()},this.mUniforms["f"+this.mId+"_angle"]={value:e.uniforms["f"+e.id+"_angle"].value})},t}(SpeLayer),SpeLayerPoints=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_POINTS,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){this.mDefines.SPE_USE_LAYER_POINTS="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL},this.mUniforms["f"+this.mId+"_color"]={value:void 0!==e.color?new THREE.Color(e.color.value):new THREE.Color(12237498)},this.mUniforms["f"+this.mId+"_useBack"]={value:void 0===e.useBack||e.useBack.value},this.mUniforms["f"+this.mId+"_threshold"]={value:void 0!==e.threshold?e.threshold.value:.9}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Points layer uniforms **************\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            uniform vec3 f"+this.mId+"_color;\n            uniform bool f"+this.mId+"_useBack;\n            uniform float f"+this.mId+"_threshold;\n            // *****************************************\n        "},i.generateShaderCodeFrag=function(e){return"\n            // SPE: Points layer frag-shader-code **************************************************\n            float f"+this.mId+"_dist = length( vBarycentric );\n            float f"+this.mId+"_edge = aastep( f"+this.mId+"_threshold, f"+this.mId+"_dist, 0.00 );\n            float f"+this.mId+"_factor = gl_FrontFacing ? 1.0 : ( f"+this.mId+"_useBack ? 0.5 : 0.0 );\n            accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_alpha * f"+this.mId+"_edge;\n            "+e+" = spe_blend( "+e+", f"+this.mId+"_factor * f"+this.mId+"_color, f"+this.mId+"_alpha * f"+this.mId+"_edge, f"+this.mId+"_mode );\n            // *************************************************************************************\n        "},t}(SpeLayer),SpeLayerLines=function(e){function t(t,i){return e.call(this,t,SPE_LAYER_TYPE_LINES,i)||this}_inheritsLoose(t,e);var i=t.prototype;return i.initializeUniformsAndDefines=function(e){this.mDefines.SPE_USE_LAYER_LINES="",this.mUniforms["f"+this.mId+"_alpha"]={value:void 0!==e.alpha?e.alpha.value:1},this.mUniforms["f"+this.mId+"_mode"]={value:void 0!==e.mode?e.mode.value:SPE_BLENDING_NORMAL},this.mUniforms["f"+this.mId+"_color"]={value:void 0!==e.color?new THREE.Color(e.color.value):new THREE.Color(12237498)},this.mUniforms["f"+this.mId+"_thickness"]={value:void 0!==e.thickness?e.thickness.value:.01},this.mUniforms["f"+this.mId+"_useBack"]={value:void 0===e.useBack||e.useBack.value},this.mUniforms["f"+this.mId+"_smoothOffset"]={value:void 0!==e.smoothOffset?e.smoothOffset.value:.03}},i.generateUniformsCodeFrag=function(){return"\n            // SPE: Lines layer uniforms *************************\n            uniform float f"+this.mId+"_alpha;\n            uniform int f"+this.mId+"_mode;\n            uniform vec3 f"+this.mId+"_color;\n            uniform float f"+this.mId+"_thickness;\n            uniform bool f"+this.mId+"_useBack;\n            uniform float f"+this.mId+"_smoothOffset;\n            // **************************************************\n        "},i.generateShaderCodeFrag=function(e){return"\n            // SPE: Lines layer frag-shader-code ***************************************************\n            float f"+this.mId+"_dist = min( vBarycentric.x, min( vBarycentric.y, vBarycentric.z ) );\n            float f"+this.mId+"_comp_thickness = f"+this.mId+"_thickness;\n            float f"+this.mId+"_edge = 1.0 - aastep( f"+this.mId+"_comp_thickness, f"+this.mId+"_dist, f"+this.mId+"_smoothOffset );\n            float f"+this.mId+"_factor = gl_FrontFacing ? 1.0 : ( f"+this.mId+"_useBack ? 0.5 : 0.0 );\n            accumAlpha += ( 1.0 - accumAlpha ) * f"+this.mId+"_alpha * f"+this.mId+"_edge;\n            "+e+" = spe_blend( "+e+", f"+this.mId+"_factor * f"+this.mId+"_color, f"+this.mId+"_alpha * f"+this.mId+"_edge, f"+this.mId+"_mode );\n            // *************************************************************************************\n        "},t}(SpeLayer);if(!SPE.CreateLayerFromJSON){var preprocess_uniforms=function(e,t){var i={},r="f"+e+"_";for(var a in t){var n=a.slice(a.indexOf(r)+r.length),o=t[a].value;if("boolean"==typeof o)i[n]={name:n,value:o,type:SPE_LAYER_UNIFORM_TYPE_BOOL};else if("number"==typeof o)Number.isInteger(o)?i[n]={name:n,value:o,type:SPE_LAYER_UNIFORM_TYPE_INT}:i[n]={name:n,value:o,type:SPE_LAYER_UNIFORM_TYPE_FLOAT};else if("string"!=typeof o||isNaN(o))if(o instanceof Object&&2===Object.entries(o).length)void 0!==o.x&&void 0!==o.y&&(i[n]={name:n,value:[o.x,o.y],type:SPE_LAYER_UNIFORM_TYPE_VEC2});else if(o instanceof Object&&3===Object.entries(o).length)void 0!==o.x&&void 0!==o.y&&void 0!==o.z&&(i[n]={name:n,value:[o.x,o.y,o.z],type:SPE_LAYER_UNIFORM_TYPE_VEC3});else if(o instanceof Object&&4===Object.entries(o).length)void 0!==o.x&&void 0!==o.y&&void 0!==o.z&&void 0!==o.w?i[n]={name:n,value:[o.x,o.y,o.z,o.w],type:SPE_LAYER_UNIFORM_TYPE_VEC4}:void 0!==o.r&&void 0!==o.g&&void 0!==o.b&&void 0!==o.a&&(i[n]={name:n,value:[o.r,o.g,o.b,o.a],type:SPE_LAYER_UNIFORM_TYPE_COLOR});else if(o instanceof Array&&"number"==typeof o[0])Number.isInteger(o[0])?i[n]={name:n,value:[].concat(o),type:SPE_LAYER_UNIFORM_TYPE_ARRAY_INT}:i[n]={name:n,value:[].concat(o),type:SPE_LAYER_UNIFORM_TYPE_ARRAY_FLOAT};else if(o instanceof Array&&o[0]instanceof Object&&2===Object.entries(o[0]).length){if(void 0!==o[0].x&&void 0!==o[0].y){for(var s=[],h=0;h<o.length;h++)s=s.concat([o[h].x,o[h].y]);i[n]={name:n,value:s,type:SPE_LAYER_UNIFORM_TYPE_ARRAY_VEC2}}}else if(o instanceof Array&&o[0]instanceof Object&&3===Object.entries(o[0]).length){if(void 0!==o[0].x&&void 0!==o[0].y&&void 0!==o[0].z){for(var l=[],d=0;d<o.length;d++)l=l.concat([o[d].x,o[d].y,o[d].z]);i[n]={name:n,value:l,type:SPE_LAYER_UNIFORM_TYPE_ARRAY_VEC3}}}else if(o instanceof Array&&o[0]instanceof Object&&4===Object.entries(o[0]).length){if(void 0!==o[0].x&&void 0!==o[0].y&&void 0!==o[0].z&&void 0!==o[0].w){for(var c=[],m=0;m<o.length;m++)c=c.concat([o[m].x,o[m].y,o[m].z,o[m].w]);i[n]={name:n,value:c,type:SPE_LAYER_UNIFORM_TYPE_ARRAY_VEC4}}}else if(o instanceof Array&&o[0]instanceof THREE.Color){if(void 0!==o[0].x&&void 0!==o[0].y&&void 0!==o[0].z&&void 0!==o[0].w){for(var u=[],p=0;p<o.length;p++)u=u.concat([o[p].r,o[p].g,o[p].b,o[p].a]);i[n]={name:n,value:u,type:SPE_LAYER_UNIFORM_TYPE_ARRAY_COLOR}}}else o instanceof Object&&1===Object.entries(o).length?void 0!==o.elements&&o.elements instanceof Array&&(9===o.elements.length?i[n]={name:n,value:[].concat(o.elements),type:SPE_LAYER_UNIFORM_TYPE_MAT3}:16===o.elements.length?i[n]={name:n,value:[].concat(o.elements),type:SPE_LAYER_UNIFORM_TYPE_MAT4}:console.error("SpeLayer::preprocess_uniforms >>> unsupported matrix-type of uniform: ",o.elements)):"string"==typeof o?i[n]={name:n,value:SPE.CachedTextures[o],type:SPE_LAYER_UNIFORM_TYPE_SAMPLER_2D}:console.error("SpeLayer::preprocess_uniforms >>> unsupported uniform-value: ",o);else{var f=Number(o);Number.isInteger(f)?i[n]={name:n,value:f,type:SPE_LAYER_UNIFORM_TYPE_INT}:i[n]={name:n,value:f,type:SPE_LAYER_UNIFORM_TYPE_FLOAT}}}return i};SPE.CreateLayerFromJSON=function(e,t){var i=e.id,r=e.type,a=preprocess_uniforms(e.id,e.uniforms);return SpeLayer.CreateLayer(i,r,a)}}var SpeLayersList=function(){function e(e){if(this.mHead=null,this.mShader=null,void 0!==e&&Object.keys(e).length>0)for(var t=0;t<e.length;t++)this.addLayer(t,e[t].type,e[t].uniforms);else this.addLayer(0,SPE_LAYER_TYPE_COLOR,{}),this.addLayer(1,SPE_LAYER_TYPE_LIGHTING,{})}var t=e.prototype;return t.addLayer=function(e,t,i){var r=SpeLayer.CreateLayer(e,t,i);if(null!==r){if(null===this.mHead)this.mHead=r;else{for(var a=this.mHead;a.next;)a=a.next;a.next=r}return r}console.error("SpeLayersList::addLayer >>> couldnt create a layer of type: ",t)},t.addLayerBeforeAt=function(e,t){var i=void 0!==e.id?e.id:100+Math.floor(999*Math.random()),r=void 0!==e.type?e.type:SPE_LAYER_TYPE_COLOR,a="texture"!==r?SpeLayer.DictToUniforms(e):SpeLayerTexture.DictToUniforms(e),n=SpeLayer.CreateLayer(i,r,a),o=this.head;if(n.next=t,o===t)this.head=n;else{for(;o.next!==t;)o=o.next;o.next=n}return n},t.removeLayer=function(e){var t=this.head,i=void 0,r=0;if(t.id==e)this.head=t.next;else for(r=1,i=t,t=t.next;null!=t;){if(t.id==e){i.next=t.next;break}r++,i=t,t=t.next}return r},t.getLayer=function(e){for(var t=this.head;t&&t.id!=e;)t=t.next;return t},t.updateLayerUniform=function(e,t){var i=this.getLayer(e);i&&(void 0!==i.uniforms[t]?this.mShader.uniforms[t]={value:i.uniforms[t].value}:console.error("SpeLayersList::updateLayerUniform >>> uniform "+t+" not found in layer"))},t.updateLayerUniformByLayer=function(e,t){void 0!==e.uniforms[t]?this.mShader.uniforms[t]={value:e.uniforms[t].value}:console.error("SpeLayersList::updateLayerUniformByLayer >>> uniform "+t+" not found in layer")},t.getUniforms=function(){for(var e={},t=this.mHead;t;){for(var i=0,r=Object.entries(t.uniforms);i<r.length;i++){var a=r[i],n=a[0],o=a[1];e[n]=o}t=t.next}return e},t.getDefinesCode=function(){for(var e="",t=this.mHead;t;){for(var i=0,r=Object.entries(t.defines);i<r.length;i++){var a=r[i];e+="#define "+a[0]+" "+a[1]+"\n"}t=t.next}return e},t.getVertUniformsCode=function(){for(var e="",t=this.mHead;t;)e+=t.generateUniformsCodeVert(),t=t.next;return e},t.getFragUniformsCode=function(){for(var e="",t=this.mHead;t;)e+=t.generateUniformsCodeFrag(),t=t.next;return e},t.getFragShaderCodePreLighting=function(){for(var e="",t=this.mHead;t.type!==SPE_LAYER_TYPE_LIGHTING;)e+=t.generateShaderCodeFrag("bef"),t=t.next;return e},t.getFragShaderCodeLighting=function(){for(var e=this.mHead;e.type!==SPE_LAYER_TYPE_LIGHTING;)e=e.next;return e.generateShaderCodeFrag()},t.getFragShaderCodePostLighting=function(){for(var e="",t=this.mHead;t.type!==SPE_LAYER_TYPE_LIGHTING;)t=t.next;for(t=t.next;t;)e+=t.generateShaderCodeFrag("aft"),t=t.next;return e},_createClass(e,[{key:"head",get:function(){return this.mHead},set:function(e){this.mHead=e}},{key:"shader",get:function(){return this.mShader},set:function(e){this.mShader=e}}]),e}(),SpeBasicMaterial=function(e){function t(t,i){var r;return void 0===t&&(t={}),void 0===i&&(i={}),(r=e.call(this,i)||this).mLayersList=null,Object.keys(t).length>0&&(r.mLayersList=new SpeLayersList(t),r.onBeforeCompile=SpeShaderLib.GetSetupCallback(_assertThisInitialized(r))),r}return _inheritsLoose(t,e),t.prototype.copy=function(t){if(this.mLayersList){var i=t.layersList;t.layersList=void 0,e.prototype.copy.call(this,t),this.layerList=i.clone()}else e.prototype.copy.call(this,t);return this},_createClass(t,[{key:"layersList",get:function(){return this.mLayersList},set:function(e){this.mLayersList=e,this.onBeforeCompile=SpeShaderLib.GetSetupCallback(this)}}]),t}(THREE.MeshPhongMaterial),SpeLambertMaterial=function(e){function t(t,i){var r;return void 0===t&&(t={}),void 0===i&&(i={}),(r=e.call(this,i)||this).mLayersList=null,Object.keys(t).length>0&&(r.mLayersList=new SpeLayersList(t),r.onBeforeCompile=SpeShaderLib.GetSetupCallback(_assertThisInitialized(r))),r}return _inheritsLoose(t,e),t.prototype.copy=function(t){if(this.mLayersList){var i=t.layersList;t.layersList=void 0,e.prototype.copy.call(this,t),this.layerList=i.clone()}else e.prototype.copy.call(this,t);return this},_createClass(t,[{key:"layersList",get:function(){return this.mLayersList},set:function(e){this.mLayersList=e,this.onBeforeCompile=SpeShaderLib.GetSetupCallback(this)}}]),t}(THREE.MeshLambertMaterial),SpePhongMaterial=function(e){function t(t,i){var r;return void 0===t&&(t={}),void 0===i&&(i={}),(r=e.call(this,i)||this).mLayersList=null,Object.keys(t).length>0&&(r.mLayersList=new SpeLayersList(t),r.onBeforeCompile=SpeShaderLib.GetSetupCallback(_assertThisInitialized(r))),r}return _inheritsLoose(t,e),t.prototype.copy=function(t){if(this.mLayersList){var i=t.layersList;t.layersList=void 0,e.prototype.copy.call(this,t),this.layerList=i.clone()}else e.prototype.copy.call(this,t);return this},_createClass(t,[{key:"layersList",get:function(){return this.mLayersList},set:function(e){this.mLayersList=e,this.onBeforeCompile=SpeShaderLib.GetSetupCallback(this)}}]),t}(THREE.MeshPhongMaterial),SpePhysicalMaterial=function(e){function t(t,i){var r;return void 0===t&&(t={}),void 0===i&&(i={}),void 0===i.roughness&&(i.roughness=.3),(r=e.call(this,i)||this).mLayersList=null,Object.keys(t).length>0&&(r.mLayersList=new SpeLayersList(t),r.onBeforeCompile=SpeShaderLib.GetSetupCallback(_assertThisInitialized(r))),r}return _inheritsLoose(t,e),t.prototype.copy=function(t){if(this.mLayersList){var i=t.layersList;t.layersList=void 0,e.prototype.copy.call(this,t),this.layerList=i.clone()}else e.prototype.copy.call(this,t);return this},_createClass(t,[{key:"layersList",get:function(){return this.mLayersList},set:function(e){this.mLayersList=e,this.onBeforeCompile=SpeShaderLib.GetSetupCallback(this)}}]),t}(THREE.MeshPhysicalMaterial),SpeToonMaterial=function(e){function t(t,i){var r;return void 0===t&&(t={}),void 0===i&&(i={}),(r=e.call(this,i)||this).mLayersList=null,Object.keys(t).length>0&&(r.mLayersList=new SpeLayersList(t),r.onBeforeCompile=SpeShaderLib.GetSetupCallback(_assertThisInitialized(r))),r}return _inheritsLoose(t,e),t.prototype.copy=function(t){if(this.mLayersList){var i=t.layersList;t.layersList=void 0,e.prototype.copy.call(this,t),this.layerList=i.clone()}else e.prototype.copy.call(this,t);return this},_createClass(t,[{key:"layersList",get:function(){return this.mLayersList},set:function(e){this.mLayersList=e,this.onBeforeCompile=SpeShaderLib.GetSetupCallback(this)}}]),t}(THREE.MeshToonMaterial),SpeFontsCache={},SpeCharsCache={},SPE_PATH_FONTS="assets/fonts/",SPE_DEFAULT_TEXT_FONT="roboto_regular",SPE_DEFAULT_TEXT_CHARACTER=".",SPE_DEFAULT_TEXT_LOD=16;function SpeLoadCharData(e,t,i){if(SpeCharsCache[e]){if(SpeCharsCache[e][i]&&SpeCharsCache[e][i].fontFamily===t)return SpeCharsCache[e][i]}else SpeCharsCache[e]={};var r=void 0!==SpeFontsCache[t]?SpeFontsCache[t]:SpeFontsCache[SPE_DEFAULT_TEXT_FONT],a=r.generateShapes(e,1);return SpeCharsCache[e][i]={geometry:new THREE.ShapeBufferGeometry(a,i),fontFamily:t,resolution:r.data.resolution,glyphsHa:r.data.glyphs[e].ha},SpeCharsCache[e][i]}var SpeTextChar3D=function(e){function t(t,i){var r,a=void 0!==t.char?t.char:SPE_DEFAULT_TEXT_CHARACTER,n=void 0!==t.fontFamily?t.fontFamily:SPE_DEFAULT_TEXT_FONT,o=void 0!==t.lod?t.lod:SPE_DEFAULT_TEXT_LOD,s=SpeLoadCharData(a,n,o);return(r=e.call(this,s.geometry,i)||this).mChar=a,r.mFontFamily=n,r.mLod=o,r.mFontSize=void 0!==t.fontSize?t.fontSize:16,r.mLetterSpacing=void 0!==t.letterSpacing?t.letterSpacing:1,r.mResolution=s.resolution,r.mGlyphsHa=s.glyphsHa,r.mLocalPosition=new THREE.Vector2,r.mCharSize=r.mGlyphsHa*(r.mFontSize/r.mResolution)*r.mLetterSpacing,r.updateFontSize(r.mFontSize),r}return _inheritsLoose(t,e),t.prototype.updateFontSize=function(e){this.mFontSize=e,this.mCharSize=this.mGlyphsHa*(this.mFontSize/this.mResolution)*this.mLetterSpacing,this.scale.set(this.mFontSize,this.mFontSize,1)},t}(SpeIMesh),SpeTextContainer=function(e){function t(t,i){return i.visible=!1,e.call(this,t,i)||this}return _inheritsLoose(t,e),t}(SpeIMesh),SpeLoaderManager=function(){function e(e){this.mAssets=e||{},this.mOnFinishCallback=null,this.mNumAssetsToLoad=0,this.mNumAssetsLoaded=0}return e.prototype.run=function(e){var t=this;this.mOnFinishCallback=e;var i=void 0!==this.mAssets.fonts?this.mAssets.fonts:[],r=void 0!==this.mAssets.images?this.mAssets.images:[],a=void 0!==this.mAssets.models?this.mAssets.models:[],n=void 0!==this.mAssets.animations?this.mAssets.animations:[];this.mNumAssetsLoaded=0,this.mNumAssetsToLoad=i.length+r.length+a.length+n.length,this.mNumAssetsToLoad<1?this.mOnFinishCallback():function(){for(var e=t,r=function(t){var r=new THREE.FontLoader,a=i[t],n=SPE_PATH_FONTS+a+".json";r.load(n,(function(t){SpeFontsCache[a]=t,e.mNumAssetsLoaded++,e.mNumAssetsLoaded===e.mNumAssetsToLoad&&e.mOnFinishCallback()}))},a=0;a<i.length;a++)r(a)}()},e}(),SpeRuntime=function(){function e(e,t,i){void 0===i&&(i={}),this.mGltfScene=e,this.mConfig=i,this.mViewportMode=SPE_RUNTIME_VIEWMODE_FULLSCREEN,this.mViewportWidth=window.innerWidth,this.mViewportHeight=window.innerHeight;var r=document.getElementById("canvas3d");this.mRenderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0,canvas:r}),this.mRenderer.setPixelRatio(window.devicePixelRatio),this.mRenderer.setSize(this.mViewportWidth,this.mViewportHeight),this.mRenderer.shadowMap.enabled=!0,this.mRenderer.shadowMap.type=THREE.PCFSoftShadowMap,this.mScene=new SpeScene,this.mSceneOptions={},this.mMainCamera=null,this.mOrbitControls=null,this.mPlayHandler=null,this.mRunning=!1,this.mLoaderManager=new SpeLoaderManager(t),this.mLoaderManager.run(this.onRuntimeAssetsLoaded.bind(this))}var t=e.prototype;return t.run=function(){requestAnimationFrame(this.run.bind(this)),this.onRender()},t.onRuntimeAssetsLoaded=function(){console.info("SpeRuntime >>> Finished loading assets for the spline-runtime"),this.loadFromGltf(this.mGltfScene),window.addEventListener("resize",this.onResize.bind(this)),this.mRunning=!0,this.onResize()},t.onRender=function(){this.mRunning&&(SPE_USES_PREVIEW_IMAGE&&(document.querySelector(".spline-preview-image-container").style.display="none",SPE_USES_PREVIEW_IMAGE=!1),this.mPlayHandler&&!this.mPlayHandler.isEnable&&this.mPlayHandler.activate(),this.mOrbitControls&&this.mOrbitControls.update(),this.mScene&&this.mMainCamera&&(this.mRenderer.autoClear=!0,this.mRenderer.render(this.mScene,this.mMainCamera)))},t.onResize=function(){this.mRunning&&(this.mViewportMode!==SPE_RUNTIME_VIEWMODE_FULLSCREEN&&this.mViewportMode!==SPE_RUNTIME_VIEWMODE_FULL_WIDTH||(this.mViewportWidth=window.innerWidth),this.mViewportMode!==SPE_RUNTIME_VIEWMODE_FULLSCREEN&&this.mViewportMode!==SPE_RUNTIME_VIEWMODE_FULL_HEIGHT||(this.mViewportHeight=window.innerHeight),this.mMainCamera&&("PerspectiveCamera"===this.mMainCamera.type?this.mMainCamera.aspect=this.mViewportWidth/this.mViewportHeight:"OrthographicCamera"===this.mMainCamera.type&&(this.mMainCamera.left=-this.mViewportWidth/2,this.mMainCamera.right=this.mViewportWidth/2,this.mMainCamera.top=this.mViewportHeight/2,this.mMainCamera.bottom=-this.mViewportHeight/2),this.mMainCamera.updateProjectionMatrix()),this.mRenderer&&this.mRenderer.setSize(this.mViewportWidth,this.mViewportHeight))},t.loadFromGltf=function(e){var t=new SpeGltfDecoder(e).decode(),i=t[0],r=t[1],a=t[2];this.mScene=i,this.mMainCamera=r,this.mSceneOptions=a;var n=void 0!==this.mSceneOptions.bgColor?(new THREE.Color).fromArray(this.mSceneOptions.bgColor):new THREE.Color(1644825),o=void 0!==this.mSceneOptions.bgAlpha?this.mSceneOptions.bgAlpha:0;this.mRenderer.setClearColor(n,o),this.mViewportMode=this.mSceneOptions.viewMode,this.mViewportWidth=this.mSceneOptions.viewWidth,this.mViewportHeight=this.mSceneOptions.viewHeight,this.mSceneOptions.useOrbitControls&&(this.mOrbitControls=new THREE.OrbitControls(this.mMainCamera,this.mRenderer.domElement),this.mOrbitControls.target.fromArray(this.mSceneOptions.orbitTarget),this.mOrbitControls.enableRotate=this.mSceneOptions.cameraRotate,this.mOrbitControls.enablePan=this.mSceneOptions.cameraPan,this.mOrbitControls.enableZoom=this.mSceneOptions.cameraZoom,this.mOrbitControls.enableDamping=this.mSceneOptions.orbitDamped,this.mOrbitControls.rotateSpeed=1,this.mOrbitControls.panSpeed=1),"function"==typeof Interaction&&(this.mPlayHandler=new PlayMode(this.mRenderer.domElement,this.mScene,this.mMainCamera))},e}(),SpeScene=function(e){function t(){return e.call(this)||this}return _inheritsLoose(t,e),t.prototype.traverseEntity=function(e){function t(i){if(i instanceof SpeMesh3D||i instanceof SpeMesh2D||i instanceof SpeTextContainer||i instanceof THREE.Group||i instanceof SpeEmptyObject||i instanceof SPE.CombinedCamera||i instanceof SPE.LightSpot||i instanceof SPE.LightPoint||i instanceof SPE.LightDirectional){e(i);for(var r=0;r<i.children.length;r++)t(i.children[r])}}for(var i=0;i<this.children.length;i++)t(this.children[i])},t}(THREE.Scene),SpeShaderLib=function(){function SpeShaderLib(){}return SpeShaderLib.SetupShader=function(e,t){e.fragmentShader="\n            /* SPE-Blending helper functions */\n            #define SPE_BLENDING_NORMAL 0\n            #define SPE_BLENDING_MULTIPLY 1\n            #define SPE_BLENDING_SCREEN 2\n            #define SPE_BLENDING_OVERLAY 3\n            vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {\n                return mix( a, b, alpha );\n            }\n            vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {\n                return mix( a, a * b, alpha );\n            }\n            vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {\n                vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );\n                return mix( a, tmp, alpha );\n            }\n            vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {\n                vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );\n                return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );\n            }\n            vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {\n                /**/ if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );\n                else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );\n                else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );\n                else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );\n                return vec3( 1.0 );\n            }\n            "+e.fragmentShader,e.vertexShader="\n            #ifdef SPE_USE_LAYER_FRESNEL\n                varying vec3 vWorldViewDir;\n                varying vec3 vWorldNormal;\n            #endif /* SPE_USE_LAYER_FRESNEL */\n            "+e.vertexShader,e.fragmentShader="\n            #ifdef SPE_USE_LAYER_FRESNEL\n                varying vec3 vWorldViewDir;\n                varying vec3 vWorldNormal;\n            #endif /* SPE_USE_LAYER_FRESNEL */\n            "+e.fragmentShader,e.vertexShader=e.vertexShader.replace("#include <project_vertex>","\n            #include <project_vertex>\n            #ifdef SPE_USE_LAYER_FRESNEL\n                vec4 fWorldPosition = modelMatrix * vec4( position, 1.0 );\n                vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ? \n                                    ( fWorldPosition.xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );\n                vWorldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );\n            #endif /* SPE_USE_LAYER_FRESNEL */\n            "),e.vertexShader="\n            #if defined( SPE_USE_LAYER_POINTS ) || defined( SPE_USE_LAYER_LINES )\n                attribute vec3 barycentric;\n                varying vec3 vBarycentric;\n            #endif /* SPE_USE_LAYER_POINTS || SPE_USE_LAYER_LINES */\n        "+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n            #include <begin_vertex>\n            #if defined( SPE_USE_LAYER_POINTS ) || defined( SPE_USE_LAYER_LINES )\n                vBarycentric = barycentric;\n            #endif /* SPE_USE_LAYER_POINTS || SPE_USE_LAYER_LINES */\n            "),e.fragmentShader="\n            #if defined( SPE_USE_LAYER_POINTS ) || defined( SPE_USE_LAYER_LINES )\n                varying vec3 vBarycentric;\n                float aastep( float threshold, float dist, float smoothOffset ) {\n                    float afwidth = fwidth( dist ) * 0.5;\n                    return smoothstep( threshold - afwidth - smoothOffset, threshold + afwidth + smoothOffset, dist );\n                }\n            #endif /* SPE_USE_LAYER_POINTS || SPE_USE_LAYER_LINES */\n        "+e.fragmentShader,e.fragmentShader="\n            #ifdef SPE_USE_LAYER_NOISE\n                float random ( in vec2 _st ) {\n                    return sin(sin(dot(_st.xy, vec2(12.834,77.212))) * 320.3456); // Ale: I am usin sin() instead of fract() to create a different noise.\n                }\n                float noise ( in vec2 _st ) {\n                    vec2 i = floor(_st);\n                    vec2 f = fract(_st);\n                    // Four corners in 2D of a tile\n                    float a = random(i);\n                    float b = random(i + vec2(1.0, 0.0)); // Ale: By incrementing disproportionally these values. You get a geometrical distortion.\n                    float c = random(i + vec2(0.0, 1.0));\n                    float d = random(i + vec2(1.0, 1.0));\n                    vec2 u = f * f * (3.0 - 2.0 * f);\n                    return mix(a, b, u.x) + (c - a)* u.y * (1.0 - u.x) + (d - b) * u.x * u.y;\n                }\n                float fbm ( in vec2 _st ) {\n                    float v = 0.0;\n                    float a = 0.5;\n                    vec2 shift = vec2(100.0);\n                    // Rotate to reduce axial bias\n                    mat2 rot = mat2(cos(0.5), sin(0.5),\n                                    -sin(0.5), cos(0.50));\n                    for (int i = 0; i < SPE_NOISE_NUM_OCTAVES; ++i) {\n                        v += a * noise(_st);\n                        _st = rot * _st * 2.0 + shift;\n                        a *= 0.5;\n                    }\n                    return v;\n                }\n            #endif /* SPE_USE_LAYER_NOISE */\n            "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <normal_fragment_begin>",""),e.fragmentShader=e.fragmentShader.replace("#include <normal_fragment_maps>",""),t instanceof SpeBasicMaterial&&(e.fragmentShader=e.fragmentShader.replace("#include <lights_phong_fragment>\n                #include <lights_fragment_begin>\n                #include <lights_fragment_maps>\n                #include <lights_fragment_end>",""),e.fragmentShader=e.fragmentShader.replace("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;","vec3 outgoingLight = diffuseColor.rgb;")),t instanceof SpeLambertMaterial&&(e.vertexShader="\n                #ifdef SPE_USE_LAYER_NORMAL\n                    varying vec3 vNormal;\n                #endif /* SPE_USE_LAYER_NORMAL */\n                "+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <defaultnormal_vertex>","\n                #include <defaultnormal_vertex>\n                #ifdef SPE_USE_LAYER_NORMAL\n                    vNormal = normalize( transformedNormal );\n                #endif /* SPE_USE_LAYER_NORMAL */\n                "),e.fragmentShader="\n                #ifdef SPE_USE_LAYER_NORMAL\n                    varying vec3 vNormal;\n                #endif /* SPE_USE_LAYER_NORMAL */\n                "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("vec4 diffuseColor = vec4( diffuse, opacity );","\n                #ifdef SPE_USE_LAYER_NORMAL\n                    #include <normal_fragment_begin>\n                    #include <normal_fragment_maps>\n                #endif /* SPE_USE_LAYER_NORMAL */\n                    float accumAlpha = 0.0;\n                    vec3 bef = vec3( 1.0 );\n                    #before\n                    vec4 diffuseColor = vec4( bef, 1.0 );\n                ")),e.vertexShader=e.vertexShader.replace("#include <common>","\n            #include <common>\n            #ifdef SPE_USE_LAYER_DEPTH\n                varying vec4 dWorldPosition;\n            #endif /* SPE_USE_LAYER_DEPTH */\n            "),e.vertexShader=e.vertexShader.replace("#include <worldpos_vertex>","\n            #include <worldpos_vertex>\n            #ifdef SPE_USE_LAYER_DEPTH\n                dWorldPosition = modelMatrix * vec4( transformed, 1.0 );\n            #endif\n            "),e.fragmentShader="\n            #ifdef SPE_USE_LAYER_DEPTH\n                varying vec4 dWorldPosition;\n            #endif /* SPE_USE_LAYER_DEPTH */\n            "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("vec4 diffuseColor = vec4( diffuse, opacity );","\n                #include <normal_fragment_begin>\n                #include <normal_fragment_maps>\n                float accumAlpha = 0.0;\n                vec3 bef = vec3( 1.0 );\n                #before\n                vec4 diffuseColor = vec4( bef, 1.0 );\n            "),e.fragmentShader=e.fragmentShader.replace("gl_FragColor = vec4( outgoingLight, diffuseColor.a );","\n                #lighting\n                vec3 aft = outgoingLight;\n                #after\n                gl_FragColor = vec4( aft, accumAlpha * opacity );\n            ")},SpeShaderLib.GetSetupCallback=function GetSetupCallback(material){for(var string="",e=0;e<material.uuid.length;++e){var t=material.uuid[e];"-"!=t&&(string+=t)}return eval("shader => {\n            // Hashing required as in issue https://github.com/mrdoob/three.js/issues/13192\n            const __hash___"+string+" = true;\n            const layersList = material.layersList;\n            // Inject base functionality into both vertex and fragment shaders\n            SpeShaderLib.SetupShader( shader, material );\n            shader.uniforms = THREE.UniformsUtils.merge( [ shader.uniforms, layersList.getUniforms() ] );\n            for ( let [key, uniform] of Object.entries( shader.uniforms ) ) {\n                if ( uniform.value && uniform.value.isTexture ) {\n                    uniform.value.needsUpdate = true;\n                }\n            }\n            // Inject shader-code in fragment shader previous to the lighting step\n            shader.fragmentShader = shader.fragmentShader.replace( '#before', layersList.getFragShaderCodePreLighting() );\n            // Inject shader-code in fragment shader for the lighting step\n            shader.fragmentShader = shader.fragmentShader.replace( '#lighting', layersList.getFragShaderCodeLighting() );\n            // Inject shader-code in fragment shader after the lighting step\n            shader.fragmentShader = shader.fragmentShader.replace( '#after', layersList.getFragShaderCodePostLighting() );\n            // Inject uniforms variables in both vertex and fragment shaders\n            shader.vertexShader = layersList.getVertUniformsCode() + shader.vertexShader;\n            shader.fragmentShader = layersList.getFragUniformsCode() + shader.fragmentShader;\n            // Inject defines in both vertex and fragment shaders\n            shader.vertexShader = layersList.getDefinesCode() + shader.vertexShader;\n            shader.fragmentShader = layersList.getDefinesCode() + shader.fragmentShader;\n            // Link the shader to its related layers-list\n            layersList.shader = shader;\n        }")},SpeShaderLib}(),SpeStack=function(){function e(){this.elements=[]}var t=e.prototype;return t.push=function(e){this.elements.push(e)},t.pop=function(){return 0===this.elements.length?null:this.elements.pop()},t.top=function(){return this.elements[this.elements.length-1]},t.empty=function(){return 0===this.elements.length},e}();function Interaction(e){this.uuid=THREE.MathUtils.generateUUID(),this.object=e,this.states=[],this.events=[],this.statesManager=new InteractionStatesManager(this)}function InteractionEvent(e,t){this.targets=[],this._type=e,this.key=t,this.ui={isCollapsed:!1}}function InteractionState(){this.uuid=THREE.MathUtils.generateUUID(),this.position=new THREE.Vector3,this.rotation=new THREE.Euler,this.scale=new THREE.Vector3,this.hiddenMatrix=new THREE.Matrix4}function InteractionTarget(){this.easing=InteractionTarget.EASING.EASE_IN_OUT,this.duration=1e3,this.delay=0,this.cubicControls=[.5,.05,.1,.3],this.springParameters={mass:1,stiffness:80,damping:10,velocity:0},this.repeat=!1,this.cycle=!1,this.rewind=!1,this.url=""}function InteractionStatesManager(e){this.i=e}function PlayMode(e,t,i){var r,a=new SPE.Raycaster,n={};function o(e){a.setFromCamera(m(e),i);for(var t=n[InteractionEvent.TYPE.MOUSE_DOWN],r=0,o=t.length;r<o;++r)if(a.intersectObject(t[r].object,!1).length>0){t[r].interactionEvent.dispatch();break}}function s(e){a.setFromCamera(m(e),i);for(var t=n[InteractionEvent.TYPE.MOUSE_UP],r=0,o=t.length;r<o;++r)if(a.intersectObject(t[r].object,!1).length>0){t[r].interactionEvent.dispatch();break}}function h(e){a.setFromCamera(m(e),i);var t=n[InteractionEvent.TYPE.MOUSE_HOVER].find((function(e){return a.intersectObject(e.object,!1).length>0})),o=void 0!==t?t.interactionEvent:void 0;r!==o&&(void 0!==r&&r.dispatchReverse(),void 0!==t&&o.dispatch()),r=o}function l(e){var t=-1*(e.pageX-window.innerWidth/2),i=1*(e.pageY-window.innerHeight/2);n[InteractionEvent.TYPE.LOOK_AT].forEach((function(e){e.object.interaction.lookAt(t,i)}))}function d(e){n[InteractionEvent.TYPE.KEY_DOWN].forEach((function(t){t.interactionEvent.key===e.key&&t.interactionEvent.dispatch()}))}function c(e){n[InteractionEvent.TYPE.KEY_UP].forEach((function(t){t.interactionEvent.key===e.key&&t.interactionEvent.dispatch()}))}function m(t){var i=e.getBoundingClientRect();return{x:(t.clientX-i.left)/i.width*2-1,y:-(t.clientY-i.top)/i.height*2+1}}this.activate=function(){for(var i in this.isEnable=!0,InteractionEvent.TYPE)n[InteractionEvent.TYPE[i]]=[];t.traverseEntity((function(e){if(void 0!==e.interaction){e.interaction.start();for(var t=e.interaction.events,i=0,r=t.length;i<r;++i)n[t[i].type].push({interactionEvent:t[i],object:e})}})),n[InteractionEvent.TYPE.MOUSE_DOWN].length>0&&e.addEventListener("pointerdown",o,!1),n[InteractionEvent.TYPE.MOUSE_UP].length>0&&e.addEventListener("pointerup",s,!1),n[InteractionEvent.TYPE.MOUSE_HOVER].length>0&&e.addEventListener("pointermove",h,!1),n[InteractionEvent.TYPE.LOOK_AT].length>0&&e.addEventListener("mousemove",l,!1),n[InteractionEvent.TYPE.KEY_DOWN].length>0&&document.addEventListener("keydown",d,!1),n[InteractionEvent.TYPE.KEY_UP].length>0&&document.addEventListener("keyup",c,!1)},this.deactivate=function(){t.traverseEntity((function(e){void 0!==e.interaction&&e.interaction.end()})),n[InteractionEvent.TYPE.MOUSE_DOWN].length>0&&e.removeEventListener("pointerdown",o),n[InteractionEvent.TYPE.MOUSE_UP].length>0&&e.removeEventListener("pointerup",s),n[InteractionEvent.TYPE.MOUSE_HOVER].length>0&&e.removeEventListener("pointermove",h),n[InteractionEvent.TYPE.LOOK_AT].length>0&&e.removeEventListener("pointermove",l,!1),n[InteractionEvent.TYPE.KEY_DOWN].length>0&&document.removeEventListener("keydown",d),n[InteractionEvent.TYPE.KEY_UP].length>0&&document.removeEventListener("keyup",c),n={},this.isEnable=!1},this.reset=function(){t.traverseEntity((function(e){e.interaction.start()}))}}THREE.OrbitControls=function(e,t){var i,r,a,n,o,s;void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN},this.touches={ONE:THREE.TOUCH.ROTATE,TWO:THREE.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.saveState=function(){h.target0.copy(h.target),h.position0.copy(h.object.position),h.zoom0=h.object.zoom},this.reset=function(){h.target.copy(h.target0),h.object.position.copy(h.position0),h.object.zoom=h.zoom0,h.object.updateProjectionMatrix(),h.dispatchEvent(l),h.update(),u=m.NONE},this.update=(i=new THREE.Vector3,r=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),a=r.clone().inverse(),n=new THREE.Vector3,o=new THREE.Quaternion,s=2*Math.PI,function(){var e=h.object.position;i.copy(e).sub(h.target),i.applyQuaternion(r),f.setFromVector3(i),h.autoRotate&&u===m.NONE&&P(2*Math.PI/60/60*h.autoRotateSpeed),h.enableDamping?(f.theta+=v.theta*h.dampingFactor,f.phi+=v.phi*h.dampingFactor):(f.theta+=v.theta,f.phi+=v.phi);var t=h.minAzimuthAngle,d=h.maxAzimuthAngle;return isFinite(t)&&isFinite(d)&&(t<-Math.PI?t+=s:t>Math.PI&&(t-=s),d<-Math.PI?d+=s:d>Math.PI&&(d-=s),f.theta=t<d?Math.max(t,Math.min(d,f.theta)):f.theta>(t+d)/2?Math.max(t,f.theta):Math.min(d,f.theta)),f.phi=Math.max(h.minPolarAngle,Math.min(h.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=E,f.radius=Math.max(h.minDistance,Math.min(h.maxDistance,f.radius)),!0===h.enableDamping?h.target.addScaledVector(g,h.dampingFactor):h.target.add(g),i.setFromSpherical(f),i.applyQuaternion(a),e.copy(h.target).add(i),h.object.lookAt(h.target),!0===h.enableDamping?(v.theta*=1-h.dampingFactor,v.phi*=1-h.dampingFactor,g.multiplyScalar(1-h.dampingFactor)):(v.set(0,0,0),g.set(0,0,0)),E=1,!!(y||n.distanceToSquared(h.object.position)>p||8*(1-o.dot(h.object.quaternion))>p)&&(h.dispatchEvent(l),n.copy(h.object.position),o.copy(h.object.quaternion),y=!1,!0)}),this.dispose=function(){h.domElement.removeEventListener("contextmenu",ee,!1),h.domElement.removeEventListener("pointerdown",W,!1),h.domElement.removeEventListener("wheel",J,!1),h.domElement.removeEventListener("touchstart",Z,!1),h.domElement.removeEventListener("touchend",$,!1),h.domElement.removeEventListener("touchmove",Q,!1),h.domElement.ownerDocument.removeEventListener("pointermove",X,!1),h.domElement.ownerDocument.removeEventListener("pointerup",q,!1),h.domElement.removeEventListener("keydown",K,!1)};var h=this,l={type:"change"},d={type:"start"},c={type:"end"},m={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},u=m.NONE,p=1e-6,f=new THREE.Spherical,v=new THREE.Spherical,E=1,g=new THREE.Vector3,y=!1,_=new THREE.Vector2,S=new THREE.Vector2,x=new THREE.Vector2,b=new THREE.Vector2,w=new THREE.Vector2,T=new THREE.Vector2,R=new THREE.Vector2,M=new THREE.Vector2,L=new THREE.Vector2;function I(){return Math.pow(.95,h.zoomSpeed)}function P(e){v.theta-=e}function H(e){v.phi-=e}var A,C=(A=new THREE.Vector3,function(e,t){A.setFromMatrixColumn(t,0),A.multiplyScalar(-e),g.add(A)}),D=function(){var e=new THREE.Vector3;return function(t,i){!0===h.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(h.object.up,e)),e.multiplyScalar(t),g.add(e)}}(),O=function(){var e=new THREE.Vector3;return function(t,i){var r=h.domElement;if(h.object.isPerspectiveCamera){var a=h.object.position;e.copy(a).sub(h.target);var n=e.length();n*=Math.tan(h.object.fov/2*Math.PI/180),C(2*t*n/r.clientHeight,h.object.matrix),D(2*i*n/r.clientHeight,h.object.matrix)}else h.object.isOrthographicCamera?(C(t*(h.object.right-h.object.left)/h.object.zoom/r.clientWidth,h.object.matrix),D(i*(h.object.top-h.object.bottom)/h.object.zoom/r.clientHeight,h.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),h.enablePan=!1)}}();function B(e){h.object.isPerspectiveCamera?E/=e:h.object.isOrthographicCamera?(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom*e)),h.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function U(e){h.object.isPerspectiveCamera?E*=e:h.object.isOrthographicCamera?(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom/e)),h.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function G(e){_.set(e.clientX,e.clientY)}function z(e){b.set(e.clientX,e.clientY)}function N(e){if(1==e.touches.length)_.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);_.set(t,i)}}function V(e){if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,i)}}function F(e){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+i*i);R.set(0,r)}function j(e){if(1==e.touches.length)S.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);S.set(t,i)}x.subVectors(S,_).multiplyScalar(h.rotateSpeed);var r=h.domElement;P(2*Math.PI*x.x/r.clientHeight),H(2*Math.PI*x.y/r.clientHeight),_.copy(S)}function Y(e){if(1==e.touches.length)w.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(t,i)}T.subVectors(w,b).multiplyScalar(h.panSpeed),O(T.x,T.y),b.copy(w)}function k(e){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+i*i);M.set(0,r),L.set(0,Math.pow(M.y/R.y,h.zoomSpeed)),B(L.y),R.copy(M)}function W(e){if(!1!==h.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){var t;switch(e.preventDefault(),h.domElement.focus?h.domElement.focus():window.focus(),e.button){case 0:t=h.mouseButtons.LEFT;break;case 1:t=h.mouseButtons.MIDDLE;break;case 2:t=h.mouseButtons.RIGHT;break;default:t=-1}switch(t){case THREE.MOUSE.DOLLY:if(!1===h.enableZoom)return;!function(e){R.set(e.clientX,e.clientY)}(e),u=m.DOLLY;break;case THREE.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===h.enablePan)return;z(e),u=m.PAN}else{if(!1===h.enableRotate)return;G(e),u=m.ROTATE}break;case THREE.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===h.enableRotate)return;G(e),u=m.ROTATE}else{if(!1===h.enablePan)return;z(e),u=m.PAN}break;default:u=m.NONE}u!==m.NONE&&(h.domElement.ownerDocument.addEventListener("pointermove",X,!1),h.domElement.ownerDocument.addEventListener("pointerup",q,!1),h.dispatchEvent(d))}(e)}}function X(e){if(!1!==h.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1!==h.enabled)switch(e.preventDefault(),u){case m.ROTATE:if(!1===h.enableRotate)return;!function(e){S.set(e.clientX,e.clientY),x.subVectors(S,_).multiplyScalar(h.rotateSpeed);var t=h.domElement;P(2*Math.PI*x.x/t.clientHeight),H(2*Math.PI*x.y/t.clientHeight),_.copy(S),h.update()}(e);break;case m.DOLLY:if(!1===h.enableZoom)return;!function(e){M.set(e.clientX,e.clientY),L.subVectors(M,R),L.y>0?B(I()):L.y<0&&U(I()),R.copy(M),h.update()}(e);break;case m.PAN:if(!1===h.enablePan)return;!function(e){w.set(e.clientX,e.clientY),T.subVectors(w,b).multiplyScalar(h.panSpeed),O(T.x,T.y),b.copy(w),h.update()}(e)}}(e)}}function q(e){if(!1!==h.enabled)switch(e.pointerType){case"mouse":case"pen":!1!==h.enabled&&(h.domElement.ownerDocument.removeEventListener("pointermove",X,!1),h.domElement.ownerDocument.removeEventListener("pointerup",q,!1),h.dispatchEvent(c),u=m.NONE)}}function J(e){!1===h.enabled||!1===h.enableZoom||u!==m.NONE&&u!==m.ROTATE||(e.preventDefault(),e.stopPropagation(),h.dispatchEvent(d),function(e){e.deltaY<0?U(I()):e.deltaY>0&&B(I()),h.update()}(e),h.dispatchEvent(c))}function K(e){!1!==h.enabled&&!1!==h.enableKeys&&!1!==h.enablePan&&function(e){var t=!1;switch(e.keyCode){case h.keys.UP:O(0,h.keyPanSpeed),t=!0;break;case h.keys.BOTTOM:O(0,-h.keyPanSpeed),t=!0;break;case h.keys.LEFT:O(h.keyPanSpeed,0),t=!0;break;case h.keys.RIGHT:O(-h.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),h.update())}(e)}function Z(e){if(!1!==h.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(h.touches.ONE){case THREE.TOUCH.ROTATE:if(!1===h.enableRotate)return;N(e),u=m.TOUCH_ROTATE;break;case THREE.TOUCH.PAN:if(!1===h.enablePan)return;V(e),u=m.TOUCH_PAN;break;default:u=m.NONE}break;case 2:switch(h.touches.TWO){case THREE.TOUCH.DOLLY_PAN:if(!1===h.enableZoom&&!1===h.enablePan)return;!function(e){h.enableZoom&&F(e),h.enablePan&&V(e)}(e),u=m.TOUCH_DOLLY_PAN;break;case THREE.TOUCH.DOLLY_ROTATE:if(!1===h.enableZoom&&!1===h.enableRotate)return;!function(e){h.enableZoom&&F(e),h.enableRotate&&N(e)}(e),u=m.TOUCH_DOLLY_ROTATE;break;default:u=m.NONE}break;default:u=m.NONE}u!==m.NONE&&h.dispatchEvent(d)}}function Q(e){if(!1!==h.enabled)switch(e.preventDefault(),e.stopPropagation(),u){case m.TOUCH_ROTATE:if(!1===h.enableRotate)return;j(e),h.update();break;case m.TOUCH_PAN:if(!1===h.enablePan)return;Y(e),h.update();break;case m.TOUCH_DOLLY_PAN:if(!1===h.enableZoom&&!1===h.enablePan)return;!function(e){h.enableZoom&&k(e),h.enablePan&&Y(e)}(e),h.update();break;case m.TOUCH_DOLLY_ROTATE:if(!1===h.enableZoom&&!1===h.enableRotate)return;!function(e){h.enableZoom&&k(e),h.enableRotate&&j(e)}(e),h.update();break;default:u=m.NONE}}function $(e){!1!==h.enabled&&(h.dispatchEvent(c),u=m.NONE)}function ee(e){!1!==h.enabled&&e.preventDefault()}h.domElement.addEventListener("contextmenu",ee,!1),h.domElement.addEventListener("pointerdown",W,!1),h.domElement.addEventListener("wheel",J,!1),h.domElement.addEventListener("touchstart",Z,!1),h.domElement.addEventListener("touchend",$,!1),h.domElement.addEventListener("touchmove",Q,!1),h.domElement.addEventListener("keydown",K,!1),-1===h.domElement.tabIndex&&(h.domElement.tabIndex=0),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,THREE.MapControls=function(e,t){THREE.OrbitControls.call(this,e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=THREE.MOUSE.PAN,this.mouseButtons.RIGHT=THREE.MOUSE.ROTATE,this.touches.ONE=THREE.TOUCH.PAN,this.touches.TWO=THREE.TOUCH.DOLLY_ROTATE},THREE.MapControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.MapControls.prototype.constructor=THREE.MapControls,Interaction.targets=new Set,Interaction.prototype={constructor:Interaction,newState:function(e){var t=new InteractionState;return t.name=e,t.update(this.object),this.selectedState=this.states.length,this.states.push(t),t},addState:function(e,t){this.states.splice(t,0,e)},removeState:function(e){this.selectedState===e&&(this.selectedState=void 0),this.states.splice(e,1)},selectState:function(e){void 0!==e&&this.states[e].execute(this.object),this.selectedState=e},getEventType:function(e){return this.events.find((function(t){return t.type===e}))},hasEventType:function(e,t){return e===InteractionEvent.TYPE.KEY_DOWN||e===InteractionEvent.TYPE.KEY_UP?void 0!==t&&this.events.some((function(i){return i.type===e&&i.key===t})):this.events.some((function(t){return t.type===e}))},newEvent:function(){var e=this,t=InteractionEvent.ORDER.find((function(t){return!1===e.hasEventType(t)})),i=new InteractionEvent(t);return this.events.push(i),i},addEvent:function(e,t){this.events.splice(t,0,e);for(var i=this.events[t].targets,r=0,a=i.length;r<a;++r)void 0!==i[r].object&&Interaction.targets.add(i[r])},removeEvent:function(e){for(var t=this.events[e].targets,i=0,r=t.length;i<r;++i)void 0!==t[i].object&&Interaction.targets.delete(t[i]);this.events.splice(e,1)},copy:function(e){this.selectedState=e.selectedState;for(var t=0,i=e.states.length;t<i;++t)this.addState(e.states[t].clone(),t);for(var r=0,a=e.events.length;r<a;++r){this.addEvent(e.events[r].clone(),r);for(var n=e.events[r].targets,o=0,s=n.length;o<s;++o){var h=n[o].clone();n[o].object===e.object?(h.object=this.object,h.state=this.states[e.states.indexOf(n[o].state)]):(h.object=n[o].object,h.state=n[o].state),this.events[r].addTarget(h,o)}}return this},clone:function(e){return new Interaction(e).copy(this)},toJSON:function(e){var t,i,r={};if(r.uuid=this.uuid,void 0!==this.selectedState&&(r.selectedState=this.selectedState),this.states.length>0){r.states=[];for(var a=0,n=this.states.length;a<n;++a)r.states.push((void 0===(t=e.interactionStates)[(i=this.states[a]).uuid]&&(t[i.uuid]=i.toJSON(e)),i.uuid))}if(this.events.length>0){r.events=[];for(var o=0,s=this.events.length;o<s;++o)r.events.push(this.events[o].toJSON(e))}return r},fromJSON:function(e,t,i){if(this.uuid=e.uuid,this.selectedState=e.selectedState,this.states=[],this.events=[],void 0!==e.states)for(var r=0,a=e.states.length;r<a;++r)this.states.push(i[e.states[r]]);if(void 0!==e.events)for(var n=0,o=e.events.length;n<o;++n)this.events.push((new InteractionEvent).fromJSON(e.events[n],t,i));return this},start:function(){if(void 0!==this.animation&&(this.animation.pause(),this.animation=void 0,this._removeBackLayer()),this.states.length>1){this.states[0].execute(this.object),this.currentState=this.states[0],this.prevState=void 0;var e=this.getEventType(InteractionEvent.TYPE.START);void 0!==e&&e.targets.length>0&&this.play(e.targets[0])}},end:function(){void 0!==this.animation&&(this.animation.pause(),this.animation=void 0,this._removeBackLayer()),this.states.length>1&&this.states[this.selectedState].execute(this.object),this.currentState=void 0,this.prevState=void 0},lookAt:function(e,t){var i=new THREE.Vector3(e,t,-600);this.object.lookAt(i)},play:function(e){void 0!==e.state&&this.animate(e.state,e)},reverse:function(e){this.animate(this.prevState,e)},_removeBackLayer:function(){if(void 0!==this.object.material){var e=this.object.material;if(Array.isArray(e))for(var t=0,i=e.length;t<i;++t)for(var r=e[t].layersList,a=r.head;a;)if(a.backLayer){delete a.backLayer;var n=a.next;r.removeLayer(a.id),a=n}else a.isBack?(delete a.isBack,a=a.next):a=a.next;else for(var o=e.layersList,s=o.head;s;)for(;s;)if(s.backLayer){delete s.backLayer;var h=s.next;o.removeLayer(s.id),s=h}else s.isBack?(delete s.isBack,s=s.next):s=s.next}},getTimingFunction:function(e,t,i){switch(e){case InteractionTarget.EASING.LINEAR:return"cubicBezier( 0, 0, 1, 1 )";case InteractionTarget.EASING.EASE:return"cubicBezier( .25, .1, .25, 1 )";case InteractionTarget.EASING.EASE_IN:return"cubicBezier( .42, 0, 1, 1 )";case InteractionTarget.EASING.EASE_OUT:return"cubicBezier( 0, 0, .58, 1 )";case InteractionTarget.EASING.EASE_IN_OUT:return"cubicBezier( .42, 0, .58, 1 )";case InteractionTarget.EASING.CUBIC:return"cubicBezier( "+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+" )";case InteractionTarget.EASING.SPRING:return"spring( "+i.mass+", "+i.stiffness+", "+i.damping+", "+i.velocity+" )"}},animate:function(e,t){var i=this;this.currentState!==e&&(this.prevState=this.currentState,this.currentState=e),void 0!==this.animation&&this.animation.pause(),this._removeBackLayer(),!0===t.cycle&&!0===t.repeat?this.animation=anime.timeline({duration:t.duration,delay:t.delay/2,endDelay:t.delay/2,direction:"alternate",loop:!0,rewind:t.rewind,easing:this.getTimingFunction(t.easing,t.cubicControls,t.springParameters)}):!0===t.cycle&&!1===t.repeat?this.animation=anime.timeline({duration:t.duration,delay:t.delay,endDelay:t.delay/2,direction:"alternate",rewind:t.rewind,easing:this.getTimingFunction(t.easing,t.cubicControls,t.springParameters)}):!1===t.cycle&&!0===t.repeat?this.animation=anime.timeline({duration:t.duration,delay:t.delay,direction:"normal",loop:!0,easing:this.getTimingFunction(t.easing,t.cubicControls,t.springParameters)}):this.animation=anime.timeline({duration:t.duration,delay:t.delay,direction:"normal",easing:this.getTimingFunction(t.easing,t.cubicControls,t.springParameters)}),this.animation.finished.then((function(){i._removeBackLayer()})),this.animateMatrix(e),this.animateGeometry(e),this.animateMaterial(e),this.animateCamera(e)},animateMatrix:function(e){var t=this;if(!1===this.object.position.equals(e.position)){var i=this.object.position.clone(),r={t:0};this.animation.add({targets:r,t:1,update:function(){t.object.position.lerpVectors(i,e.position,r.t)}},0)}if(!1===this.object.scale.equals(e.scale)){var a=this.object.scale.clone(),n={t:0};this.animation.add({targets:n,t:1,update:function(){t.object.scale.lerpVectors(a,e.scale,n.t)}},0)}if(!1===this.object.rotation.equals(e.rotation)){var o=this.object.quaternion.clone(),s={t:0},h={x:this.object.rotation.x-e.rotation.x,y:this.object.rotation.y-e.rotation.y,z:this.object.rotation.z-e.rotation.z},l=e.rotation.clone(),d=.01*THREE.Math.DEG2RAD,c=359.99*THREE.Math.DEG2RAD;h.x===2*Math.PI?0===l.x?l.x=d:l.x===2*Math.PI&&(l.x=c):h.x===2*-Math.PI&&(0===l.x?l.x=-d:l.x===2*Math.PI&&(l.x=-c)),h.y===2*Math.PI?0===l.y?l.y=d:l.y===2*Math.PI&&(l.y=c):h.y===2*-Math.PI&&(0===l.y?l.y=-d:l.y===2*Math.PI&&(l.y=-c)),h.z===2*Math.PI?0===l.z?l.z=d:l.z===2*Math.PI&&(l.z=c):h.z===2*-Math.PI&&(0===l.z?l.z=-d:l.z===2*Math.PI&&(l.z=-c));var m=(new THREE.Quaternion).setFromEuler(l);this.animation.add({targets:s,t:1,update:function(){SPE.Math.slerp(o,m,t.object.quaternion,s.t)}},0)}var u=new THREE.Vector3,p=new THREE.Quaternion,f=new THREE.Vector3,v=new THREE.Vector3,E=new THREE.Quaternion,g=new THREE.Vector3,y=new THREE.Vector3,_=new THREE.Quaternion,S=new THREE.Vector3;if(this.object.hiddenMatrix.decompose(u,p,f),e.hiddenMatrix.decompose(v,E,g),!1===this.object.hiddenMatrix.equals(e.hiddenMatrix)){var x={t:0};this.animation.add({targets:x,t:1,update:function(){THREE.Quaternion.slerp(p,E,_,x.t),y.lerpVectors(u,v,x.t),S.lerpVectors(f,g,x.t),t.object.hiddenMatrix.compose(y,_,S)}},0)}},animateGeometry:function(e){var t=this;if(void 0!==this.object.geometry){var i=this.object.geometry.userData.parameters;e.geometry.width===i.width&&e.geometry.height===i.height&&e.geometry.depth===i.depth||this.animation.add({targets:this.object.geometry.userData.parameters,width:e.geometry.width,height:e.geometry.height,depth:e.geometry.depth,update:function(){var e=SPE[t.object.geometry.userData.type].buildFromGeometry(t.object.geometry,{width:i.width,height:i.height,depth:i.depth});t.object.updateGeometry(e)}},0)}},animateMaterial:function(e){var t=this;if(void 0!==this.object.material){var i=function(e,i,r,a){for(var n=e.layersList,o=function(e,o){var s=a[e],h="f"+i.id+"_"+s,l="f"+r.id+"_"+s,d=i.uniforms[h],c=r.uniforms[l];"mode"!==s&&"boolean"!=typeof d.value?"number"!=typeof d.value?d.value instanceof THREE.Vector2?!1===d.value.equals(c.value)&&t.animation.add({targets:d.value,x:c.value.x,y:c.value.y,update:function(){n.updateLayerUniformByLayer(i,h)}},0):d.value instanceof THREE.Vector3?!1===d.value.equals(c.value)&&t.animation.add({targets:d.value,x:c.value.x,y:c.value.y,z:c.value.z,update:function(){n.updateLayerUniformByLayer(i,h)}},0):d.value instanceof THREE.Color&&!1===d.value.equals(c.value)&&t.animation.add({targets:d.value,r:c.value.r,g:c.value.g,b:c.value.b,update:function(){n.updateLayerUniformByLayer(i,h)}},0):d.value!==c.value&&t.animation.add({targets:d,value:c.value,update:function(){n.updateLayerUniformByLayer(i,h)}},0):d.value!==c.value&&(d.value=c.value,n.updateLayerUniformByLayer(i,h))},s=0,h=(a=void 0!==a?a:i.paramNames).length;s<h;++s)o(s);if(i.backLayer){var l=i.backLayer.id,d="f"+l+"_alpha",c=i.backLayer.uniforms[d];t.animation.add({targets:c,value:0,update:function(){n.updateLayerUniform(l,d)}},0)}},r=function(e,i,r){var a=e.layersList;if(void 0===i.backLayer){var n=r.getValues();n.alpha=0,i.backLayer=a.addLayerBeforeAt(n,i),i.backLayer.isBack=!0,e.dispose()}var o="f"+i.id+"_alpha",s="f"+i.backLayer.id+"_alpha",h=i.uniforms[o],l=i.backLayer.uniforms[s];t.animation.add({targets:h,value:0,update:function(){a.updateLayerUniformByLayer(i,o)}},0).add({targets:l,value:r.uniforms["f"+r.id+"_alpha"].value,update:function(){a.updateLayerUniformByLayer(i.backLayer,s)}},0)},a=function(e,r,a){var n=e.layersList,o="f"+r.id+"_mat",s="f"+r.id+"_texture",h=r.uniforms[s].value,l=a.uniforms["f"+a.id+"_texture"].value,d=r.uniforms["f"+r.id+"_crop"],c=a.uniforms["f"+a.id+"_crop"];if(d.value!==c.value&&(d.value=c.value,n.updateLayerUniformByLayer(r,"f"+r.id+"_crop")),h.wrapS===l.wrapS&&h.wrapT===l.wrapT||(h.wrapS=l.wrapS,h.wrapT=l.wrapT,h.needsUpdate=!0,n.updateLayerUniform(r,s)),!1===h.matrix.equals(l.matrix)){var m={repeatX:h.repeat.x,repeatY:h.repeat.y,offsetX:h.offset.x,offsetY:h.offset.y};t.animation.add({targets:m,repeatX:l.repeat.x,repeatY:l.repeat.y,offsetX:l.offset.x,offsetY:l.offset.y,update:function(){h.repeat.set(m.repeatX,m.repeatY),h.offset.set(m.offsetX,m.offsetY),h.updateMatrix(),n.updateLayerUniformByLayer(r,o)}},0)}i(e,r,a,["alpha","mode"])},n=function(e,r,a){var n=e.layersList,o=r.uniforms["f"+r.id+"_num"],s=a.uniforms["f"+a.id+"_num"],h="f"+r.id+"_steps",l="f"+a.id+"_steps",d=r.uniforms[h],c=a.uniforms[l],m="f"+r.id+"_colors",u="f"+a.id+"_colors",p=r.uniforms[m],f=a.uniforms[u];if(o.value<=s.value){for(var v=p.value[o.value-1],E=o.value;E<s.value;++E)d.value[E]=1,n.updateLayerUniformByLayer(r,m),p.value[E].set(v.x,v.y,v.z,v.w),n.updateLayerUniformByLayer(r,h);o.value!==s.value&&(o.value=s.value,n.updateLayerUniformByLayer(r,"f"+r.id+"_num"));for(var g=function(e){var i=p.value[e],a=f.value[e];if(d.value[e]!==c.value[e]||!1===i.equals(a)){var o={value:d.value[e]};t.animation.add({targets:[o,i],value:c.value[e],x:a.x,y:a.y,z:a.z,w:a.w,update:function(){d.value[e]=o.value,n.updateLayerUniformByLayer(r,h),n.updateLayerUniformByLayer(r,m)}},0)}},y=0;y<s.value;++y)g(y)}else!function(){for(var e=[],i=function(i){var a=p.value[i],o=f.value[i];d.value[i]===c.value[i]&&!1!==a.equals(o)||e.push(new Promise((function(e){var s={value:d.value[i]};t.animation.add({targets:[s,a],value:c.value[i],x:o.x,y:o.y,z:o.z,w:o.w,update:function(){d.value[i]=s.value,n.updateLayerUniformByLayer(r,h),n.updateLayerUniformByLayer(r,m)},complete:function(){e(i)}},0)})))},a=0;a<s.value;++a)i(a);for(var l=f.value[s.value-1],u=function(i){var a=p.value[i];d.value[i]===c.value[i]&&!1!==a.equals(l)||e.push(new Promise((function(e){var o={value:d.value[i]};t.animation.add({targets:[o,a],value:1,x:l.x,y:l.y,z:l.z,w:l.w,update:function(){d.value[i]=o.value,n.updateLayerUniformByLayer(r,h),n.updateLayerUniformByLayer(r,m)},complete:function(){e(i)}},0)})))},v=s.value;v<o.value;++v)u(v);Promise.all(e).then((function(){o.value=s.value,n.updateLayerUniformByLayer(r,"f"+r.id+"_num")}))}();i(e,r,a,["alpha","mode","gl_type","smooth","offset","morph","angle"])};if(Array.isArray(this.object.material))for(var o=0,s=this.object.material.length;o<s;++o)h(this.object.material[o],e.material[o]);else h(this.object.material,e.material)}function h(e,t){for(var o=e.layersList.head,s=0;o;)if(!0!==o.isBack){var h=t.layersList[s++];if("texture"===o.type){var l=o.uniforms["f"+o.id+"_texture"].value,d=h.uniforms["f"+h.id+"_texture"].value;l.image===d.image?a(e,o,h):r(e,o,h)}else"gradient"===o.type?o.uniforms["f"+o.id+"_gl_type"].value===h.uniforms["f"+h.id+"_gl_type"].value?n(e,o,h):r(e,o,h):i(e,o,h);o=o.next}else o=o.next}},animateCamera:function(e){var t=this;if(this.object.isCamera){var i=this.object.isPerspectiveCamera?e.camera.zoomPersp:e.camera.zoomOrtho;this.object.zoom!==i&&this.animation.add({targets:this.object,zoom:i,update:function(){t.object.updateProjectionMatrix()}},0)}}},InteractionEvent.TYPE={MOUSE_DOWN:0,MOUSE_UP:1,MOUSE_HOVER:2,MOUSE_ENTER:3,MOUSE_LEAVE:4,KEY_DOWN:5,KEY_UP:6,START:7,LOOK_AT:8,SCROLL:9},InteractionEvent.ORDER=[InteractionEvent.TYPE.MOUSE_DOWN,InteractionEvent.TYPE.MOUSE_UP,InteractionEvent.TYPE.MOUSE_HOVER,InteractionEvent.TYPE.KEY_DOWN],InteractionEvent.prototype={constructor:InteractionEvent,get type(){return this._type},set type(e){this._type=e,e!==InteractionEvent.TYPE.KEY_DOWN&&e!==InteractionEvent.TYPE.KEY_UP&&(this.key=void 0)},newTarget:function(e){var t=new InteractionTarget;return t.object=e,e.interaction.states.length>0&&(t.state=e.interaction.states[e.interaction.states.length-1]),this.targets.push(t),Interaction.targets.add(t),t},addTarget:function(e,t){this.targets.splice(t,0,e),Interaction.targets.add(e)},removeTarget:function(e){Interaction.targets.delete(this.targets[e]),this.targets.splice(e,1)},dispatchReverse:function(){for(var e=0,t=this.targets.length;e<t;++e){var i=this.targets[e];void 0!==i.state&&i.object.interaction.reverse(i)}},dispatch:function(){for(var e=0,t=this.targets.length;e<t;++e){var i=this.targets[e];void 0!==i.state&&i.object.interaction.play(i)}},copy:function(e){return this.ui.isCollapsed=e.ui.isCollapsed,this},clone:function(){return new InteractionEvent(this.type,this.key).copy(this)},toJSON:function(e){var t={type:this._type,key:this.key,ui:{isCollapsed:this.ui.isCollapsed}};if(this.targets.length>0){t.targets=[];for(var i=0,r=this.targets.length;i<r;++i)t.targets.push(this.targets[i].toJSON(e))}return t},fromJSON:function(e,t,i){if(this._type=e.type,this.key=e.key,this.targets=[],this.ui={isCollapsed:e.ui.isCollapsed},void 0!==e.targets)for(var r=0,a=e.targets.length;r<a;++r)this.addTarget((new InteractionTarget).fromJSON(e.targets[r],t,i));return this}},InteractionState.prototype={constructor:InteractionState,update:function(e){this.updateMatrix(e),this.updateGeometry(e),this.updateMaterial(e),this.updateCamera(e)},updateCamera:function(e){e.isCamera&&(this.camera={zoomPersp:e.perspCamera.zoom,zoomOrtho:e.orthoCamera.zoom})},updateMatrix:function(e){this.position.copy(e.position),this.rotation.copy(e.rotation),this.scale.copy(e.scale),this.hiddenMatrix.copy(e.hiddenMatrix)},updateGeometry:function(e){if(void 0!==e.geometry){var t=e.geometry.userData.parameters;this.geometry={width:t.width,height:t.height,depth:t.depth}}},updateMaterial:function(e){if(void 0!==e.material)if(!0===Array.isArray(e.material)){this.material=[];for(var t=0,i=e.material.length;t<i;++t){for(var r=[],a=e.material[t].layersList.head;a;)r.push(a.clone()),a=a.next;this.material.push({layersList:r})}}else{for(var n=[],o=e.material.layersList.head;o;)n.push(o.clone()),o=o.next;this.material={layersList:n}}},execute:function(e){if(e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale),e.hiddenMatrix.copy(this.hiddenMatrix),void 0!==e.geometry){var t=e.geometry.userData.parameters;if(this.geometry.width!==t.width||this.geometry.height!==t.height||this.geometry.depth!==t.depth){var i=SPE[e.geometry.userData.type].buildFromGeometry(e.geometry,{width:this.geometry.width,height:this.geometry.height,depth:this.geometry.depth});e.updateGeometry(i)}}if(void 0!==e.material){var r=e.material;if(!0===Array.isArray(r))for(var a=0,n=this.material.length;a<n;++a){for(var o=r[a].layersList.head,s=this.material[a].layersList,h=0;o;)o.copy(s[h++]),o=o.next;r[a].dispose()}else{for(var l=r.layersList.head,d=this.material.layersList,c=0;l;)l.copyUniforms(d[c++]),l=l.next;r.dispose()}}this.camera&&(e.zoom=e.isPerspectiveCamera?this.camera.zoomPersp:this.camera.zoomOrtho,e.updateProjectionMatrix())},copy:function(e){if(this.name=e.name,this.position.copy(e.position),this.rotation.copy(e.rotation),this.scale.copy(e.scale),this.hiddenMatrix.copy(e.hiddenMatrix),void 0!==e.geometry&&(this.geometry={width:e.geometry.width,height:e.geometry.height,depth:e.geometry.depth}),void 0!==e.material)if(!0===Array.isArray(e.material)){this.material=[];for(var t=0,i=e.material.length;t<i;++t)this.material.push({layersList:e.material[t].layersList.map((function(e){return e.clone()}))})}else this.material={layersList:e.material.layersList.map((function(e){return e.clone()}))};return void 0!==e.camera&&(this.camera={zoomPersp:e.camera.zoomPersp,zoomOrtho:e.camera.zoomOrtho}),this},clone:function(){return(new InteractionState).copy(this)},toJSON:function(e){var t={uuid:this.uuid,name:this.name,position:this.position.toArray(),rotation:this.rotation.toArray(),scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};if(void 0!==this.geometry&&(t.geometry={width:this.geometry.width,height:this.geometry.height,depth:this.geometry.depth}),void 0!==this.material)if(!0===Array.isArray(this.material)){t.material=[];for(var i=0,r=this.material.length;i<r;++i)t.material.push({layersList:this.material[i].layersList.map((function(t){return t.toJSON(e)}))})}else t.material={layersList:this.material.layersList.map((function(t){return t.toJSON(e)}))};return void 0!==this.camera&&(t.camera={zoomPersp:this.camera.zoomPersp,zoomOrtho:this.camera.zoomOrtho}),t},fromJSON:function(e,t){if(this.uuid=e.uuid,this.name=e.name,this.position.fromArray(e.position),void 0!==e.rotation)this.rotation.fromArray(e.rotation);else{var i=(new THREE.Quaternion).fromArray(e.quaternion);this.rotation.setFromQuaternion(i)}if(this.scale.fromArray(e.scale),this.hiddenMatrix.fromArray(e.hiddenMatrix),void 0!==e.geometry&&(this.geometry={width:e.geometry.width,height:e.geometry.height,depth:e.geometry.depth}),void 0!==e.material)if(!0===Array.isArray(e.material)){this.material=[];for(var r=0,a=e.material.length;r<a;++r)this.material.push({layersList:e.material[r].layersList.map((function(e){return SPE.CreateLayerFromJSON(e,t)}))})}else this.material={layersList:e.material.layersList.map((function(e){return SPE.CreateLayerFromJSON(e,t)}))};return void 0!==e.camera&&(this.camera={zoomPersp:e.camera.zoomPersp,zoomOrtho:e.camera.zoomOrtho}),this}},InteractionTarget.EASING={LINEAR:0,EASE:1,EASE_IN:2,EASE_OUT:3,EASE_IN_OUT:4,CUBIC:5,SPRING:6},InteractionTarget.prototype={constructor:InteractionTarget,get sp_mass(){return this.springParameters.mass},set sp_mass(e){this.springParameters.mass=e},get sp_stiffness(){return this.springParameters.stiffness},set sp_stiffness(e){this.springParameters.stiffness=e},get sp_damping(){return this.springParameters.damping},set sp_damping(e){this.springParameters.damping=e},get sp_velocity(){return this.springParameters.velocity},set sp_velocity(e){this.springParameters.velocity=e},get interaction(){return void 0!==this._object?this._object.interaction:void 0},get object(){return this._object},set object(e){if(void 0!==e){var t=e.interaction.states;this.state=t.length>0?t[t.length-1]:void 0}else this.state=void 0;this._object=e},copy:function(e){return this.easing=e.easing,this.duration=e.duration,this.delay=e.delay,this.cubicControls=[].concat(e.cubicControls),this.springParameters={mass:e.springParameters.mass,stiffness:e.springParameters.stiffness,damping:e.springParameters.damping,velocity:e.springParameters.velocity},this.repeat=e.repeat,this.cycle=e.cycle,this.rewind=e.rewind,this},clone:function(){return(new InteractionTarget).copy(this)},toJSON:function(){var e={easing:this.easing,duration:this.duration,delay:this.delay,cubicControls:this.cubicControls,springParameters:{mass:this.springParameters.mass,stiffness:this.springParameters.stiffness,damping:this.springParameters.damping,velocity:this.springParameters.velocity},repeat:this.repeat,cycle:this.cycle,rewind:this.rewind};return void 0!==this.object&&(e.object=this.object.uuid),void 0!==this.state&&(e.state=this.state.uuid),e},fromJSON:function(e,t,i){return void 0!==e.object&&(this._object=t[e.object]),void 0!==e.state&&(this.state=i[e.state]),this.easing=e.easing,this.duration=e.duration,this.delay=e.delay,this.cubicControls=[].concat(e.cubicControls),this.repeat=e.repeat,this.cycle=e.cycle,this.rewind=void 0!==e.rewind&&e.rewind,void 0!==e.springControls?(this.springParameters.mass=e.springControls[0],this.springParameters.stiffness=e.springControls[1],this.springParameters.damping=e.springControls[2],this.springParameters.velocity=e.springControls[3]):(this.springParameters.mass=e.springParameters.mass,this.springParameters.stiffness=e.springParameters.stiffness,this.springParameters.damping=e.springParameters.damping,this.springParameters.velocity=e.springParameters.velocity),this}},InteractionStatesManager.prototype={updateObject:function(){void 0!==this.i.selectedState&&this.i.states[this.i.selectedState].updateMatrix(this.i.object)},updateCamera:function(){void 0!==this.i.selectedState&&(this.i.states[this.i.selectedState].updateMatrix(this.i.object),this.i.states[this.i.selectedState].updateCamera(this.i.object))},updateGeometry:function(){void 0!==this.i.selectedState&&(this.i.states[this.i.selectedState].updateMatrix(this.i.object),this.i.states[this.i.selectedState].updateGeometry(this.i.object))},updateSceneGraph:function(e){var t=new THREE.Matrix4,i=new THREE.Matrix4;e.updateWorldMatrix(!0,!1);for(var r=0,a=this.i.states.length;r<a;++r){var n=this.i.states[r];t.getInverse(e.matrixWorld),null!==this.i.object.parent&&(this.i.object.parent.updateWorldMatrix(!0,!1),t.multiply(this.i.object.parent.matrixWorld)),!0===this.i.object.isLight?(i.compose(n.position,n.quaternion,n.scale),i.premultiply(t),i.decompose(n.position,n.quaternion,n.scale)):n.hiddenMatrix.premultiply(t)}},updateMaterialLayer:function(e){if(void 0!==this.i.selectedState){var t=this.i.object.userData.selectedMaterial;(void 0!==t?this.i.states[this.i.selectedState].material[t]:this.i.states[this.i.selectedState].material).layersList.find((function(t){return t.id===e.id})).copy(e)}},pushMaterialLayer:function(e){if(0!==this.i.states.length)if(!0===Array.isArray(this.i.object.material))for(var t=this.i.object.userData.selectedMaterial,i=0,r=this.i.states.length;i<r;++i){var a=e.clone();this.i.selectedState!==i&&(a.uniforms["f"+a.id+"_alpha"].value=0),this.i.states[i].material[t].layersList.push(a)}else for(var n=0,o=this.i.states.length;n<o;++n){var s=e.clone();this.i.selectedState!==n&&(s.uniforms["f"+s.id+"_alpha"].value=0),this.i.states[n].material.layersList.push(s)}},popMaterialLayer:function(){if(0!==this.i.states.length)if(!0===Array.isArray(this.i.object.material))for(var e=this.i.object.userData.selectedMaterial,t=0,i=this.i.states.length;t<i;++t)this.i.states[t].material[e].layersList.pop();else for(var r=0,a=this.i.states.length;r<a;++r)this.i.states[r].material.layersList.pop()},removeMaterialLayer:function(e){if(0!==this.i.states.length){var t=[];if(!0===Array.isArray(this.i.object.material))for(var i=0,r=this.i.states.length;i<r;++i){var a=this.i.object.userData.selectedMaterial,n=this.i.states[i].material[a];t.push({layer:n.layersList[e]}),n.layersList.splice(e,1)}else for(var o=0,s=this.i.states.length;o<s;++o){var h=this.i.states[o].material;t.push({layer:h.layersList[e]}),h.layersList.splice(e,1)}return{states:t,pos:e}}},restoreMaterialLayerRemoved:function(e){if(0!==this.i.states.length)if(!0===Array.isArray(this.i.object.material))for(var t=0,i=this.i.states.length;t<i;++t){var r=this.i.object.userData.selectedMaterial;this.i.states[t].material[r].layersList.splice(e.pos,0,e.states[t].layer)}else for(var a=0,n=this.i.states.length;a<n;++a)this.i.states[a].material.layersList.splice(e.pos,0,e.states[a].layer)},changeMaterialLayer:function(e){if(0!==this.i.states.length){var t,i=[];if(!0===Array.isArray(this.i.object.material)){for(var r=this.i.object.userData.selectedMaterial,a=this.i.states[this.i.selectedState].material[r].layersList,n=0,o=a.length;n<o;++n)if(a[n].id===e.id){t=n;break}for(var s=0,h=this.i.states.length;s<h;++s){var l=this.i.states[s].material[r].layersList[t],d=e.clone();this.i.selectedState!==s&&(d.uniforms["f"+d.id+"_alpha"].value=l.uniforms["f"+l.id+"_alpha"].value),this.i.states[s].material[r].layersList[t]=d,i.push({layer:l})}}else{for(var c=this.i.states[this.i.selectedState].material.layersList,m=0,u=c.length;m<u;++m)if(c[m].id===e.id){t=m;break}for(var p=0,f=this.i.states.length;p<f;++p){var v=this.i.states[p].material.layersList[t],E=e.clone();this.i.selectedState!==p&&(E.uniforms["f"+E.id+"_alpha"].value=v.uniforms["f"+v.id+"_alpha"].value),this.i.states[p].material.layersList[t]=E,i.push({layer:v})}}return{states:i,pos:t}}},restoreMaterialLayerChanged:function(e){if(0!==this.i.states.length)if(!0===Array.isArray(this.i.object.material))for(var t=this.i.object.userData.selectedMaterial,i=0,r=this.i.states.length;i<r;++i)this.i.states[i].material[t].layersList[e.pos]=e.states[i].layer;else for(var a=0,n=this.i.states.length;a<n;++a)this.i.states[a].material.layersList[e.pos]=e.states[a].layer},moveMaterialLayer:function(e,t){if(0!==this.i.states.length)if(!0===Array.isArray(this.i.object.material))for(var i=this.i.object.userData.selectedMaterial,r=0,a=this.i.states.length;r<a;++r){var n=this.i.states[r].material[i].layersList,o=n[e];n[e]=n[t],n[t]=o}else for(var s=0,h=this.i.states.length;s<h;++s){var l=this.i.states[s].material.layersList,d=l[e];l[e]=l[t],l[t]=d}},restoreMaterialLayerMoved:function(e,t){this.moveMaterialLayer(e,t)},setMaterialLayers:function(e){var t=[];if(Array.isArray(this.i.object.material))for(var i=this.i.object.userData.selectedMaterial,r=0,a=this.i.states.length;r<a;++r){var n=this.i.states[r].material[i];t.push({layersList:n.layersList});var o=e.head;for(n.layersList=[];void 0!==o;)n.layersList.push(o.clone()),o=o.next}else for(var s=0,h=this.i.states.length;s<h;++s){var l=this.i.states[s].material;t.push({layersList:l.layersList});var d=e.head;for(l.layersList=[];void 0!==d;)l.layersList.push(d.clone()),d=d.next}return{states:t}},restoreMaterialLayersSet:function(e){if(Array.isArray(this.i.object.material))for(var t=object.userData.selectedMaterial,i=0,r=this.i.states.length;i<r;++i)this.i.states[i].material[t].layersList=e.states[i].layersList;else for(var a=0,n=this.i.states.length;a<n;++a)this.i.states[a].material.layersList=e.states[a].layersList}},SPE.ConeGeometry=new function(){this.build=function(e){var t,i=e.width,r=void 0===i?100:i,a=e.height,n=void 0===a?r:a,o=e.depth,s=void 0===o?r:o,h=e.radialSegments,l=void 0===h?32:h,d=e.heightSegments,c=void 0===d?32:d,m=e.openEnded,u=e.thetaStart,p=e.thetaLength,f=void 0===p?360:p,v=e.cornerRadiusTop,E=void 0===v?0:v,g=e.cornerRadiusBottom,y=void 0===g?0:g,_=e.cornerSegments,S=void 0===_?8:_;return r=Math.abs(r),n=Math.abs(n),s=Math.abs(s),(t=E>0||y>0||f<360?new SPE.CylinderGeometry.RoundedCylinderBufferGeometry(0,r/2,n,l,c,m,u,f*Math.PI/180,E,y,S,0,!0):new THREE.ConeBufferGeometry(r/2,n,l,c,m)).scale(1,1,s/r),t.userData={type:"ConeGeometry",parameters:{width:r,height:n,depth:s,radialSegments:l,heightSegments:c,openEnded:m,thetaStart:u,thetaLength:f,cornerRadiusTop:E,cornerRadiusBottom:y,cornerSegments:S}},t},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.radialSegments,l=void 0===h?e.userData.parameters.radialSegments:h,d=t.heightSegments,c=void 0===d?e.userData.parameters.heightSegments:d,m=t.openEnded,u=void 0===m?e.userData.parameters.openEnded:m,p=t.thetaStart,f=void 0===p?e.userData.parameters.thetaStart:p,v=t.thetaLength,E=void 0===v?e.userData.parameters.thetaLength:v,g=t.cornerRadiusTop,y=void 0===g?e.userData.parameters.cornerRadiusTop:g,_=t.cornerRadiusBottom,S=void 0===_?e.userData.parameters.cornerRadiusBottom:_,x=t.cornerSegments,b=void 0===x?e.userData.parameters.cornerSegments:x;return this.build({width:r,height:n,depth:s,radialSegments:l,heightSegments:c,openEnded:u,thetaStart:f,thetaLength:E,cornerRadiusTop:y,cornerRadiusBottom:S,cornerSegments:b})}},SPE.CubeGeometry=new function(){this.build=function(e){var t,i=e.width,r=void 0===i?100:i,a=e.height,n=void 0===a?r:a,o=e.depth,s=void 0===o?r:o,h=e.widthSegments,l=void 0===h?1:h,d=e.heightSegments,c=void 0===d?1:d,m=e.depthSegments,u=void 0===m?1:m,p=e.cornerRadius,f=void 0===p?0:p,v=e.cornerSegments,E=void 0===v?8:v;return r=Math.abs(r),n=Math.abs(n),s=Math.abs(s),(t=0==f?new THREE.BoxBufferGeometry(r,n,s,l,c,u):new RoundedBoxBufferGeometry(r,n,s,l,c,u,f,E)).userData={type:"CubeGeometry",parameters:{width:r,height:n,depth:s,widthSegments:l,heightSegments:c,depthSegments:u,cornerRadius:f,cornerSegments:E}},t},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.widthSegments,l=void 0===h?e.userData.parameters.widthSegments:h,d=t.heightSegments,c=void 0===d?e.userData.parameters.heightSegments:d,m=t.depthSegments,u=void 0===m?e.userData.parameters.depthSegments:m,p=t.cornerRadius,f=void 0===p?e.userData.parameters.cornerRadius:p,v=t.cornerSegments,E=void 0===v?e.userData.parameters.cornerSegments:v;return this.build({width:r,height:n,depth:s,widthSegments:l,heightSegments:c,depthSegments:u,cornerRadius:f,cornerSegments:E})}};var pi2=Math.PI/2,RoundedBoxBufferGeometry=function(e){function t(t,i,r,a,n,o,s,h){var l;void 0===t&&(t=1),void 0===i&&(i=1),void 0===r&&(r=1),void 0===a&&(a=1),void 0===n&&(n=1),void 0===o&&(o=1),void 0===s&&(s=0),void 0===h&&(h=4);var d=THREE.Vector3;(l=e.call(this)||this).type="BoxBufferGeometry",l.parameters={width:t,height:i,depth:r,widthSegments:a,heightSegments:n,depthSegments:o,cornerRadius:s,cornerSegments:h};var c=_assertThisInitialized(l);a=Math.floor(a),n=Math.floor(n),o=Math.floor(o),h=Math.floor(h),s=Math.min(s,t/2,i/2,r/2);var m=[],u=[],p=[],f=[],v=0,E=0;function g(e,t,i,r,a,n,o,h,l,g,y){for(var _=(n-2*s)/l,S=(o-2*s)/g,x=n/2-s,b=o/2-s,w=h/2,T=l+1,R=g+1,M=0,L=0,I=new d,P=0;P<R;P++)for(var H=P*S-b,A=0;A<T;A++){var C=A*_-x;I[e]=C*r,I[t]=H*a,I[i]=w,u.push(I.x,I.y,I.z),I[e]=0,I[t]=0,I[i]=h>0?1:-1,p.push(I.x,I.y,I.z),f.push(A/l),f.push(1-P/g),M+=1}for(var D=0;D<g;D++)for(var O=0;O<l;O++){var B=v+O+T*D,U=v+O+T*(D+1),G=v+(O+1)+T*(D+1),z=v+(O+1)+T*D;m.push(B,U,z),m.push(U,G,z),L+=6}c.addGroup(E,L,y),E+=L,v+=M}function y(e,t,i,r,a,n,o,l,g,y,_){for(var S=(o-2*s)/y,x=o/2-s,b=l/2-s,w=g/2,T=y+1,R=0,M=0,L=new d,I=new d,P=0;P<h+1;P++){var H=P/h*pi2,A=Math.sin(H)*s,C=(1-Math.cos(H))*s,D=Math.sin(H),O=Math.cos(H);L[t]=(b+A)*a,L[i]=(w-C)*n,I[e]=0,I[t]=D*Math.sign(L[t]),I[i]=O*Math.sign(L[i]);for(var B=0;B<T;B++){var U=B*S-x;L[e]=U*r,u.push(L.x,L.y,L.z),p.push(I.x,I.y,I.z),f.push(B/y),f.push(0),R+=1}}for(var G=0;G<h;G++)for(var z=0;z<y;z++){var N=v+z+T*G,V=v+z+T*(G+1),F=v+(z+1)+T*(G+1),j=v+(z+1)+T*G;m.push(N,V,j),m.push(V,F,j),M+=6}c.addGroup(E,M,_),E+=M,v+=R}function _(e,a,n){var o=new d,l=new d(t/2,i/2,r/2);l.subScalar(s);for(var c=[],E=e*a*n>0?function(e,t,i){m.push(e,t,i)}:function(e,t,i){m.push(e,i,t)},g=0;g<=h;g++){for(var y=[],_=pi2*(1-g/h),S=Math.cos(_),x=Math.sin(_),b=0,w=0;w<=g;w++){var T=Math.cos(b),R=Math.sin(b);o.x=S*T,o.y=x,o.z=S*R;var M=l.clone().addScaledVector(o,s);u.push(e*M.x,a*M.y,n*M.z),p.push(e*o.x,a*o.y,n*o.z),f.push(0,0),y.push(v++),b+=pi2/g}c.push(y)}for(var L=c.length-1,I=0;I<L;I++){var P=c[I],H=c[I+1],A=P.length-1;E(P[0],H[1],H[0]);for(var C=1;C<=A;C++)E(P[C-1],P[C],H[C]),E(P[C],H[C+1],H[C])}}return g("z","y","x",-1,-1,r,i,t,o,n,0),g("z","y","x",1,-1,r,i,-t,o,n,1),g("x","z","y",1,1,t,r,i,a,o,2),g("x","z","y",1,-1,t,r,-i,a,o,3),g("x","y","z",1,-1,t,i,r,a,n,4),g("x","y","z",-1,-1,t,i,-r,a,n,5),s>0&&(y("z","y","x",-1,-1,1,r,i,t,o,0),y("z","y","x",1,-1,-1,r,i,t,o,1),y("z","y","x",-1,1,-1,r,i,t,o,1),y("z","y","x",1,1,1,r,i,t,o,0),y("x","y","z",-1,-1,-1,t,i,r,a,0),y("x","y","z",1,-1,1,t,i,r,a,1),y("x","y","z",-1,1,1,t,i,r,a,0),y("x","y","z",1,1,-1,t,i,r,a,1),y("y","x","z",-1,-1,1,i,t,r,n,0),y("y","x","z",1,-1,-1,i,t,r,n,1),y("y","x","z",1,1,1,i,t,r,n,1),y("y","x","z",-1,1,-1,i,t,r,n,0),_(1,1,1),_(-1,1,1),_(1,-1,1),_(-1,-1,1),_(1,1,-1),_(-1,1,-1),_(1,-1,-1),_(-1,-1,-1)),l.setIndex(m),l.setAttribute("position",new THREE.Float32BufferAttribute(u,3)),l.setAttribute("normal",new THREE.Float32BufferAttribute(p,3)),l.setAttribute("uv",new THREE.Float32BufferAttribute(f,2)),l}return _inheritsLoose(t,e),t}(THREE.BufferGeometry);function flip(e){return new THREE.Vector2(e.y,-e.x)}SPE.CylinderGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=e.depth,o=void 0===n?i:n,s=e.radiusTop,h=void 0===s?i/2:s,l=e.radiusBottom,d=void 0===l?i/2:l,c=e.radialSegments,m=void 0===c?64:c,u=e.heightSegments,p=void 0===u?1:u,f=e.openEnded,v=void 0!==f&&f,E=e.thetaStart,g=e.thetaLength,y=void 0===g?360:g,_=e.cornerRadius,S=void 0===_?0:_,x=e.cornerSegments,b=void 0===x?8:x,w=e.hollow,T=void 0===w?0:w;i=Math.abs(i),a=Math.abs(a),o=Math.abs(o);var R=i/2;h===d?(h=R,d=R):h>d?d=d*R/(h=R):(h=h*R/d,d=R);var M=new RoundedCylinderBufferGeometry(h,d,a,m,p,v,E,y*Math.PI/180,S,S,b,T);return M.scale(1,1,o/i),M.userData={type:"CylinderGeometry",parameters:{width:i,height:a,depth:o,radiusTop:h,radiusBottom:d,radialSegments:m,heightSegments:p,openEnded:v,thetaStart:E,thetaLength:y,cornerRadius:S,cornerSegments:b,hollow:T}},M},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.radiusTop,l=void 0===h?e.userData.parameters.radiusTop:h,d=t.radiusBottom,c=void 0===d?e.userData.parameters.radiusBottom:d,m=t.radialSegments,u=void 0===m?e.userData.parameters.radialSegments:m,p=t.heightSegments,f=void 0===p?e.userData.parameters.heightSegments:p,v=t.openEnded,E=void 0===v?e.userData.parameters.openEnded:v,g=t.thetaStart,y=void 0===g?e.userData.parameters.thetaStart:g,_=t.thetaLength,S=void 0===_?e.userData.parameters.thetaLength:_,x=t.cornerRadius,b=void 0===x?e.userData.parameters.cornerRadius:x,w=t.cornerSegments,T=void 0===w?e.userData.parameters.cornerSegments:w,R=t.hollow,M=void 0===R?e.userData.parameters.hollow:R;return this.build({width:r,height:n,depth:s,radiusTop:l,radiusBottom:c,radialSegments:u,heightSegments:f,openEnded:E,thetaStart:y,thetaLength:S,cornerRadius:b,cornerSegments:T,hollow:M})}};var RoundedCylinderBufferGeometry=function(e){function t(t,i,r,a,n,o,s,h,l,d,c,m,u){var p,f;void 0===u&&(u=!1),(f=e.call(this)||this).type="RoundedCylinderBufferGeometry",f.parameters=((p={radiusTop:t,radiusBottom:i,height:r,radialSegments:a,heightSegments:n,openEnded:o,thetaStart:s,thetaLength:h,cornerRadius:l}).cornerRadius=d,p.cornerSegments=c,p.hollow=m,p);var v=THREE.Vector2,E=THREE.Vector3,g=THREE.Float32BufferAttribute;t=void 0!==t?t:1,i=void 0!==i?i:1,r=r||1,a=Math.floor(a)||8,n=Math.floor(n)||1,o=void 0!==o&&o,s=void 0!==s?s:0,h=void 0!==h?h:2*Math.PI,o&&(l=0,d=0);var y=[],_=[],S=[],x=[],b=0,w=r/2,T=new E,R=new E;u&&0==t&&(t=l),u&&0==i&&(i=d);var M=new v(t,w),L=new v(i,-w),I=null,P=null,H=null,A=null,C=M.clone().sub(L),D=0,O=0,B=0;m>0&&(D=Math.min(t,i)*(1-m),O=t-D,B=i-D);var U=M.clone();U.x-=D;var G=Math.PI-C.angle(),z=C.angle(),N=Math.tan(z/2),V=Math.tan(G/2),F=N+V,j=m?F:V,Y=m?F:N;if(l=Math.min(l,(t-O)/j,C.length()/F),d=Math.min(d,(i-B)/Y,C.length()/F),l>0){var k=l/N;I=M.clone().sub(new v(k,l)),m&&((H=I.clone()).x-=D-F*l),M.sub(C.clone().setLength(k))}if(d>0){var W=d/V;P=L.clone().sub(new v(W,-d)),L.add(C.clone().setLength(W)),m&&((A=P.clone()).x-=D-F*d,U.sub(C.clone().setLength(W)))}for(var X=(C=M.clone().sub(L)).length()<.5,q=[],J=0;J<=a;J++){var K=[],Z=J/a,Q=Z*h+s,$=new v(Math.sin(Q),Math.cos(Q));if(A?(me(K,Z,$,G,d,A,-1,!0),me(K,Z,$,z,d,P,-1,!1)):P?(ue(K,$,P.x,0,-1),me(K,Z,$,z,d,P,-1,!1)):o||ue(K,$,i,B,-1),two2three(flip(C).normalize(),$,T),!X)for(var ee=0;ee<=n;ee++){var te=ee/n;two2three(C.clone().multiplyScalar(te).add(L),$,R),_.push(R.x,R.y,R.z),S.push(T.x,T.y,T.z),x.push(Z,.5+R.y/r),K.push(b++)}if(H?(me(K,Z,$,G,l,I,1,!1),me(K,Z,$,z,l,H,1,!0)):I?(me(K,Z,$,G,l,I,1,!1),ue(K,$,I.x,0,1)):o||ue(K,$,t,O,1),m&&!X){two2three(flip(C).multiplyScalar(-1).normalize(),$,T);for(var ie=0;ie<=n;ie++){var re=ie/n;two2three(C.clone().multiplyScalar(-re).add(U),$,R),_.push(R.x,R.y,R.z),S.push(T.x,T.y,T.z),x.push(Z,.5+R.y/r),K.push(b++)}}m&&!o&&K.push(K[0]),q.push(K)}for(var ae=0;ae<q.length-1;ae++)for(var ne=0;ne<q[0].length-1;ne++)if(!o||!m||ne!=n){var oe=q[ae][ne],se=q[ae+1][ne],he=q[ae+1][ne+1],le=q[ae][ne+1],de=_[3*he+0],ce=_[3*he+2];y.push(oe,se,le),0==de&&0==ce||y.push(se,he,le)}function me(e,t,i,a,n,o,s,h){for(var l=0;l<c+1;l++){var d=l/c,m=s<0?d:1-d;h&&(m-=1),m*=a;var u=new v(Math.sin(m),Math.cos(m)*s);two2three(u.clone().multiplyScalar(n).add(o),i,R),_.push(R.x,R.y,R.z),two2three(u,i,T),S.push(T.x,T.y,T.z),x.push(t,.5+R.y/r),e.push(b++)}}function ue(e,t,i,r,a){var n=new E,o=new v,s=[i,r];a<0&&s.reverse();for(var h=0,l=s;h<l.length;h++){var d=l[h];o.set(d,w*a),two2three(o,t,n),_.push(n.x,n.y,n.z),S.push(0,a,0),x.push(.5,.5),e.push(b++)}}function pe(e,r,a){var n=new v(Math.sin(a),Math.cos(a)),o=new v(-Math.cos(a),Math.sin(a)),s=new E,h=e<0?function(e,t,i){return y.push(e,t,i)}:function(e,t,i){return y.push(e,i,t)};two2three(new v((t+i+O+B)/4,0),n,s),_.push(s.x,s.y,s.z),S.push(o.x,0,o.y),x.push(.5,.5);for(var l,d=b++,c=_createForOfIteratorHelperLoose(r);!(l=c()).done;){var m=l.value,u=_.slice(3*m,3*m+3);_.push.apply(_,u),S.push(o.x,0,o.y);var p=x.slice(2*m,2*m+2);x.push.apply(x,p),b++}for(var f=d+1;f<b-1;f++)h(d,f,f+1);h(d,b-1,d+1)}return h<2*Math.PI&&(pe(-1,q[0],s),pe(1,q[q.length-1],s+h)),f.setIndex(y),f.setAttribute("position",new g(_,3)),f.setAttribute("normal",new g(S,3)),f.setAttribute("uv",new g(x,2)),f}return _inheritsLoose(t,e),t}(THREE.BufferGeometry);function two2three(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function offset3d(e,t,i,r,a,n){var o=t.clone().sub(e),s=i.clone().sub(e),h=o.angleTo(s);if(o.normalize(),s.normalize(),r===a){var l=o.add(s).normalize();n.copy(e).addScaledVector(l,r/Math.sin(h/2))}else{var d=o.angleTo(s);n.copy(e),n.addScaledVector(o,a/Math.sin(d)),n.addScaledVector(s,r/Math.sin(d))}}function projectOntoLine(e,t,i){var r=e.clone().sub(t),a=i.clone().sub(t);return r.projectOnVector(a),r.add(t)}SPE.CylinderGeometry.RoundedCylinderBufferGeometry=RoundedCylinderBufferGeometry,SPE.EllipseGeometry=new function(){this.build=function(e){var t,i=e.width,r=void 0===i?100:i,a=e.height,n=void 0===a?r:a,o=e.spikes,s=void 0===o?128:o,h=e.angle,l=void 0===h?360:h,d=e.innerRadius,c=void 0===d?0:d;if(c>0){var m=.5*r,u=c*m/100;(t=new THREE.RingBufferGeometry(u,m,s,1,Math.PI/2,l*Math.PI/180)).scale(1,Math.abs(n)/Math.abs(r),1)}else{for(var p=.5*(r=Math.abs(r)),f=.5*(n=Math.abs(n)),v=l*Math.PI/180*-1/s,E=new THREE.Shape,g=0;g<=s;g++){var y=v*g,_=0+Math.sin(y)*p,S=0+Math.cos(y)*f;E.lineTo(_,S)}360===l&&(E.curves=E.curves.slice(1)),t=new THREE.ShapeBufferGeometry(E),SPE.Math.fixUvs(t,r,n)}return t.userData={type:"EllipseGeometry",parameters:{width:r,height:n,depth:0,spikes:s,angle:l,innerRadius:c}},t},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.spikes,s=void 0===o?e.userData.parameters.spikes:o,h=t.angle,l=void 0===h?e.userData.parameters.angle:h,d=t.innerRadius,c=void 0===d?e.userData.parameters.innerRadius:d;return this.build({width:r,height:n,spikes:s,angle:l,innerRadius:c})}},SPE.IcosahedronGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=e.depth,o=void 0===n?i:n,s=e.detail,h=void 0===s?0:s;i=Math.abs(i),a=Math.abs(a),o=Math.abs(o);var l=new THREE.IcosahedronBufferGeometry(.5*i,h);return l.scale(1,a/i,o/i),l.userData={type:"IcosahedronGeometry",parameters:{width:i,height:a,depth:o,detail:h}},l},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.detail,l=void 0===h?e.userData.parameters.detail:h;return this.build({width:r,height:n,depth:s,detail:l})}},SPE.PolygonGeometry=new function(){this.build=function(e){for(var t,i=e.width,r=void 0===i?100:i,a=e.height,n=void 0===a?r:a,o=e.spikes,s=void 0===o?5:o,h=e.cornerRadius,l=void 0===h?0:h,d=e.extrudeDepth,c=void 0===d?0:d,m=e.extrudeBevelSize,u=void 0===m?0:m,p=e.extrudeBevelSegments,f=void 0===p?1:p,v=.5*(r=Math.abs(r)),E=.5*(n=Math.abs(n)),g=2*Math.PI/s,y=new THREE.Shape,_=0;_<=s;_++){var S=g*_,x=0+Math.sin(S)*v,b=0+Math.cos(S)*E;y.lineTo(x,b)}return 0!==l&&SPE.Geometry.Utils.roundShapePolygon(y,y.getPoints(),l),(t=c>0?new THREE.ExtrudeBufferGeometry(y,{curveSegments:64,steps:1,depth:c,bevelEnabled:!0,bevelThickness:u,bevelSize:u,bevelOffset:0,bevelSegments:f}):new THREE.ShapeBufferGeometry(y,32)).userData={type:"PolygonGeometry",parameters:{width:r,height:n,depth:0,spikes:s,cornerRadius:l,extrudeDepth:c,extrudeBevelSize:u,extrudeBevelSegments:f}},SPE.Math.fixUvs(t,r,n),t},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.spikes,s=void 0===o?e.userData.parameters.spikes:o,h=t.cornerRadius,l=void 0===h?e.userData.parameters.cornerRadius:h,d=t.extrudeDepth,c=void 0===d?e.userData.parameters.extrudeDepth:d,m=t.extrudeBevelSize,u=void 0===m?e.userData.parameters.extrudeBevelSize:m,p=t.extrudeBevelSegments,f=void 0===p?e.userData.parameters.extrudeBevelSegments:p;return this.build({width:r,height:n,spikes:s,cornerRadius:l,extrudeDepth:c,extrudeBevelSize:u,extrudeBevelSegments:f})}},SPE.PyramidGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=e.depth,o=void 0===n?i:n,s=e.radialSegments,h=void 0===s?4:s,l=e.heightSegments,d=void 0===l?1:l,c=e.openEnded,m=e.cornerRadius,u=void 0===m?0:m,p=e.cornerSegments,f=void 0===p?8:p;i=Math.abs(i),a=Math.abs(a),o=Math.abs(o);var v=new RoundedPyramidBufferGeometry(.5*i,a,h,d,c,u,f);return v.scale(1,1,o/i),v.userData={type:"PyramidGeometry",parameters:{width:i,height:a,depth:o,radialSegments:h,heightSegments:d,openEnded:c,cornerRadius:u,cornerSegments:f}},v},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.radialSegments,l=void 0===h?e.userData.parameters.radialSegments:h,d=t.heightSegments,c=void 0===d?e.userData.parameters.heightSegments:d,m=t.openEnded,u=void 0===m?e.userData.parameters.openEnded:m,p=t.cornerRadius,f=void 0===p?e.userData.parameters.cornerRadius:p,v=t.cornerSegments,E=void 0===v?e.userData.parameters.cornerSegments:v;return this.build({width:r,height:n,depth:s,radialSegments:l,heightSegments:c,openEnded:u,cornerRadius:f,cornerSegments:E})}};var RoundedPyramidBufferGeometry=function(e){function t(t,i,r,a,n,o,s){var h;void 0===t&&(t=.5),void 0===i&&(i=1),void 0===r&&(r=4),void 0===a&&(a=1),void 0===n&&(n=!1),void 0===o&&(o=0),void 0===s&&(s=4);var l=THREE.Vector2,d=THREE.Vector3;(h=e.call(this)||this).type="RoundedPyramidBufferGeometry",h.parameters={radius:t,height:i,radialSegments:r,heightSegments:a,openEnded:n,cornerRadius:o,cornerSegments:s},r=Math.floor(Math.max(3,r)),a=Math.floor(a),s=Math.floor(s);var c,m=[],u=[],p=[],f=[],v=0,E=i/2,g=Math.PI/r,y=t*Math.cos(Math.PI/r),_=2*Math.PI/r,S=(r-2)*Math.PI/r,x=Math.PI-S,b=new d(0,-E,0),w=new d(0,E,0),T=new l(t,-E),R=new l(y,-E),M=(new l).copy(w).sub(R),L=(new l).copy(w).sub(T),I=new l(M.y,-M.x).normalize(),P=new l(L.y,-L.x).normalize(),H=t*Math.cos(Math.PI/r)*Math.tan((Math.PI-M.angle())/2)-1e-8;o=Math.min(o,H);var A=new d(I.x,I.y,0),C=new d(Math.cos(_)*A.x,A.y,Math.sin(_)*A.x);c=A.angleTo(C);var D=o/Math.tan((Math.PI-M.angle())/2),O=o/Math.tan((Math.PI-c)/2),B=new d;if(!n){u.push(b.x,b.y,b.z),p.push(0,-1,0),f.push(0,0);var U=v++,G=[],z=T.clone(),N=D/Math.cos(Math.PI/r);z.x-=N;for(var V=0;V<r;V++){var F=V/r*Math.PI*2+g;two2three(z,new l(Math.sin(F),Math.cos(F)),B),u.push(B.x,B.y,B.z),p.push(0,-1,0),f.push(0,0),G.push(v++)}for(var j=0;j<G.length;j++)m.push(G[j],U,G[(j+1)%G.length])}for(var Y=new d,k=new d,W=new d,X=new d,q=new d,J=new d,K=0;K<r;K++){var Z=K/r*Math.PI*2+g,Q=(K+.5)/r*Math.PI*2+g,$=(K+1)/r*Math.PI*2+g,ee=new l(Math.sin(Z),Math.cos(Z)),te=new l(Math.sin(Q),Math.cos(Q)),ie=new l(Math.sin($),Math.cos($));two2three(T,ee,k),two2three(T,ie,W),two2three(I,te,Y),offset3d(w,k,W,O,O,X),u.push(X.x,X.y,X.z),offset3d(k,w,W,O,D,q),u.push(q.x,q.y,q.z),offset3d(W,k,w,D,O,J),u.push(J.x,J.y,J.z),p.push(Y.x,Y.y,Y.z),p.push(Y.x,Y.y,Y.z),p.push(Y.x,Y.y,Y.z),f.push(0,0),f.push(0,0),f.push(0,0);var re=v++,ae=v++,ne=v++;if(m.push(re,ae,ne),o>0){var oe=k.clone().add(W).multiplyScalar(.5),se=w.clone().sub(oe).normalize(),he=b.clone().sub(oe).normalize().add(se).normalize().multiplyScalar(-1);Ge(oe,J.clone().sub(q),he,M.angle());var le,de=void 0,ce=new d;two2three(P,ie,ce);var me=J.clone().add(X).multiplyScalar(.5),ue=Ge(me=projectOntoLine(me,W,w),J.clone().sub(X),ce,c,X.y);le=ue[0],de=ue[1];var pe=le,fe=pe.clone().setY(0).normalize(),ve=new d(0,-1,0),Ee=fe.clone().cross(ve);ze(pe,fe,ve,Ee);var ge=M.angle(),ye=Math.PI-ge,_e=w.clone();_e.y-=o/Math.sin(ge-Math.PI/2),new d;for(var Se=new d,xe=[],be=0;be<s;be++){for(var we=[],Te=Math.PI/2-ye*be/s,Re=Math.cos(Te),Me=Math.sin(Te),Le=Q,Ie=0;Ie<=be;Ie++){var Pe=Math.cos(Le),He=Math.sin(Le);Y.x=Re*He,Y.y=Me,Y.z=Re*Pe,Se.copy(_e).addScaledVector(Y,o),u.push(Se.x,Se.y,Se.z),p.push(Y.x,Y.y,Y.z),f.push(0,0),we.push(v++),Le+=2*Math.PI/be/r}xe.push(we)}de.reverse(),xe.push(de);for(var Ae=xe.length-1,Ce=0;Ce<Ae;Ce++){var De=xe[Ce],Oe=xe[Ce+1],Be=De.length-1;m.push(Oe[1],De[0],Oe[0]);for(var Ue=1;Ue<=Be;Ue++)m.push(De[Ue],De[Ue-1],Oe[Ue]),m.push(Oe[Ue+1],De[Ue],Oe[Ue])}}}function Ge(e,t,i,r,a){var n=-r/2,h=(Math.PI-r)/2,l=t.clone().normalize().cross(i);e.addScaledVector(i,-o/Math.sin(h));for(var c=new d,E=new d,g=v,y=[],_=0;_<=s;_++){var S=n+_/s*r;E.set(0,0,0),E.addScaledVector(l,Math.sin(S)),E.addScaledVector(i,Math.cos(S));for(var x=0;x<=1;x++){var b=x/1-.5;if(c.copy(e),c.addScaledVector(t,b),c.addScaledVector(E,o),null!=a){var w=Math.max(0,c.y-a);c.addScaledVector(t,-w/t.y)}u.push(c.x,c.y,c.z),p.push(E.x,E.y,E.z),f.push(0,0),0===x&&y.push(v),v++}}for(var T=0;T<s;T++)for(var R=0;R<1;R++){var M=g+R+2*T,L=M+2,I=L+1,P=M+1;m.push(M,L,P),m.push(L,I,P)}return[e.clone().addScaledVector(t,.5),y]}function ze(e,t,i,r){for(var a=Math.PI/2,n=L.angle()-a,h=[],l=new d,c=new d,E=0;E<=s;E++){for(var g=[],y=E/s,_=0;_<=E;_++){var S=((E?_/E:0)-.5)*x,b=Math.cos(S),w=Math.sin(S),T=(a+Math.atan(Math.tan(n)*b))*y,R=Math.cos(T),M=Math.sin(T);l.set(0,0,0),l.addScaledVector(t,M*b),l.addScaledVector(i,R),l.addScaledVector(r,M*w),c.copy(e).addScaledVector(l,o),u.push(c.x,c.y,c.z),p.push(l.x,l.y,l.z),f.push(0,0),g.push(v++)}h.push(g)}for(var I=h.length-1,P=0;P<I;P++){var H=h[P],A=h[P+1],C=H.length-1;m.push(H[0],A[1],A[0]);for(var D=1;D<=C;D++)m.push(H[D-1],H[D],A[D]),m.push(H[D],A[D+1],A[D])}}return h.setIndex(m),h.setAttribute("position",new THREE.Float32BufferAttribute(u,3)),h.setAttribute("normal",new THREE.Float32BufferAttribute(p,3)),h.setAttribute("uv",new THREE.Float32BufferAttribute(f,2)),h}return _inheritsLoose(t,e),t}(THREE.BufferGeometry);function genHelix(e,t,i,r,a,n,o,s,h,l,d,c){o=Math.round(o),l=Math.round(l),c=Math.round(c);var m,u,p,f,v,E,g,y,_=[],S=[],x=[],b=[],w=[],T=[],R=[],M=new THREE.Vector3,L=new THREE.Vector3,I=new THREE.Vector3,P=new THREE.Vector3,H=(new THREE.Vector3,new THREE.Vector3),A=new THREE.Vector3,C=new THREE.Vector3,D=new THREE.Vector3,O=new THREE.Vector3,B=new THREE.Vector3,U=new THREE.Vector3,G=Math.min(t,r)/2,z=G-s,N=G-s,V=i-2*s+.001,F=V/n,j=Math.ceil(o*n),Y=V/j,k=-V/2,W=2*Math.PI/l,X=Math.PI/2/c,q=Math.min((1-d/100)*s,s-.1),J=s-q;function K(t,i){var r=Math.PI/2;E=i*Y,y=2*Math.PI*(E%F)/F+r,E+=k,g=Math.sin(y)*N,v=Math.cos(y)*z,e?t.set(v,g,E):t.set(v,E,g)}K(I,-1),K(P,0),H.copy(I);for(var Z=I.distanceTo(P),Q=Z*j+2*J,$=Q-J,ee=0;ee<=j;ee++){K(M,ee),U.subVectors(M,H).normalize(),H.copy(M),O.copy(M).setComponent(e+1,0).normalize(),B.crossVectors(U,O).normalize();for(var te=0==ee?3*Math.PI/2:X,ie=0==ee?0:$,re=0,ae=0;re<=l;ae=++re*W){if(A.addVectors(I.copy(O).multiplyScalar(s*Math.cos(ae)),P.copy(B).multiplyScalar(s*Math.sin(ae))),D.copy(A).normalize(),0==ee||ee==j){P.copy(D).multiplyScalar(q),L.addVectors(M,P);for(var ne=0,oe=te;ne<c;oe=++ne*X+te){C.addVectors(I.copy(U).multiplyScalar(J*Math.sin(oe)),P.copy(D).multiplyScalar(J*Math.cos(oe))),P.addVectors(L,C),C.normalize(),w.push(P.x,P.y,P.z),T.push(C.x,C.y,C.z);var se=(0==ee)+Math.sin(oe);R.push((ie+J*se)/Q,re/l,0)}}P.addVectors(M,A),S.push(P.x,P.y,P.z),x.push(D.x,D.y,D.z),b.push((J+ee*Z)/Q,re/l)}}for(var he=w.length/2,le=0;le<c;le++)for(var de=0;de<=l;de++){var ce=he+3*(de*c+le),me=3*((l-de)*c+c-le-1);S.push.apply(S,w.slice(ce,ce+3)),S.unshift.apply(S,w.slice(me,me+3)),x.push.apply(x,T.slice(ce,ce+3)),x.unshift.apply(x,T.slice(me,me+3)),b.push.apply(b,R.slice(ce,ce+2)),b.unshift.apply(b,R.slice(me,me+2))}for(var ue=l+1,pe=0;pe<j+2*c;pe++)for(var fe=0;fe<ue-1;fe++)p=(m=pe*ue+fe)+ue,f=(u=m+1)+ue,_.push(m,u,p,u,f,p);m=S.length/3-l-1;for(var ve=0;ve<l-2;ve++)_.push(m,m+ve+1,m+ve+2),_.push(0,ve+2,ve+1);var Ee=new THREE.BufferGeometry;return Ee.setIndex(_),Ee.setAttribute("position",new THREE.Float32BufferAttribute(S,3)),Ee.setAttribute("normal",new THREE.Float32BufferAttribute(x,3)),Ee.setAttribute("uv",new THREE.Float32BufferAttribute(b,2)),Ee}SPE.RectangleGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=e.cornerRadius,o=void 0===n?[0,0,0,0]:n,s=e.cornerType,h=void 0===s?1:s,l=e.enabledIndieCorners,d=void 0!==l&&l,c=e.extrudeDepth,m=void 0===c?0:c,u=e.extrudeBevelSize,p=void 0===u?0:u,f=e.extrudeBevelSegments,v=void 0===f?1:f;i=Math.abs(i),a=Math.abs(a);var E={x:.5*i,y:.5*a},g={x:-E.x,y:-E.y},y={x:E.x,y:E.y};function _(e,t,r){return t>i&&r>a?Math.min(e*i/t,e*a/r):t>i?e*i/t:r>a?e*a/r:e}var S=[];S[0]=0===o[0]?0:_(o[0],o[0]+o[3],o[0]+o[1]),S[1]=0===o[1]?0:_(o[1],o[1]+o[2],o[1]+o[0]),S[2]=0===o[2]?0:_(o[2],o[2]+o[1],o[2]+o[3]),S[3]=0===o[3]?0:_(o[3],o[3]+o[0],o[3]+o[2]);var x,b=g.x,w=y.x,T=y.y,R=g.y,M=new THREE.Shape;if(M.moveTo(b,T-S[0]),1==h)o[0]>0&&M.quadraticCurveTo(b,T,b+S[0],T),M.lineTo(w-S[1],T),o[1]>0&&M.quadraticCurveTo(w,T,w,T-S[1]),M.lineTo(w,R+S[2]),o[2]>0&&M.quadraticCurveTo(w,R,w-S[2],R),M.lineTo(b+S[3],R),o[3]>0&&M.quadraticCurveTo(b,R,b,R+S[3]),M.lineTo(b,T-S[0]);else{var L=4*(Math.SQRT2-1)/3;o[0]>0&&M.bezierCurveTo(b,T+S[0]*(L-1),b-S[0]*(L-1),T,b+S[0],T),M.lineTo(w-S[1],T),o[1]>0&&M.bezierCurveTo(w+S[1]*(L-1),T,w,T+S[1]*(L-1),w,T-S[1]),M.lineTo(w,R+S[2]),o[2]>0&&M.bezierCurveTo(w,R-S[2]*(L-1),w+S[2]*(L-1),R,w-S[2],R),M.lineTo(b+S[3],R),o[3]>0&&M.bezierCurveTo(b-S[3]*(L-1),R,b,R-S[3]*(L-1),b,R+S[3])}return M.lineTo(b,T-S[0]),(x=m>0?new THREE.ExtrudeBufferGeometry(M,{curveSegments:64,steps:1,depth:m,bevelEnabled:!0,bevelThickness:p,bevelSize:p,bevelOffset:0,bevelSegments:v}):new THREE.ShapeBufferGeometry(M,32)).userData={type:"RectangleGeometry",ui:{enabledIndieCorners:d},parameters:{width:i,height:a,depth:0,cornerRadius:o,cornerType:h,extrudeDepth:m,extrudeBevelSize:p,extrudeBevelSegments:v}},SPE.Math.fixUvs(x,i,a),x},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.cornerRadius,s=void 0===o?e.userData.parameters.cornerRadius:o,h=t.cornerType,l=void 0===h?e.userData.parameters.cornerType:h,d=t.enabledIndieCorners,c=void 0===d?e.userData.ui.enabledIndieCorners:d,m=t.extrudeDepth,u=void 0===m?e.userData.parameters.extrudeDepth:m,p=t.extrudeBevelSize,f=void 0===p?e.userData.parameters.extrudeBevelSize:p,v=t.extrudeBevelSegments,E=void 0===v?e.userData.parameters.extrudeBevelSegments:v;return this.build({width:r,height:n,cornerRadius:s,cornerType:l,enabledIndieCorners:c,extrudeDepth:u,extrudeBevelSize:f,extrudeBevelSegments:E})}},SPE.SphereGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=e.depth,o=void 0===n?i:n,s=e.widthSegments,h=void 0===s?64:s,l=e.heightSegments,d=void 0===l?64:l,c=e.phiStart,m=e.phiLength,u=e.thetaStart,p=e.thetaLength;i=Math.abs(i),a=Math.abs(a),o=Math.abs(o);var f=new THREE.SphereBufferGeometry(.5*i,h,d,c,m,u,p);return f.scale(1,a/i,o/i),f.userData={type:"SphereGeometry",parameters:{width:i,height:a,depth:o,widthSegments:h,heightSegments:d,phiStart:c,phiLength:m,thetaStart:u,thetaLength:p}},f},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.widthSegments,l=void 0===h?e.userData.parameters.widthSegments:h,d=t.heightSegments,c=void 0===d?e.userData.parameters.heightSegments:d,m=t.phiStart,u=void 0===m?e.userData.parameters.phiStart:m,p=t.phiLength,f=void 0===p?e.userData.parameters.phiLength:p,v=t.thetaStart,E=void 0===v?e.userData.parameters.thetaStart:v,g=t.thetaLength,y=void 0===g?e.userData.parameters.thetaLength:g;return this.build({width:r,height:n,depth:s,widthSegments:l,heightSegments:c,phiStart:u,phiLength:f,thetaStart:E,thetaLength:y})}},SPE.StarGeometry=new function(){this.build=function(e){var t,i=e.width,r=void 0===i?100:i,a=e.height,n=void 0===a?r:a,o=e.innerRadiusPercent,s=void 0===o?38.19:o,h=e.spikes,l=void 0===h?5:h,d=e.cornerRadius,c=void 0===d?0:d,m=e.angle,u=void 0===m?360:m,p=e.extrudeDepth,f=void 0===p?0:p,v=e.extrudeBevelSize,E=void 0===v?0:v,g=e.extrudeBevelSegments,y=void 0===g?1:g,_=.5*(r=Math.abs(r)),S=.5*(n=Math.abs(n)),x=u*Math.PI/360/l,b=Math.PI/2*3*-1,w=_*s/100,T=S*s/100,R=new THREE.Shape;if(3==l&&50==s){x=2*Math.PI/l;for(var M=0;M<=l;M++){var L=x*M,I=0+Math.sin(L)*_,P=0+Math.cos(L)*S;R.lineTo(I,P)}}else{R.moveTo(0,0+u==360?S:0);for(var H=0;H<l;H++){var A=0+Math.cos(b)*_,C=0+Math.sin(b)*S;R.lineTo(A,C),b+=x,A=0+Math.cos(b)*w,C=0+Math.sin(b)*T,R.lineTo(A,C),b+=x}R.lineTo(0,0+u==360?S:0)}return 0!==c&&SPE.Geometry.Utils.roundShapePolygon(R,R.getPoints(),c),(t=f>0?new THREE.ExtrudeBufferGeometry(R,{steps:1,depth:f,bevelEnabled:!0,bevelThickness:E,bevelSize:E,bevelOffset:0,bevelSegments:y}):new THREE.ShapeBufferGeometry(R)).userData={type:"StarGeometry",parameters:{width:r,height:n,depth:0,innerRadiusPercent:s,spikes:l,cornerRadius:c,angle:u,extrudeDepth:f,extrudeBevelSize:E,extrudeBevelSegments:y}},SPE.Math.fixUvs(t,r,n),t},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.innerRadiusPercent,s=void 0===o?e.userData.parameters.innerRadiusPercent:o,h=t.spikes,l=void 0===h?e.userData.parameters.spikes:h,d=t.cornerRadius,c=void 0===d?e.userData.parameters.cornerRadius:d,m=t.angle,u=void 0===m?e.userData.parameters.angle:m,p=t.extrudeDepth,f=void 0===p?e.userData.parameters.extrudeDepth:p,v=t.extrudeBevelSize,E=void 0===v?e.userData.parameters.extrudeBevelSize:v,g=t.extrudeBevelSegments,y=void 0===g?e.userData.parameters.extrudeBevelSegments:g;return this.build({width:r,height:n,innerRadiusPercent:s,spikes:l,cornerRadius:c,angle:u,extrudeDepth:f,extrudeBevelSize:E,extrudeBevelSegments:y})}},SPE.TorusGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=e.depth,o=e.tubePercent,s=void 0===o?50:o,h=e.radialSegments,l=void 0===h?128:h,d=e.tubularSegments,c=void 0===d?64:d,m=e.arc,u=void 0===m?2*Math.PI:m,p=e.cornerRadius,f=void 0===p?30:p,v=e.cornerSegments,E=void 0===v?8:v,g=function(e,t,i,r,a,n,o,s,h,l,d){var c;return i=(c=[i,t])[1],o=(t=c[0])/2,1==(a/=2*Math.PI)&&(l=0),genHelix(!0,e,t,i,0,a,n,o,0,h,l,d)}(i,a,n=n||2*(.25*i*s*.01),0,u,l,0,0,c,f,E);return g.scale(1,a/i,1),g.userData={type:"TorusGeometry",parameters:{width:i,height:a,depth:n,tubePercent:s,radialSegments:l,tubularSegments:c,arc:u,cornerRadius:f,cornerSegments:E}},g},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.tubePercent,l=void 0===h?e.userData.parameters.tubePercent:h,d=t.radialSegments,c=void 0===d?e.userData.parameters.radialSegments:d,m=t.tubularSegments,u=void 0===m?e.userData.parameters.tubularSegments:m,p=t.arc,f=void 0===p?e.userData.parameters.arc:p,v=t.cornerRadius,E=void 0===v?e.userData.parameters.cornerRadius:v,g=t.cornerSegments,y=void 0===g?e.userData.parameters.cornerSegments:g;return this.build({width:r,height:n,depth:s,tubePercent:l,radialSegments:c,tubularSegments:u,arc:f,cornerRadius:E,cornerSegments:y})}},SPE.TorusKnotGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=e.depth,o=void 0===n?1:n,s=e.tube,h=void 0===s?50:s,l=e.tubularSegments,d=void 0===l?64:l,c=e.radialSegments,m=void 0===c?32:c,u=e.p,p=void 0===u?2:u,f=e.q,v=void 0===f?3:f,E=.5*i-h,g=new THREE.TorusKnotBufferGeometry(E,h,d,m,p,v);return g.userData={type:"TorusKnotGeometry",parameters:{width:i,height:a,depth:o,tube:h,tubularSegments:d,radialSegments:m,p:p,q:v}},g},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.tube,l=void 0===h?e.userData.parameters.tube:h,d=t.tubularSegments,c=void 0===d?e.userData.parameters.tubularSegments:d,m=t.radialSegments,u=void 0===m?e.userData.parameters.radialSegments:m,p=t.p,f=void 0===p?e.userData.parameters.p:p,v=t.q,E=void 0===v?e.userData.parameters.q:v;return this.build({width:r,height:n,depth:s,tube:l,tubularSegments:c,radialSegments:u,p:f,q:E})}},SPE.LatheGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=e.depth,o=void 0===n?i:n,s=e.segments,h=void 0===s?64:s,l=e.verticalSegments,d=void 0===l?64:l,c=e.points,m=void 0===c?[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]:c,u=new THREE.Shape;u.moveTo(m[0].x,m[0].y),u.bezierCurveTo(m[1].x,m[1].y,m[2].x,m[2].y,m[3].x,m[3].y);var p=new THREE.LatheBufferGeometry(u.extractPoints(d).shape,h);return p.rotateZ(Math.PI),p.userData={type:"LatheGeometry",parameters:{width:i,height:a,depth:o,segments:h,verticalSegments:d,points:m}},p},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.segments,l=void 0===h?e.userData.parameters.segments:h,d=t.verticalSegments,c=void 0===d?e.userData.parameters.verticalSegments:d,m=t.points,u=void 0===m?e.userData.parameters.points:m;return this.build({width:r,height:n,depth:s,segments:l,verticalSegments:c,points:u})}},SPE.HelixGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=e.depth,o=void 0===n?i:n,s=e.radius,h=void 0===s?20:s,l=e.revolutions,d=void 0===l?2:l,c=e.segments,m=void 0===c?40:c,u=e.pathRadius,p=void 0===u?10:u,f=e.pathType,v=void 0===f?0:f,E=e.pathSegments,g=void 0===E?30:E,y=e.cornerRadius,_=void 0===y?30:y,S=e.cornerSegments,x=void 0===S?8:S,b=genHelix(!1,Math.abs(i),Math.abs(a),Math.abs(o),Math.abs(h),Math.abs(d),Math.abs(m),Math.abs(p),Math.abs(v),Math.abs(g),Math.abs(_),Math.abs(x));return b.userData={type:"HelixGeometry",parameters:{height:a,width:i,depth:o,radius:h,revolutions:d,segments:m,pathRadius:p,pathType:v,pathSegments:g,cornerRadius:_,cornerSegments:x}},b},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o,h=t.radius,l=void 0===h?e.userData.parameters.radius:h,d=t.revolutions,c=void 0===d?e.userData.parameters.revolutions:d,m=t.segments,u=void 0===m?e.userData.parameters.segments:m,p=t.pathRadius,f=void 0===p?e.userData.parameters.pathRadius:p,v=t.pathType,E=void 0===v?e.userData.parameters.pathType:v,g=t.pathSegments,y=void 0===g?e.userData.parameters.pathSegments:g,_=t.cornerRadius,S=void 0===_?e.userData.parameters.cornerRadius:_,x=t.cornerSegments,b=void 0===x?e.userData.parameters.cornerSegments:x;return this.build({width:r,height:n,depth:s,radius:l,revolutions:c,segments:u,pathRadius:f,pathType:E,pathSegments:y,cornerRadius:S,cornerSegments:b})}},SPE.TriangleGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=e.cornerRadius,n=void 0===a?0:a,o=e.extrudeDepth,s=void 0===o?0:o,h=e.extrudeBevelSize,l=void 0===h?0:h,d=e.extrudeBevelSegments,c=void 0===d?1:d,m=e.isRect,u=void 0!==m&&m;i=Math.abs(i);var p,f=new THREE.Shape;if(u)r=r?Math.abs(r):i,f.moveTo(.5*-i,.5*r),f.lineTo(.5*i,.5*-r),f.lineTo(.5*-i,.5*-r),f.lineTo(.5*-i,.5*r);else{var v={x:.5*i,y:.5*(r=(r=Math.abs(r))||i*(Math.sqrt(3)/2))};f.moveTo(0,v.y),f.lineTo(v.x,-v.y),f.lineTo(-v.x,-v.y),f.lineTo(0,v.y)}return 0!==n&&function(e,t,i){var r,a,n,o,s,h,l,d,c,m,u,p,f,v,E,g,y,_=function(e,t,i){i.x=t.x-e.x,i.y=t.y-e.y,i.len=Math.sqrt(i.x*i.x+i.y*i.y),i.nx=i.x/i.len,i.ny=i.y/i.len,i.ang=Math.atan2(i.ny,i.nx)};for(d={},c={},s=t[(o=t.length-1)-1],e.curves=[],r=0;r<o;r++)h=t[r%o],l=t[(r+1)%o],_(h,s,d),_(h,l,c),m=d.nx*c.ny-d.ny*c.nx,u=d.nx*c.nx-d.ny*-c.ny,v=Math.asin(m),p=1,f=!1,u<0?v<0?v=Math.PI+v:(v=Math.PI-v,p=-1,f=!0):v>0&&(p=-1,f=!0),E=.5*v,(y=Math.abs(Math.cos(E)*i/Math.sin(E)))>Math.min(.5*d.len,.5*c.len)?(y=Math.min(.5*d.len,.5*c.len),g=Math.abs(y*Math.sin(E)/Math.cos(E))):g=i,a=h.x+c.nx*y,n=h.y+c.ny*y,a+=-c.ny*g*p,n+=c.nx*g*p,e.absarc(a,n,g,d.ang+Math.PI/2*p,c.ang-Math.PI/2*p,f),s=h,h=l;e.closePath()}(f,f.getPoints(),n),(p=s>0?new THREE.ExtrudeBufferGeometry(f,{curveSegments:64,steps:1,depth:s,bevelEnabled:!0,bevelThickness:l,bevelSize:l,bevelOffset:0,bevelSegments:c}):new THREE.ShapeBufferGeometry(f,32)).userData={type:"TriangleGeometry",parameters:{width:i,height:r,depth:0,cornerRadius:n,extrudeDepth:s,extrudeBevelSize:l,extrudeBevelSegments:c,isRect:u}},SPE.Math.fixUvs(p,i,r),p},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.cornerRadius,s=void 0===o?e.userData.parameters.cornerRadius:o,h=t.extrudeDepth,l=void 0===h?e.userData.parameters.extrudeDepth:h,d=t.extrudeBevelSize,c=void 0===d?e.userData.parameters.extrudeBevelSize:d,m=t.extrudeBevelSegments,u=void 0===m?e.userData.parameters.extrudeBevelSegments:m,p=t.isRect,f=void 0===p?e.userData.parameters.isRect:p;return this.build({width:r,height:n,cornerRadius:s,extrudeDepth:l,extrudeBevelSize:c,extrudeBevelSegments:u,isRect:f})}},SPE.NonParametricGeometry=new function(){this.build=function(e,t){void 0===e&&(e=new THREE.BoxBufferGeometry(100,100,100));var i=new THREE.BufferGeometry;i.copy(e);var r=new THREE.Vector3;if(i.computeBoundingBox(),i.boundingBox.getSize(r),t){var a=t.width?t.width:r.x,n=t.height?t.height:r.y,o=t.depth?t.depth:r.z;i.scale(0===r.x?1:a/r.x,0===r.y?1:n/r.y,0===r.z?1:o/r.z)}else a=r.x,n=r.y,o=r.z;return i.userData={type:"NonParametricGeometry",parameters:{width:a,height:n,depth:o}},i},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a,o=t.depth,s=void 0===o?e.userData.parameters.depth:o;return this.build(e,{width:r,height:n,depth:s})}},SPE.StrokeGeometry=new function(){this.build=function(e,t){void 0===t&&(t={});var i=t.strokeAlignment||1,r=t.strokeGrowth||1,a=[];switch(e.userData.type){case"PolygonGeometry":var n=3,o=e.getAttribute("position").array.length-3;break;case"StarGeometry":n=0,o=e.getAttribute("position").array.length-3;break;default:n=0,o=e.getAttribute("position").array.length}for(var s=n;s<o;s+=3)a.push([e.getAttribute("position").array[s],e.getAttribute("position").array[s+1]]);var h=createLineGeo(a,i,r)(THREE);return h.userData={type:"StrokeGeometry",parameters:{strokeAlignment:i}},h.toJSON=function(){var t={};return t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),t.userData=this.userData,t.userData.meshGeometry=e.uuid,t},h},this.buildFromGeometry=function(e,t,i){var r=i.strokeAlignment,a=void 0===r?t.userData.parameters.strokeAlignment:r,n=i.strokeGrowth,o=void 0===n?t.userData.parameters.strokeGrowth:n;return SPE.StrokeGeometry.build(e,{strokeAlignment:a,strokeGrowth:o})}},SPE.TextFrameGeometry=new function(){this.build=function(e){var t=e.width,i=void 0===t?100:t,r=e.height,a=void 0===r?i:r,n=new THREE.PlaneBufferGeometry(i,a);return n.userData={type:"TextFrameGeometry",parameters:{width:i,height:a,depth:0}},n},this.buildFromGeometry=function(e,t){var i=t.width,r=void 0===i?e.userData.parameters.width:i,a=t.height,n=void 0===a?e.userData.parameters.height:a;return this.build({width:r,height:n})}},SPE.Geometry={},SPE.Geometry.Utils=new function(){this.roundShapePolygon=function(e,t,i){var r,a,n,o,s,h,l,d,c,m,u,p,f,v,E,g,y,_=function(e,t,i){i.x=t.x-e.x,i.y=t.y-e.y,i.len=Math.sqrt(i.x*i.x+i.y*i.y),i.nx=i.x/i.len,i.ny=i.y/i.len,i.ang=Math.atan2(i.ny,i.nx)};for(d={},c={},s=t[(o=t.length)-2],e.curves=[],r=1;r<o-1;r++)h=t[r%o],l=t[(r+1)%o],_(h,s,d),_(h,l,c),m=d.nx*c.ny-d.ny*c.nx,u=d.nx*c.nx-d.ny*-c.ny,v=Math.asin(m),p=1,f=!1,u<0?v<0?v=Math.PI+v:(v=Math.PI-v,p=-1,f=!0):v>0&&(p=-1,f=!0),E=v/2,(y=Math.abs(Math.cos(E)*i/Math.sin(E)))>Math.min(d.len/2,c.len/2)?(y=Math.min(d.len/2,c.len/2),g=Math.abs(y*Math.sin(E)/Math.cos(E))):g=i,a=h.x+c.nx*y,n=h.y+c.ny*y,a+=-c.ny*g*p,n+=c.nx*g*p,e.absarc(a,n,g,d.ang+Math.PI/2*p,c.ang-Math.PI/2*p,f),s=h,h=l;e.closePath()},this.resizeGeometry=function(e,t){var i=t.width,r=t.height,a=t.depth;i=Math.abs(i),r=Math.abs(r),a=Math.abs(a);var n,o,s,h=e.userData.parameters;0===i?(i=h.width,n=1):n=i/h.width,0===r?(r=h.height,o=1):o=r/h.height,0===a?(a=h.depth,s=1):s=a/h.depth,e.scale(n,o,s),h.width=i,h.height=r,h.depth=a},this.addBarycentricAttribute=function(e,t){for(var i=[new THREE.Vector3(1,0,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1)],r=e.attributes.position,a=new Float32Array(3*r.count),n=0,o=r.count;n<o;n++)i[n%3].toArray(a,3*n);e.setAttribute(t,new THREE.Float32BufferAttribute(a,3))},this.removeBarycentricAttribute=function(e,t){e.deleteAttribute(t)},this.loadFromUrl=function(e){return new Promise((function(t,i){(new THREE.BufferGeometryLoader).load(e,(function(e){t(e)}))}))}};var Cloner=function(e){function t(t,i){var r;void 0===i&&(i={}),(r=e.call(this)||this).object=t,r.userData.type="Cloner",r.userData.skip=!0,t.computeComplexBoundingBox(!0);var a=t.complexBoundingBox.getSize(new THREE.Vector3);return r.parameters={type:void 0!==i.type?i.type:"radial",hideBase:void 0!==i.hideBase&&i.hideBase,count:void 0!==i.count?i.count:3,ra_radius:void 0!==i.ra_radius?i.ra_radius:2*Math.max(a.x,a.y),ra_startAngle:void 0!==i.ra_startAngle?i.ra_startAngle:0,ra_endAngle:void 0!==i.ra_endAngle?i.ra_endAngle:360,ra_align:void 0!==i.ra_align&&i.ra_align,ra_axis:void 0!==i.ra_axis?i.ra_axis:"y",ra_scale:void 0!==i.ra_scale?i.ra_scale.clone():new THREE.Vector3,ra_rotation:void 0!==i.ra_rotation?i.ra_rotation.clone():new THREE.Euler,ra_position:void 0!==i.ra_position?i.ra_position.clone():new THREE.Vector3,li_scale:void 0!==i.li_scale?i.li_scale.clone():new THREE.Vector3,li_rotation:void 0!==i.li_rotation?i.li_rotation.clone():new THREE.Euler,li_position:void 0!==i.li_position?i.li_position.clone():new THREE.Vector3(a.x+.1*a.x,0,0).round(),gr_count:void 0!==i.gr_count?i.gr_count.clone():new THREE.Vector3(2,2,2),gr_size:void 0!==i.gr_size?i.gr_size.clone():new THREE.Vector3(a.x+.1*a.x,a.y+.1*a.y,a.z+.1*a.z).round(),gr_fromCenter:void 0===i.gr_fromCenter||i.gr_fromCenter},r.update(),r.setHideBase(r.parameters.hideBase),r}_inheritsLoose(t,e);var i=t.prototype;return i.refreshMaterial=function(){for(var e=0,t=this.children.length;e<t;++e)this.children[e].material=this.object.material},i.setHideBase=function(e){if(void 0!==this.object.material){if(this.children.length>0)if(this.object.material.visible=!0,!0===e)for(var t=this.object.material.clone(),i=0,r=this.children.length;i<r;++i)this.children[i].material=t;else for(var a=0,n=this.children.length;a<n;++a)this.children[a].material=this.object.material;this.object.material.visible=!e,this.parameters.hideBase=e}},i.update=function(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial();break;case"linear":this._updateLinear();break;case"grid":this._updateGrid()}},i._updateCount=function(){var e=this.parameters,t="grid"===e.type?e.gr_count.x*e.gr_count.y*e.gr_count.z:e.count;if(this.children.length!==t)if(this.children.length<t)for(var i=0,r=t-this.children.length;i<r;++i){var a=this.object.shallowClone(!1);delete a.userData.isEntity,this.add(a)}else for(var n=0,o=this.children.length-t;n<o;++n)this.remove(this.children[0])},i._updateRadial=function(){var e,t=this.parameters,i=t.ra_startAngle*THREE.Math.DEG2RAD,r=i-t.ra_endAngle*THREE.Math.DEG2RAD,a=new THREE.Euler(t.ra_rotation.x*THREE.Math.DEG2RAD,t.ra_rotation.y*THREE.Math.DEG2RAD,t.ra_rotation.z*THREE.Math.DEG2RAD);"x"==t.ra_axis&&(e=new THREE.Vector3(1,0,0)),"y"==t.ra_axis&&(e=new THREE.Vector3(0,1,0)),"z"==t.ra_axis&&(e=new THREE.Vector3(0,0,1));for(var n=0;n<t.count;n++){var o=this.children[n];o.hiddenMatrix.identity(),o.scale.x=t.ra_scale.x+1,o.scale.y=t.ra_scale.y+1,o.scale.z=t.ra_scale.z+1,o.position.setScalar(0);var s=r/t.count*n-i;"x"==t.ra_axis&&o.rotation.set(0,s,0),"y"==t.ra_axis&&o.rotation.set(0,0,s),"z"==t.ra_axis&&o.rotation.set(s,0,0),o.translateOnAxis(e,t.ra_radius),o.position.add(t.ra_position),!0===t.ra_align?(o.rotation.x+=a.x,o.rotation.y+=a.y,o.rotation.z+=a.z):o.rotation.copy(a)}},i._updateLinear=function(){for(var e=this.parameters,t=new THREE.Euler(e.li_rotation.x*THREE.Math.DEG2RAD,e.li_rotation.y*THREE.Math.DEG2RAD,e.li_rotation.z*THREE.Math.DEG2RAD),i=0;i<e.count;i++){var r=this.children[i];r.hiddenMatrix.identity(),r.scale.x=e.li_scale.x*i+1,r.scale.y=e.li_scale.y*i+1,r.scale.z=e.li_scale.z*i+1,r.rotation.x=t.x*i,r.rotation.y=t.y*i,r.rotation.z=t.z*i,r.position.x=e.li_position.x*i,r.position.y=e.li_position.y*i,r.position.z=e.li_position.z*i}},i._updateGrid=function(){var e=this.parameters,t=0;if(!0===e.gr_fromCenter)for(var i={x:e.gr_count.x%2==0?2:1,y:e.gr_count.y%2==0?2:1,z:e.gr_count.z%2==0?2:1},r=new THREE.Vector3(e.gr_size.x*(e.gr_count.x-i.x)*.5,e.gr_size.y*(e.gr_count.y-i.y)*.5,e.gr_size.z*(e.gr_count.z-i.z)*.5),a=0;a<e.gr_count.x;a++)for(var n=0;n<e.gr_count.y;n++)for(var o=0;o<e.gr_count.z;o++){var s=this.children[t++];s.hiddenMatrix.identity(),s.scale.setScalar(1),s.rotation.set(0,0,0),s.position.x=e.gr_size.x*a-r.x,s.position.y=e.gr_size.y*n-r.y,s.position.z=e.gr_size.z*o-r.z}else for(var h=0;h<e.gr_count.x;h++)for(var l=0;l<e.gr_count.y;l++)for(var d=0;d<e.gr_count.z;d++){var c=this.children[t++];c.hiddenMatrix.identity(),c.scale.setScalar(1),c.rotation.set(0,0,0),c.position.x=e.gr_size.x*h,c.position.y=-e.gr_size.y*l,c.position.z=-e.gr_size.z*d}},i.toJSON=function(){var e=this.parameters,t={};return t.parameters={type:e.type,hideBase:e.hideBase,count:e.count,ra_radius:e.ra_radius,ra_startAngle:e.ra_startAngle,ra_endAngle:e.ra_endAngle,ra_align:e.ra_align,ra_axis:e.ra_axis,ra_scale:e.ra_scale.toArray(),ra_rotation:e.ra_rotation.toArray(),ra_position:e.ra_position.toArray(),li_scale:e.li_scale.toArray(),li_rotation:e.li_rotation.toArray(),li_position:e.li_position.toArray(),gr_count:e.gr_count.toArray(),gr_size:e.gr_size.toArray(),gr_fromCenter:e.gr_fromCenter},t},i.fromJSON=function(e){var t=e.parameters;return this.parameters={type:t.type,hideBase:t.hideBase,count:t.count,ra_radius:t.ra_radius,ra_startAngle:t.ra_startAngle,ra_endAngle:t.ra_endAngle,ra_align:t.ra_align,ra_axis:t.ra_axis,ra_scale:(new THREE.Vector3).fromArray(t.ra_scale),ra_rotation:(new THREE.Vector3).fromArray(t.ra_rotation),ra_position:(new THREE.Vector3).fromArray(t.ra_position),li_scale:(new THREE.Vector3).fromArray(t.li_scale),li_rotation:(new THREE.Vector3).fromArray(t.li_rotation),li_position:(new THREE.Vector3).fromArray(t.li_position),gr_count:(new THREE.Vector3).fromArray(t.gr_count),gr_size:(new THREE.Vector3).fromArray(t.gr_size),gr_fromCenter:t.gr_fromCenter},this.update(),this.setHideBase(this.parameters.hideBase),this},t}(THREE.Object3D);SPE.CombinedCamera=function(e){function t(t,i,r,a,n){var o;return void 0===t&&(t=100),void 0===i&&(i=100),void 0===r&&(r=45),void 0===a&&(a=.1),void 0===n&&(n=5e4),o=e.call(this)||this,t=window.innerWidth,i=window.innerHeight,o.orthoCamera=new THREE.OrthographicCamera(-.5*t,.5*t,.5*i,-.5*i,a,n),o.perspCamera=new THREE.PerspectiveCamera(r,t/i,a,n),o.left=o.orthoCamera.left,o.right=o.orthoCamera.right,o.top=o.orthoCamera.top,o.bottom=o.orthoCamera.bottom,o.view=o.orthoCamera.view,o.far=o.orthoCamera.far,o.isOrthographicCamera=!0,o._type="OrthographicCamera",o.aspect=o.perspCamera.aspect,o.fov=o.perspCamera.fov,o.focus=o.perspCamera.focus,o.filmGauge=o.perspCamera.filmGauge,o.filmOffset=o.perspCamera.filmOffset,o.targetOffset=1e3,o.userData={type:SPE.CombinedCamera.name,isEntity:!0,lock:!1,scaleLock:!1,activeCamera:!1,hiddenMatrix:new THREE.Matrix4},o.enableHelper=!1,o.objectHelper=new SPE.CombinedCameraHelper(_assertThisInitialized(o)),o.interaction=new Interaction(_assertThisInitialized(o)),o.toOrthographic(),o}_inheritsLoose(t,e);var i=t.prototype;return i.getTarget=function(e,t){var i;return void 0===e&&(console.warn("SPE.CombinedCamera: .getTarget() target is now required"),e=new THREE.Vector3),i=void 0===t?this.getWorldDirection(new THREE.Vector3).multiplyScalar(this.targetOffset):t.clone().multiplyScalar(this.targetOffset),e.copy(this.position).add(i),e},i.getViewFrontToObject=function(e){var t=e.getWorldPosition(new THREE.Vector3),i=e.getWorldDirection(new THREE.Vector3).multiplyScalar(this.targetOffset);return{position:t.clone().add(i),target:t}},i.getViewToObject=function(e){var t=e.getWorldPosition(new THREE.Vector3),i=this.getWorldDirection(new THREE.Vector3).multiplyScalar(this.targetOffset);return{position:t.clone().sub(i),target:t}},i.setViewplaneSize=function(e,t){this.left=.5*-e,this.right=.5*e,this.top=.5*t,this.bottom=.5*-t,this.aspect=e/t,this.updateProjectionMatrix()},i.toOrthographic=function(e){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,delete this.isPerspectiveCamera,this.isOrthographicCamera=!0,this._type="OrthographicCamera",!0!==this.enableHelper&&!0!==e||this.objectHelper.update()},i.toPerspective=function(e){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,delete this.isOrthographicCamera,this.isPerspectiveCamera=!0,this._type="PerspectiveCamera",!0!==this.enableHelper&&!0!==e||this.objectHelper.update()},i.setFocalLength=function(e){this.perspCamera.setFocalLength(e),this.toPerspective()},i.getFocalLength=function(){return this.perspCamera.getFocalLength()},i.getEffectiveFOV=function(){return this.perspCamera.getEffectiveFOV()},i.getFilmWidth=function(){return this.perspCamera.getFilmWidth()},i.getFilmHeight=function(){return this.perspCamera.getFilmHeight()},i.setViewOffset=function(e,t,i,r,a,n){this.isPerspectiveCamera?(this.perspCamera.setViewOffset(e,t,i,r,a,n),this.toPerspective()):this.isOrthographicCamera&&(this.orthoCamera.setViewOffset(e,t,i,r,a,n),this.toOrthographic())},i.clearViewOffset=function(){this.isPerspectiveCamera?(this.perspCamera.clearViewOffset(),this.toPerspective()):this.isOrthographicCamera&&(this.orthoCamera.clearViewOffset(),this.toOrthographic())},i.updateProjectionMatrix=function(e){this.isPerspectiveCamera?this.toPerspective(e):this.isOrthographicCamera&&this.toOrthographic(e)},i.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.userData.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.userData.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e);this.matrixWorldInverse.getInverse(this.matrixWorld)},i.updateWorldMatrix=function(e,t){var i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.userData.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.userData.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),!0===t)for(var r=this.children,a=0,n=r.length;a<n;a++)r[a].updateWorldMatrix(!1,!0);this.matrixWorldInverse.getInverse(this.matrixWorld)},i.attach=function(e){var t=new THREE.Matrix4;return this.updateWorldMatrix(!0,!1),t.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),t.multiply(e.parent.matrixWorld)),void 0!==e.userData.hiddenMatrix?e.userData.hiddenMatrix.premultiply(t):e.applyMatrix4(t),e.updateWorldMatrix(!1,!1),this.add(e),this},i.computeSingleBoundingBox=function(){this.singleBoundingBox||(this.singleBoundingBox=new SPE.Box3),this.singleBoundingBox.setFromObjectSize(this,!1),this.singleBoundingBox.computeVertices(),this.singleBoundingBox.computeEdges()},i.computeComplexBoundingBox=function(e){this.complexBoundingBox||(this.complexBoundingBox=new SPE.Box3),this.complexBoundingBox.setFromObjectSize(this,e)},i.raycast=function(e,t){!0===this.enableHelper&&!0===this.objectHelper.visible&&!1===this.userData.activeCamera&&this.objectHelper.raycast(e,t)},i.copy=function(t,i){var r=t.children;if(t.children=[],e.prototype.copy.call(this,t),t.children=r,this.userDataFromJson(this.userData),this.userData.activeCamera=!1,this.userData.isEntity=!0,delete this.userData.isDefaultCamera,this.orthoCamera.copy(t.orthoCamera),this.perspCamera.copy(t.perspCamera),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.far=t.far,this.view=null===t.view?null:Object.assign({},t.view),this.isOrthographicCamera=t.isOrthographicCamera,this._type=t._type,this.aspect=t.aspect,this.fov=t.fov,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.isPerspectiveCamera=t.isPerspectiveCamera,this.targetOffset=t.targetOffset,void 0!==t.enableHelper&&(this.enableHelper=t.enableHelper),void 0!==t.objectHelper&&(this.objectHelper.visible=t.objectHelper.visible),void 0!==t.interaction&&this.interaction.copy(t.interaction),!0===i)for(var a=0,n=r.length;a<n;++a){var o=t.children[a];!0===o.userData.isEntity&&this.add(o.clone())}return this.updateProjectionMatrix(),this},i.traverseEntity=function(e){!function t(i){if(i.userData.isEntity){e(i);for(var r=i.children,a=0,n=r.length;a<n;++a)t(r[a])}}(this)},i.userDataFromJson=function(e){this.userData=e,this.userData.positionToCenter=new THREE.Vector3,this.userData.hiddenMatrix=new THREE.Matrix4,void 0!==e.hiddenMatrix&&this.userData.hiddenMatrix.fromArray(e.hiddenMatrix.elements),void 0===e.lock&&(this.userData.lock=!1)},i.fromJSON=function(e){return this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,void 0!==e.view&&(this.view=Object.assign({},e.view)),void 0!==e.zoomOrtho&&(this.orthoCamera.zoom=e.zoomOrtho),void 0!==e.nearOrtho&&(this.orthoCamera.near=e.nearOrtho),this.far=e.far,this._type=e.type,e.isOrthographicCamera&&(this.isOrthographicCamera=e.isOrthographicCamera),this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,void 0!==e.zoomPersp&&(this.perspCamera.zoom=e.zoomPersp),void 0!==e.nearPersp&&(this.perspCamera.near=e.nearPersp),e.isPerspectiveCamera&&(this.isPerspectiveCamera=e.isPerspectiveCamera),void 0!==e.targetOffset&&(this.targetOffset=e.targetOffset),this.userDataFromJson(this.userData),this.updateProjectionMatrix(),this},i.toJSON=function(t){var i,r=this.userData;return delete this.userData,i=e.prototype.toJSON.call(this,t),this.userData=r,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,null!==this.view&&(i.object.view=Object.assign({},this.view)),i.object.zoomOrtho=this.orthoCamera.zoom,i.object.nearOrtho=this.orthoCamera.near,i.object.far=this.far,i.object.type=this._type,this.isOrthographicCamera&&(i.object.isOrthographicCamera=this.isOrthographicCamera),i.object.aspect=this.aspect,i.object.fov=this.fov,i.object.focus=this.focus,i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i.object.zoomPersp=this.perspCamera.zoom,i.object.nearPersp=this.perspCamera.near,this.isPerspectiveCamera&&(i.object.isPerspectiveCamera=this.isPerspectiveCamera),i.object.targetOffset=this.targetOffset,i.object.userData={type:SPE.CombinedCamera.name,isEntity:r.isEntity,lock:r.lock,scaleLock:r.scaleLock,activeCamera:r.activeCamera,hiddenMatrix:{elements:r.hiddenMatrix.toArray()}},i.object.enableHelper=this.enableHelper,i.object.interaction=this.interaction.toJSON(t),i},_createClass(t,[{key:"hiddenMatrix",get:function(){return this.userData.hiddenMatrix},set:function(e){this.userData.hiddenMatrix.copy(e)}},{key:"geometryHelper",get:function(){return SPE.CombinedCameraHelper.geometryHelper}},{key:"visibility",set:function(e){this.visible=e,this.objectHelper.visible=e;for(var t=0,i=this.children.length;t<i;++t)void 0!==this.children[t].traverseEntity&&this.children[t].traverseEntity((function(t){void 0!==t.objectHelper&&!0===t.visible&&(t.objectHelper.visible=e)}))},get:function(){return this.visible}},{key:"type",get:function(){return this._type},set:function(e){"PerspectiveCamera"===e?this.toPerspective():"OrthographicCamera"===e&&this.toOrthographic()}},{key:"near",get:function(){return this.isPerspectiveCamera?this.perspCamera.near:this.isOrthographicCamera?this.orthoCamera.near:void 0},set:function(e){this.isPerspectiveCamera?this.perspCamera.near=e:this.isOrthographicCamera&&(this.orthoCamera.near=e)}},{key:"zoom",get:function(){return this.isPerspectiveCamera?this.perspCamera.zoom:this.isOrthographicCamera?this.orthoCamera.zoom:void 0},set:function(e){e<0||(this.isPerspectiveCamera?this.perspCamera.zoom=e:this.isOrthographicCamera&&(this.orthoCamera.zoom=e))}}]),t}(THREE.Camera),SPE.CombinedCameraHelper=function(e){function t(t){var i;i=e.call(this,t)||this;var r=new THREE.SphereGeometry(15,4,2),a=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),n=new THREE.Mesh(r,a);return i.add(n),i.isObjectHelper=!0,i.name="CombinedCameraHelper: "+t.uuid,i}return _inheritsLoose(t,e),t.prototype.raycast=function(e,t){var i=SPE.CombinedCameraHelper._ray,r=SPE.CombinedCameraHelper._sphere,a=SPE.CombinedCameraHelper._inverseMatrix,n=SPE.CombinedCameraHelper.geometryHelper,o=this.camera.matrixWorld;if(null===n.boundingSphere&&n.computeBoundingSphere(),r.copy(n.boundingSphere),r.applyMatrix4(o),!1!==e.ray.intersectsSphere(r)&&(a.getInverse(o),i.copy(e.ray).applyMatrix4(a),null===n.boundingBox||!1!==i.intersectsBox(n.boundingBox))){var s,h,l,d,c,m,u=n.index,p=n.attributes.position,f=n.drawRange;for(c=Math.max(0,f.start),m=Math.min(u.count,f.start+f.count);c<m;c+=3)h=u.getX(c),l=u.getX(c+1),d=u.getX(c+2),(s=v(this.camera,e,i,p,h,l,d))&&(s.faceIndex=Math.floor(c/3),t.push(s))}function v(e,t,i,r,a,n,o){var s=new THREE.Vector3,h=new THREE.Vector3,l=new THREE.Vector3,d=new THREE.Vector3,c=new THREE.Vector3;if(s.fromBufferAttribute(r,a),h.fromBufferAttribute(r,n),l.fromBufferAttribute(r,o),null===i.intersectTriangle(s,h,l,!1,d))return null;c.copy(d),c.applyMatrix4(e.matrixWorld);var m=t.ray.origin.distanceTo(c);return m<t.near||m>t.far?null:{distance:m,point:c.clone(),object:e}}},t}(THREE.CameraHelper),SPE.CombinedCameraHelper._ray=new THREE.Ray,SPE.CombinedCameraHelper._sphere=new THREE.Sphere,SPE.CombinedCameraHelper._inverseMatrix=new THREE.Matrix4,SPE.CombinedCameraHelper.geometryHelper=new THREE.BoxBufferGeometry(30,30,30),SPE.LightSpot=function(e){function t(t,i,r,a,n,o){var s;(s=e.call(this,t,i,r,a,n,o)||this).shadow.mapSize.width=1024,s.shadow.mapSize.height=1024,s.userData={type:SPE.LightSpot.name,isEntity:!0,lock:!1,scaleLock:!1,hiddenMatrix:new THREE.Matrix4},s.enableHelper=!1,s.objectHelper=new SPE.SpotLightHelper(_assertThisInitialized(s)),s.interaction=new Interaction(_assertThisInitialized(s)),s._gizmos={};var h=s.shadow.camera;h.fov=2*THREE.MathUtils.RAD2DEG*s.angle,h.aspect=1,h.near=100,h.far=2500;var l=new THREE.CameraHelper(s.shadow.camera);return l.visible=!1,s._gizmos.shadowmap=l,s.update(),s}_inheritsLoose(t,e);var i=t.prototype;return i.showGizmos=function(){for(var e=0,t=Object.entries(this._gizmos);e<t.length;e++){var i=t[e][1];i instanceof THREE.CameraHelper&&(i.visible=!0)}},i.hideGizmos=function(){for(var e=0,t=Object.entries(this._gizmos);e<t.length;e++){var i=t[e][1];i instanceof THREE.CameraHelper&&(i.visible=!1)}},i.update=function(){this.shadow.camera.updateProjectionMatrix();for(var e=0,t=Object.entries(this._gizmos);e<t.length;e++){var i=t[e][1];i instanceof THREE.CameraHelper&&i.update()}},i.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.userData.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.userData.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0),!0===this.enableHelper&&!0===this.objectHelper.viisble&&this.objectHelper.update();for(var t=this.children,i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)},i.updateWorldMatrix=function(e,t){var i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.userData.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.userData.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),!0===t)for(var r=this.children,a=0,n=r.length;a<n;a++)r[a].updateWorldMatrix(!1,!0)},i.attach=function(e){var t=new THREE.Matrix4;return this.updateWorldMatrix(!0,!1),t.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),t.multiply(e.parent.matrixWorld)),void 0!==e.userData.hiddenMatrix?e.userData.hiddenMatrix.premultiply(t):e.applyMatrix4(t),e.updateWorldMatrix(!1,!1),this.add(e),this},i.computeSingleBoundingBox=function(){this.singleBoundingBox||(this.singleBoundingBox=new SPE.Box3),this.singleBoundingBox.setFromObjectSize(this,!1),this.singleBoundingBox.computeVertices(),this.singleBoundingBox.computeEdges()},i.computeComplexBoundingBox=function(e){this.complexBoundingBox||(this.complexBoundingBox=new SPE.Box3),this.complexBoundingBox.setFromObjectSize(this,e)},i.raycast=function(e,t){this.objectHelper.raycast(e,t)},i.copy=function(t,i){var r=t.children;if(t.children=[],e.prototype.copy.call(this,t),t.children=r,this.userDataFromJson(this.userData),void 0!==t.enableHelper&&(this.enableHelper=t.enableHelper),void 0!==t.objectHelper&&(this.objectHelper.visible=t.objectHelper.visible),void 0!==t.interaction&&this.interaction.copy(t.interaction),!0===i)for(var a=0,n=r.length;a<n;++a){var o=t.children[a];!0===o.userData.isEntity&&this.add(o.clone())}return this},i.traverseEntity=function(e){!function t(i){if(i.userData.isEntity){e(i);for(var r=i.children,a=0,n=r.length;a<n;++a)t(r[a])}}(this)},i.userDataFromJson=function(e){this.userData=e,void 0!==e.hiddenMatrix&&(this.userData.hiddenMatrix=(new THREE.Matrix4).fromArray(e.hiddenMatrix.elements)),void 0===e.lock&&(this.userData.lock=!1)},i.toJSON=function(t){var i=this.userData;delete this.userData;var r=e.prototype.toJSON.call(this,t);return r.object.userData={type:SPE.LightSpot.name,isEntity:i.isEntity,lock:i.lock,scaleLock:i.scaleLock,hiddenMatrix:{elements:i.hiddenMatrix.toArray()}},r.object.enableHelper=this.enableHelper,r.object.interaction=this.interaction.toJSON(t),this.userData=i,r},_createClass(t,[{key:"hiddenMatrix",get:function(){return this.userData.hiddenMatrix},set:function(e){this.userData.hiddenMatrix.copy(e)}},{key:"geometryHelper",get:function(){return SPE.SpotLightHelper.geometryHelper}},{key:"gizmos",get:function(){return this._gizmos}},{key:"visibility",set:function(e){this.visible=e,this.objectHelper.visible=e;for(var t=0,i=this.children.length;t<i;++t)void 0!==this.children[t].traverseEntity&&this.children[t].traverseEntity((function(t){void 0!==t.objectHelper&&!0===t.visible&&(t.objectHelper.visible=e)}))},get:function(){return this.visible}}]),t}(THREE.SpotLight),SPE.LightPoint=function(e){function t(t,i,r,a){var n;(n=e.call(this,t,i,r,a)||this).shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.userData={type:SPE.LightPoint.name,isEntity:!0,lock:!1,scaleLock:!1,hiddenMatrix:new THREE.Matrix4},n.enableHelper=!1,n.objectHelper=new SPE.PointLightHelper(_assertThisInitialized(n)),n.interaction=new Interaction(_assertThisInitialized(n)),n._gizmos={};var o=n.shadow.camera;o.fov=90,o.aspect=1,o.near=100,o.far=2500;var s=new THREE.Vector3(-o.far+n.position.x,-o.far+n.position.y,-o.far+n.position.z),h=new THREE.Vector3(o.far+n.position.x,o.far+n.position.y,o.far+n.position.z),l=new THREE.Box3(s,h),d=new THREE.Box3Helper(l,new THREE.Color(16755200));return d.visible=!1,n._gizmos.shadowmap=d,n.update(),n}_inheritsLoose(t,e);var i=t.prototype;return i.showGizmos=function(){for(var e=0,t=Object.entries(this._gizmos);e<t.length;e++){var i=t[e][1];i instanceof THREE.Box3Helper&&(i.visible=!0)}},i.hideGizmos=function(){for(var e=0,t=Object.entries(this._gizmos);e<t.length;e++){var i=t[e][1];i instanceof THREE.Box3Helper&&(i.visible=!1)}},i.update=function(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this._gizmos))for(var e=0,t=Object.entries(this._gizmos);e<t.length;e++){var i=t[e][1];if(i instanceof THREE.Box3Helper){var r=this.shadow.camera,a=new THREE.Vector3(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),n=new THREE.Vector3(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z);i.box.set(a,n),i.updateMatrixWorld(!0)}}},i.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.userData.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.userData.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e);this.update()},i.updateWorldMatrix=function(e,t){var i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.userData.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.userData.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),!0===t)for(var r=this.children,a=0,n=r.length;a<n;a++)r[a].updateWorldMatrix(!1,!0)},i.attach=function(e){var t=new THREE.Matrix4;return this.updateWorldMatrix(!0,!1),t.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),t.multiply(e.parent.matrixWorld)),void 0!==e.userData.hiddenMatrix?e.userData.hiddenMatrix.premultiply(t):e.applyMatrix4(t),e.updateWorldMatrix(!1,!1),this.add(e),this},i.computeSingleBoundingBox=function(){this.singleBoundingBox||(this.singleBoundingBox=new SPE.Box3),this.singleBoundingBox.setFromObjectSize(this,!1),this.singleBoundingBox.computeVertices(),this.singleBoundingBox.computeEdges()},i.computeComplexBoundingBox=function(e){this.complexBoundingBox||(this.complexBoundingBox=new SPE.Box3),this.complexBoundingBox.setFromObjectSize(this,e)},i.raycast=function(e,t){this.objectHelper.raycast(e,t)},i.copy=function(t,i){var r=t.children;if(t.children=[],e.prototype.copy.call(this,t),t.children=r,this.userDataFromJson(this.userData),void 0!==t.enableHelper&&(this.enableHelper=t.enableHelper),void 0!==t.objectHelper&&(this.objectHelper.visible=t.objectHelper.visible),void 0!==t.interaction&&this.interaction.copy(t.interaction),!0===i)for(var a=0,n=r.length;a<n;++a){var o=t.children[a];!0===o.userData.isEntity&&this.add(o.clone())}return this},i.traverseEntity=function(e){!function t(i){if(i.userData.isEntity){e(i);for(var r=i.children,a=0,n=r.length;a<n;++a)t(r[a])}}(this)},i.userDataFromJson=function(e){this.userData=e,this.userData.positionToCenter=new THREE.Vector3,void 0!==e.hiddenMatrix&&(this.userData.hiddenMatrix=(new THREE.Matrix4).fromArray(e.hiddenMatrix.elements)),void 0===e.lock&&(this.userData.lock=!1)},i.toJSON=function(t){var i=this.userData;delete this.userData;var r=e.prototype.toJSON.call(this,t);return r.object.userData={type:SPE.LightPoint.name,isEntity:i.isEntity,lock:i.lock,scaleLock:i.scaleLock,hiddenMatrix:{elements:i.hiddenMatrix.toArray()}},r.object.enableHelper=this.enableHelper,r.object.interaction=this.interaction.toJSON(t),this.userData=i,r},_createClass(t,[{key:"hiddenMatrix",get:function(){return this.userData.hiddenMatrix},set:function(e){this.userData.hiddenMatrix.copy(e)}},{key:"geometryHelper",get:function(){return SPE.PointLightHelper.geometryHelper}},{key:"gizmos",get:function(){return this._gizmos}},{key:"visibility",set:function(e){this.visible=e,this.objectHelper.visible=e;for(var t=0,i=this.children.length;t<i;++t)void 0!==this.children[t].traverseEntity&&this.children[t].traverseEntity((function(t){void 0!==t.objectHelper&&!0===t.visible&&(t.objectHelper.visible=e)}))},get:function(){return this.visible}}]),t}(THREE.PointLight),SPE.LightDirectional=function(e){function t(t,i){var r;(r=e.call(this,t,i)||this).shadow.mapSize.width=1024,r.shadow.mapSize.height=1024,r.userData={type:SPE.LightDirectional.name,isEntity:!0,lock:!1,scaleLock:!1,hiddenMatrix:new THREE.Matrix4},r.enableHelper=!1,r.objectHelper=new SPE.DirectionalLightHelper(_assertThisInitialized(r)),r.interaction=new Interaction(_assertThisInitialized(r)),r._gizmos={};var a=r.shadow.camera;a.top=1250,a.bottom=-1250,a.right=1250,a.left=-1250,a.near=1,a.far=2500;var n=new THREE.CameraHelper(r.shadow.camera);return n.visible=!1,r._gizmos.shadowmap=n,r.update(),r}_inheritsLoose(t,e);var i=t.prototype;return i.showGizmos=function(){for(var e=0,t=Object.entries(this._gizmos);e<t.length;e++){var i=t[e][1];i instanceof THREE.CameraHelper&&(i.visible=!0)}},i.hideGizmos=function(){for(var e=0,t=Object.entries(this._gizmos);e<t.length;e++){var i=t[e][1];i instanceof THREE.CameraHelper&&(i.visible=!1)}},i.update=function(){this.shadow.camera.updateProjectionMatrix();for(var e=0,t=Object.entries(this._gizmos);e<t.length;e++){var i=t[e][1];i instanceof THREE.CameraHelper&&i.update()}},i.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.userData.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.userData.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0),!0===this.enableHelper&&this.objectHelper.update();for(var t=this.children,i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)},i.updateWorldMatrix=function(e,t){var i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.userData.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.userData.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),!0===t)for(var r=this.children,a=0,n=r.length;a<n;a++)r[a].updateWorldMatrix(!1,!0)},i.attach=function(e){var t=new THREE.Matrix4;return this.updateWorldMatrix(!0,!1),t.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),t.multiply(e.parent.matrixWorld)),void 0!==e.userData.hiddenMatrix?e.userData.hiddenMatrix.premultiply(t):e.applyMatrix4(t),e.updateWorldMatrix(!1,!1),this.add(e),this},i.computeSingleBoundingBox=function(){this.singleBoundingBox||(this.singleBoundingBox=new SPE.Box3),this.singleBoundingBox.setFromObjectSize(this,!1),this.singleBoundingBox.computeVertices(),this.singleBoundingBox.computeEdges()},i.computeComplexBoundingBox=function(e){this.complexBoundingBox||(this.complexBoundingBox=new SPE.Box3),this.complexBoundingBox.setFromObjectSize(this,e)},i.raycast=function(e,t){this.objectHelper.raycast(e,t)},i.copy=function(t,i){var r=t.children;if(t.children=[],e.prototype.copy.call(this,t),t.children=r,this.userDataFromJson(this.userData),void 0!==t.enableHelper&&(this.enableHelper=t.enableHelper),void 0!==t.objectHelper&&(this.objectHelper.visible=t.objectHelper.visible),void 0!==t.interaction&&this.interaction.copy(t.interaction),!0===i)for(var a=0,n=r.length;a<n;++a){var o=t.children[a];!0===o.userData.isEntity&&this.add(o.clone())}return this},i.traverseEntity=function(e){!function t(i){if(i.userData.isEntity){e(i);for(var r=i.children,a=0,n=r.length;a<n;++a)t(r[a])}}(this)},i.userDataFromJson=function(e){this.userData=e,void 0!==e.hiddenMatrix&&(this.userData.hiddenMatrix=(new THREE.Matrix4).fromArray(e.hiddenMatrix.elements)),void 0===e.lock&&(this.userData.lock=!1)},i.toJSON=function(t){var i=this.userData;delete this.userData;var r=e.prototype.toJSON.call(this,t);return r.object.userData={type:SPE.LightDirectional.name,isEntity:i.isEntity,lock:i.lock,scaleLock:i.scaleLock,hiddenMatrix:{elements:i.hiddenMatrix.toArray()}},r.object.enableHelper=this.enableHelper,r.object.interaction=this.interaction.toJSON(t),this.userData=i,r},_createClass(t,[{key:"hiddenMatrix",get:function(){return this.userData.hiddenMatrix},set:function(e){this.userData.hiddenMatrix.copy(e)}},{key:"geometryHelper",get:function(){return SPE.DirectionalLightHelper.geometryHelper}},{key:"gizmos",get:function(){return this._gizmos}},{key:"visibility",set:function(e){this.visible=e,this.objectHelper.visible=e;for(var t=0,i=this.children.length;t<i;++t)void 0!==this.children[t].traverseEntity&&this.children[t].traverseEntity((function(t){void 0!==t.objectHelper&&!0===t.visible&&(t.objectHelper.visible=e)}))},get:function(){return this.visible}}]),t}(THREE.DirectionalLight),SPE.SpotLightHelper=function(e){function t(t,i){var r;return void 0===i&&(i=6710886),(r=e.call(this,t,i)||this).isObjectHelper=!0,r.name="SpotLightHelper: "+t.uuid,r}_inheritsLoose(t,e);var i=t.prototype;return i.update=function(){var e=SPE.SpotLightHelper._vector,t=this.light.distance?this.light.distance:1e3,i=t*Math.tan(this.light.angle);this.cone.scale.set(i,i,t),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},i.raycast=function(e,t){var i=SPE.SpotLightHelper._ray,r=SPE.SpotLightHelper._sphere,a=SPE.SpotLightHelper._inverseMatrix,n=SPE.SpotLightHelper.geometryHelper,o=this.light.matrixWorld;if(null===n.boundingSphere&&n.computeBoundingSphere(),r.copy(n.boundingSphere),r.applyMatrix4(o),!1!==e.ray.intersectsSphere(r)&&(a.getInverse(o),i.copy(e.ray).applyMatrix4(a),null===n.boundingBox||!1!==i.intersectsBox(n.boundingBox))){var s,h,l,d,c,m,u=n.index,p=n.attributes.position,f=n.drawRange;for(c=Math.max(0,f.start),m=Math.min(u.count,f.start+f.count);c<m;c+=3)h=u.getX(c),l=u.getX(c+1),d=u.getX(c+2),(s=v(this.light,e,i,p,h,l,d))&&(s.faceIndex=Math.floor(c/3),t.push(s))}function v(e,t,i,r,a,n,o){var s=new THREE.Vector3,h=new THREE.Vector3,l=new THREE.Vector3,d=new THREE.Vector3,c=new THREE.Vector3;if(s.fromBufferAttribute(r,a),h.fromBufferAttribute(r,n),l.fromBufferAttribute(r,o),null===i.intersectTriangle(s,h,l,!1,d))return null;c.copy(d),c.applyMatrix4(e.matrixWorld);var m=t.ray.origin.distanceTo(c);return m<t.near||m>t.far?null:{distance:m,point:c.clone(),object:e}}},t}(THREE.SpotLightHelper),SPE.SpotLightHelper._vector=new THREE.Vector3,SPE.SpotLightHelper._ray=new THREE.Ray,SPE.SpotLightHelper._sphere=new THREE.Sphere,SPE.SpotLightHelper._inverseMatrix=new THREE.Matrix4,SPE.SpotLightHelper.geometryHelper=new THREE.BoxBufferGeometry(30,30,30),SPE.PointLightHelper=function(e){function t(t,i,r){var a;return void 0===i&&(i=15),void 0===r&&(r=6710886),(a=e.call(this,t,i,r)||this).isObjectHelper=!0,a.name="PointLightHelper: "+t.uuid,a}return _inheritsLoose(t,e),t.prototype.raycast=function(e,t){var i=SPE.PointLightHelper._ray,r=SPE.PointLightHelper._sphere,a=SPE.PointLightHelper._inverseMatrix,n=SPE.PointLightHelper.geometryHelper,o=this.light.matrixWorld;if(null===n.boundingSphere&&n.computeBoundingSphere(),r.copy(n.boundingSphere),r.applyMatrix4(o),!1!==e.ray.intersectsSphere(r)&&(a.getInverse(o),i.copy(e.ray).applyMatrix4(a),null===n.boundingBox||!1!==i.intersectsBox(n.boundingBox))){var s,h,l,d,c,m,u=n.index,p=n.attributes.position,f=n.drawRange;for(c=Math.max(0,f.start),m=Math.min(u.count,f.start+f.count);c<m;c+=3)h=u.getX(c),l=u.getX(c+1),d=u.getX(c+2),(s=v(this.light,e,i,p,h,l,d))&&(s.faceIndex=Math.floor(c/3),t.push(s))}function v(e,t,i,r,a,n,o){var s=new THREE.Vector3,h=new THREE.Vector3,l=new THREE.Vector3,d=new THREE.Vector3,c=new THREE.Vector3;if(s.fromBufferAttribute(r,a),h.fromBufferAttribute(r,n),l.fromBufferAttribute(r,o),null===i.intersectTriangle(s,h,l,!1,d))return null;c.copy(d),c.applyMatrix4(e.matrixWorld);var m=t.ray.origin.distanceTo(c);return m<t.near||m>t.far?null:{distance:m,point:c.clone(),object:e}}},t}(THREE.PointLightHelper),SPE.PointLightHelper._ray=new THREE.Ray,SPE.PointLightHelper._sphere=new THREE.Sphere,SPE.PointLightHelper._inverseMatrix=new THREE.Matrix4,SPE.PointLightHelper.geometryHelper=new THREE.BoxBufferGeometry(30,30,30),SPE.DirectionalLightHelper=function(e){function t(t,i,r){var a;return void 0===i&&(i=15),void 0===r&&(r=10066329),(a=e.call(this,t,i,r)||this).isObjectHelper=!0,a.name="DirectionalLightHelper: "+t.uuid,a}return _inheritsLoose(t,e),t.prototype.raycast=function(e,t){var i=SPE.DirectionalLightHelper._ray,r=SPE.DirectionalLightHelper._sphere,a=SPE.DirectionalLightHelper._inverseMatrix,n=SPE.DirectionalLightHelper.geometryHelper,o=this.light.matrixWorld;if(null===n.boundingSphere&&n.computeBoundingSphere(),r.copy(n.boundingSphere),r.applyMatrix4(o),!1!==e.ray.intersectsSphere(r)&&(a.getInverse(o),i.copy(e.ray).applyMatrix4(a),null===n.boundingBox||!1!==i.intersectsBox(n.boundingBox))){var s,h,l,d,c,m,u=n.index,p=n.attributes.position,f=n.drawRange;for(c=Math.max(0,f.start),m=Math.min(u.count,f.start+f.count);c<m;c+=3)h=u.getX(c),l=u.getX(c+1),d=u.getX(c+2),(s=v(this.light,e,i,p,h,l,d))&&(s.faceIndex=Math.floor(c/3),t.push(s))}function v(e,t,i,r,a,n,o){var s=new THREE.Vector3,h=new THREE.Vector3,l=new THREE.Vector3,d=new THREE.Vector3,c=new THREE.Vector3;if(s.fromBufferAttribute(r,a),h.fromBufferAttribute(r,n),l.fromBufferAttribute(r,o),null===i.intersectTriangle(s,h,l,!1,d))return null;c.copy(d),c.applyMatrix4(e.matrixWorld);var m=t.ray.origin.distanceTo(c);return m<t.near||m>t.far?null:{distance:m,point:c.clone(),object:e}}},t}(THREE.DirectionalLightHelper),SPE.DirectionalLightHelper._ray=new THREE.Ray,SPE.DirectionalLightHelper._sphere=new THREE.Sphere,SPE.DirectionalLightHelper._inverseMatrix=new THREE.Matrix4,SPE.DirectionalLightHelper.geometryHelper=new THREE.BoxBufferGeometry(30,30,30),SPE.Raycaster=function(e){function t(){return e.apply(this,arguments)||this}_inheritsLoose(t,e);var i=t.prototype;return i.setFromCamera=function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},i.createRaycastLineHelper=function(){var e=new THREE.LineBasicMaterial({color:16711680,linewidth:10}),t=new THREE.Geometry,i=new THREE.Vector3(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new THREE.Vector3(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),a=(new THREE.Vector3).lerpVectors(i,r,.5);return r.multiplyScalar(0),t.vertices.push(i),t.vertices.push(a),t.vertices.push(r),new THREE.Line(t,e)},t}(THREE.Raycaster),SPE.Box3=function(e,t){THREE.Box3.call(this,e,t),this.transform=new THREE.Matrix4},SPE.Box3.prototype=Object.create(THREE.Box3.prototype),SPE.Box3.prototype.constructor=SPE.Box3,SPE.Box3.prototype.setFromObjectSize=function(e,t){e.updateWorldMatrix(!1,!1),this.makeEmpty(),this.transform=e.matrixWorld;var i=(new THREE.Matrix4).getInverse(e.matrixWorld);return this.expandByObjectSize(e,i,t)},SPE.Box3.prototype.expandByObjectSize=function(){var e,t,i,r=new THREE.Vector3,a=new THREE.Matrix4,n=new THREE.Box3,o=new THREE.Vector3;function s(s){if(void 0!==s.geometry){var h=s.geometry.userData.parameters;n.setFromArray(s.geometry.getAttribute("position").array),n.getCenter(o),r.set(h.width,h.height,h.depth).multiplyScalar(.5)}else void 0!==s.geometryHelper&&!0===i?(n.setFromArray(s.geometryHelper.getAttribute("position").array),n.getCenter(o),n.getSize(r).multiplyScalar(.5)):(o.setScalar(0),r.setScalar(0));a.copy(e).multiply(s.matrixWorld),s.userData.positionToCenter=o,0===r.x&&0===r.y&&0===r.z?t.push(new THREE.Vector3(o.x,o.y,o.z).applyMatrix4(a)):t.push(new THREE.Vector3(-r.x,r.y,r.z).add(o).applyMatrix4(a),new THREE.Vector3(-r.x,-r.y,r.z).add(o).applyMatrix4(a),new THREE.Vector3(r.x,-r.y,r.z).add(o).applyMatrix4(a),new THREE.Vector3(r.x,r.y,r.z).add(o).applyMatrix4(a),new THREE.Vector3(-r.x,r.y,-r.z).add(o).applyMatrix4(a),new THREE.Vector3(-r.x,-r.y,-r.z).add(o).applyMatrix4(a),new THREE.Vector3(r.x,-r.y,-r.z).add(o).applyMatrix4(a),new THREE.Vector3(r.x,r.y,-r.z).add(o).applyMatrix4(a))}return function(r,a,n){return e=a,i=r.enableHelper,t=[],!0===n?(r.traverseEntity(s),this.setFromPoints(t)):(s(r),this.setFromPoints(t)),this}}(),SPE.Box3.prototype.getCenter=function(e){return(e=THREE.Box3.prototype.getCenter.call(this,e)).applyMatrix4(this.transform),e},SPE.Box3.prototype.setFromObject=function(e,t){return this.makeEmpty(),this.expandByObject(e,t)},SPE.Box3.prototype.expandByObject=function(){var e,t,i,r,a=new THREE.Vector3;function n(n){var o=n.geometry;if(void 0!==o)if(o.isGeometry){var s=o.vertices;for(t=0,i=s.length;t<i;t++)a.copy(s[t]),a.applyMatrix4(n.matrixWorld),void 0!==r&&a.applyMatrix4(r),e.expandByPoint(a)}else if(o.isBufferGeometry){var h=o.attributes.position;if(void 0!==h)for(t=0,i=h.count;t<i;t++)a.fromBufferAttribute(h,t).applyMatrix4(n.matrixWorld),void 0!==r&&a.applyMatrix4(r),e.expandByPoint(a)}}return function(t,i){return e=this,t.updateMatrixWorld(!0),r=i,t.traverse(n),this}}(),SPE.Box3.prototype.computeVertices=function(){var e=this.getSize(new THREE.Vector3).multiplyScalar(.5),t=this.getCenter(new THREE.Vector3),i=(new THREE.Matrix4).copy(this.transform).setPosition(t);this.vertices=[new THREE.Vector3(-e.x,e.y,e.z).applyMatrix4(i),new THREE.Vector3(-e.x,-e.y,e.z).applyMatrix4(i),new THREE.Vector3(e.x,-e.y,e.z).applyMatrix4(i),new THREE.Vector3(e.x,e.y,e.z).applyMatrix4(i),new THREE.Vector3(-e.x,e.y,-e.z).applyMatrix4(i),new THREE.Vector3(-e.x,-e.y,-e.z).applyMatrix4(i),new THREE.Vector3(e.x,-e.y,-e.z).applyMatrix4(i),new THREE.Vector3(e.x,e.y,-e.z).applyMatrix4(i)]},SPE.Box3.prototype.computeEdges=function(){this.vertices||this.computeVertices(),this.edges=[(new THREE.Line3).set(this.vertices[0],this.vertices[3]),(new THREE.Line3).set(this.vertices[1],this.vertices[2]),(new THREE.Line3).set(this.vertices[5],this.vertices[6]),(new THREE.Line3).set(this.vertices[4],this.vertices[7]),(new THREE.Line3).set(this.vertices[0],this.vertices[1]),(new THREE.Line3).set(this.vertices[3],this.vertices[2]),(new THREE.Line3).set(this.vertices[7],this.vertices[6]),(new THREE.Line3).set(this.vertices[4],this.vertices[5]),(new THREE.Line3).set(this.vertices[0],this.vertices[4]),(new THREE.Line3).set(this.vertices[1],this.vertices[5]),(new THREE.Line3).set(this.vertices[2],this.vertices[6]),(new THREE.Line3).set(this.vertices[3],this.vertices[7])]},SPE.Box3.prototype.computeFaces=function(){this.vertices||this.computeVertices(),this.faces=[(new THREE.Vector3).copy(this.vertices[0]).sub(this.vertices[2]).multiplyScalar(.5).add(this.vertices[2]),(new THREE.Vector3).copy(this.vertices[3]).sub(this.vertices[6]).multiplyScalar(.5).add(this.vertices[6]),(new THREE.Vector3).copy(this.vertices[7]).sub(this.vertices[5]).multiplyScalar(.5).add(this.vertices[5]),(new THREE.Vector3).copy(this.vertices[4]).sub(this.vertices[1]).multiplyScalar(.5).add(this.vertices[1]),(new THREE.Vector3).copy(this.vertices[0]).sub(this.vertices[7]).multiplyScalar(.5).add(this.vertices[7]),(new THREE.Vector3).copy(this.vertices[1]).sub(this.vertices[6]).multiplyScalar(.5).add(this.vertices[6])]},SPE.Math=function(){function e(){}return e.slerp=function(e,t,i,r){if(0===r)return i.copy(e);if(1===r)return i.copy(t);var a=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(a>=1)return i.copy(e);var n=1-a*a;if(n<=Number.EPSILON){var o=1-r;return i.w=o*e.w+r*t.w,i.x=o*e.x+r*t.x,i.y=o*e.y+r*t.y,i.z=o*e.z+r*t.z,i.normalize(),i}var s=Math.sqrt(n),h=Math.atan2(s,a),l=Math.sin((1-r)*h)/s,d=Math.sin(r*h)/s;return i.w=e.w*l+t.w*d,i.x=e.x*l+t.x*d,i.y=e.y*l+t.y*d,i.z=e.z*l+t.z*d,i},e.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)},e.getProjection=function(e,t,i){var r=e.clone().sub(t),a=i.clone().sub(t),n=t.distanceTo(i);return r.dot(a)/n},e.projectOnVector=function(e,t){return e.clone().dot(t)/t.length()},e.angle2D=function(e,t,i,r,a){void 0===a&&(a=!1);var n=i-e,o=r-t,s=Math.atan2(o,n);return s*=180/Math.PI,a&&s<0&&(s=360+s),s},e.angle3D=function(e,t,i){var r=e.clone().sub(t),a=i.clone().sub(t),n=t.distanceTo(e),o=t.distanceTo(i),s=r.dot(a)/(n*o);return Math.acos(s)},e.rotatePosition2D=function(e,t,i){return{x:e*Math.cos(i)-t*Math.sin(i),y:e*Math.sin(i)+t*Math.cos(i),z:0}},e.rotatePosition3D=function(e,t){return e.clone().applyMatrix3(SPE.Math.getRotateMatrix(t.x,t.y,t.z))},e.getRotateMatrix=function(e,t,i){var r=new THREE.Matrix3,a=new THREE.Matrix3,n=new THREE.Matrix3;return r.set(1,0,0,0,Math.cos(e),-Math.sin(e),0,Math.sin(e),Math.cos(e)),a.set(Math.cos(t),0,Math.sin(t),0,1,0,-Math.sin(t),0,Math.cos(t)),n.set(Math.cos(i),-Math.sin(i),0,Math.sin(i),Math.cos(i),0,0,0,1),r.multiply(a).multiply(n)},e.round=function(e,t){var i=(e+"e").split("e");return+((i=(Math.round(i[0]+"e"+(+i[1]+t))+"e").split("e"))[0]+"e"+(+i[1]-t))},e.normalize=function(e,t,i){return(e-t)/(i-t)},e.lerp=function(e,t,i){return(i-t)*e+t},e.map=function(e,t,i,r,a){return SPE.Math.lerp(SPE.Math.normalize(e,t,i),r,a)},e.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},e.getMiddlePointByPerc=function(e,t,i){var r=t.clone().sub(e),a=r.length();return r=r.normalize().multiplyScalar(a*i),e.clone().add(r)},e.getVectorDistanceInFloat=function(e,t){var i=e.x-t.x,r=e.y-t.y,a=e.z-t.z;return Math.sqrt(i*i+r*r+a*a)},e.getVectorDistanceInVector=function(e,t){var i=e.x-t.x,r=e.y-t.y,a=e.z-t.z;return new THREE.Vector3(i,r,a)},e.getObjectSize=function(e){var t=new THREE.Vector3;return e.geometry.computeBoundingBox(),t.x=e.geometry.boundingBox.max.x-e.geometry.boundingBox.min.x,t.y=e.geometry.boundingBox.max.y-e.geometry.boundingBox.min.y,t.z=e.geometry.boundingBox.max.z-e.geometry.boundingBox.min.z,t},e.resetTransform=function(e,t){for(var i=0;i<t.length;i++)"all"==e?(t[i].position.set(0,0,0),t[i].scale.set(1,1,1),t[i].rotation.set(0,0,0)):"scale"==e?t[i].scale.set(1,1,1):t[i].rotation.set(0,0,0),t[i].geometry&&t[i].geometry.computeBoundingBox()},e.containsObject=function(e,t){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1},e.findCentroid=function(e){for(var t=new THREE.Vector3,i=e.length,r=0;r<e.length;r++)t.set(t.x+e[r].position.x,t.y+e[r].position.y,t.z+e[r].position.z);return t.set(t.x/i,t.y/i,t.z/i),t},e.removeFromArray=function(e,t){var i=e.indexOf(t);e.splice(i,1)},e.getPositionRelativeToElement=function(e){var t=e.target.getBoundingClientRect();return{mx:e.clientX-t.left,my:e.clientY-t.top}},e.getElementMousePos=function(e,t){return{mx:t.pageX-e.offset().left,my:t.pageY-e.offset().top}},e.changeColor=function(e,t){for(var i=e.geometry.attributes.color.array,r=3*e.geometry.attributes.color.count,a=1/(t.steps*r),n=new THREE.Color,o=0,s=r;o<s;o++)n.set(makeColorGradient(o,a,t.phase)),i[3*o]=n.r,i[3*o+1]=n.g,i[3*o+2]=n.b;e.geometry.attributes.color.needsUpdate=!0},e.getColoredBufferLine=function(e,t,i){for(var r,a,n,o=i.vertices,s=i.vertices.length,h=new THREE.BufferGeometry,l=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),d=new Float32Array(3*s),c=new Float32Array(3*s),m=1/(e*s),u=new THREE.Color,p=0,f=s;p<f;p++)r=o[p].x,a=o[p].y,n=o[p].z,d[3*p]=r,d[3*p+1]=a,d[3*p+2]=n,u.set(makeColorGradient(p,m,t)),c[3*p]=u.r,c[3*p+1]=u.g,c[3*p+2]=u.b;return h.setAttribute("position",new THREE.BufferAttribute(d,3)),h.setAttribute("color",new THREE.BufferAttribute(c,3)),new THREE.Line(h,l)},e.makeColorGradient=function(e,t,i){var r,a,n;a=n=r=t;var o=i+2,s=i+4,h=127*Math.sin(r*e+i)+128,l=127*Math.sin(a*e+o)+128,d=127*Math.sin(n*e+s)+128;return parseInt("0x"+_byte2Hex(h)+_byte2Hex(l)+_byte2Hex(d))},e._byte2Hex=function(e){return String("0123456789ABCDEF".substr(e>>4&15,1))+"0123456789ABCDEF".substr(15&e,1)},e.drawBezierTangent=function(e,t){var i=new THREE.LineCurve3(e,t).getPoints(1),r=(new THREE.BufferGeometry).setFromPoints(i);return new THREE.Line(r,new THREE.LineBasicMaterial({color:16711680}))},e.fixUvs=function(e,t,i){for(var r=0;r<e.attributes.uv.array.length;r+=2)e.attributes.uv.array[r]=(e.attributes.uv.array[r]+t/2)/t,e.attributes.uv.array[r+1]=1-(e.attributes.uv.array[r+1]-i/2)/i*-1},e.flattenArray=function(e){return[].concat.apply([],e)},e.sortNumber=function(e,t){return e-t},e.swapArrayValues=function(e,t,i){var r=e[t];e[t]=e[i],e[i]=r},e}();var Spline=function(e){var t=e.scene,i=e.assets;return React.useEffect((function(){new SpeRuntime(t,i).run()}),[]),React.createElement("div",null,React.createElement("div",{className:styles.container},React.createElement("canvas",{id:"canvas3d",className:styles.canvas})))};exports.Spline=Spline},function(e,t,i){e.exports=i(15)},function(e,t,i){},,,,,,,function(e,t,i){},,function(e,t,i){"use strict";i.r(t);i(6);var r=i(0),a=i.n(r),n=i(3),o=i.n(n),s=i(4),h=(i(13),{scenes:[{nodes:[0]}],nodes:[{children:[1,2,3,4,5]},{mesh_spe:0,material:0,spe_interaction:0,translation:[108.58256344645109,-42.482460661839525,172.5],rotation:[0,0,0,1],scale:[1,1,1],visible:!0,castShadow:!0,receiveShadow:!0,hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],type:"mesh3d",uuid:"56ABFF8B-4152-4C65-8E57-BA69A53A9A5E",spe_cloner_data:{}},{mesh_spe:1,material:1,spe_interaction:1,translation:[34.64250642942969,140.82499362714555,80.1500374233705],rotation:[.24618736774241246,.17643089399828712,-.04562813161158716,.9519359186482371],scale:[1,.9999999999999999,.9999999999999999],visible:!0,castShadow:!0,receiveShadow:!0,hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],type:"mesh3d",uuid:"A15172CF-2A64-40D8-B05A-772FCE5B7B10",spe_cloner_data:{}},{mesh_spe:2,material:2,spe_interaction:2,translation:[-263.8408931932238,133.31856454477858,38.91858174876785],rotation:[-.16985354835670552,-.20712052406394216,.018120697839143284,.9632873407929415],scale:[1,1,1],visible:!0,castShadow:!0,receiveShadow:!0,hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,39.81212308246242,-70.91606776844856,-114.5243921098042,1],type:"mesh3d",uuid:"D92BCEE4-E54A-45B0-8C63-099287EF12E6",spe_cloner_data:{}},{visible:!0,extensions:{KHR_lights_punctual:{light:0}}},{spe_interaction:3,camera:0,translation:[-3.351862717946322e-270,6123233995736766e-29,1e3],rotation:[-3061616997868383e-32,-1675931358973161e-288,-5.131059935892888e-290,1],hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],visible:!0,uuid:"EF8458A6-8C44-4803-B149-0C5DFDD67120",children:[6]},{spe_interaction:null,translation:[85e4,13e5,1e6],rotation:[0,0,.5,0],hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],uuid:"229E126E-D9AB-4DF5-8B22-899E99D7E7A6",visible:!0,extensions:{KHR_lights_punctual:{light:1}}}],meshes:[],meshes_spe:[{type:"PyramidGeometry",parameters:{width:345,height:345,depth:345,radialSegments:4,heightSegments:1,cornerRadius:33,cornerSegments:8}},{type:"SphereGeometry",parameters:{width:234,height:234,depth:234,widthSegments:64,heightSegments:64}},{type:"CubeGeometry",parameters:{width:134,height:134,depth:134,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:30,cornerSegments:8}}],materials:[{material_0_Phong:{extensions:{KHR_materials_common:{technique:"PHONG",values:{ambient:[1,.36470588235294116,.6666666666666666],diffuse:[1,.36470588235294116,.6666666666666666],specular:[.06666666666666667,.06666666666666667,.06666666666666667],shininess:30,emission:[0,0,0],transparent:!0,transparency:1}}},spe_options:{side:0,wireframe:!1,flatShading:!1,visible:!0},spe_layers:[{type:"color",uniforms:{alpha:{name:"alpha",value:1,type:1},mode:{name:"mode",value:0,type:1},color:{name:"color",value:16735658,type:6}}},{type:"light",uniforms:{alpha:{name:"alpha",value:1,type:1},mode:{name:"mode",value:0,type:1}}}]}},{material_1_Lambert:{extensions:{KHR_materials_common:{technique:"LAMBERT",values:{ambient:[.34901960784313724,.34901960784313724,.34901960784313724],diffuse:[.34901960784313724,.34901960784313724,.34901960784313724],emission:[0,0,0],transparent:!0,transparency:1}}},spe_options:{side:0,wireframe:!1,flatShading:!1,visible:!0},spe_layers:[{type:"color",uniforms:{alpha:{name:"alpha",value:1,type:1},mode:{name:"mode",value:0,type:1},color:{name:"color",value:9109759,type:6}}},{type:"light",uniforms:{alpha:{name:"alpha",value:1,type:1},mode:{name:"mode",value:0,type:1}}}]}},{material_2_Phong:{extensions:{KHR_materials_common:{technique:"PHONG",values:{ambient:[.06666666666666667,.06666666666666667,.06666666666666667],diffuse:[.06666666666666667,.06666666666666667,.06666666666666667],specular:[.06666666666666667,.06666666666666667,.06666666666666667],shininess:30,emission:[0,0,0],transparent:!0,transparency:1}}},spe_options:{side:0,wireframe:!1,flatShading:!1,visible:!0},spe_layers:[{type:"color",uniforms:{alpha:{name:"alpha",value:1,type:1},mode:{name:"mode",value:0,type:1},color:{name:"color",value:16777215,type:6}}},{type:"light",uniforms:{alpha:{name:"alpha",value:1,type:1},mode:{name:"mode",value:0,type:1}}}]}}],cameras:[{type:"Orthographic",orthographic:{xmag:1522,ymag:787,zfar:1e5,znear:-5e4},spe_options:{zoom:1}}],buffers:[],bufferViews:[],accessors:[],extensions:{KHR_lights_punctual:{lights:[{type:"hemispheric",name:"SceneLightAmbientDefault",color:[.8274509803921568,.8274509803921568,.8274509803921568],intensity:.75},{type:"directional",name:"SceneLightDirectionalDefault",color:[1,1,1],intensity:.75,shadows:{castShadow:!1,shadowmapViewRight:5,shadowmapViewLeft:-5,shadowmapViewTop:5,shadowmapViewBottom:-5,shadowmapViewNear:.5,shadowmapViewFar:500}}]}},spline:{interactions:[{uuid:"FE1A4648-A4B4-4F44-80FE-3E0C2DDF39DF",selectedState:0,states:["127E70BE-0753-450F-9EFF-383E40084911","240FA9BD-57ED-4707-9D9C-C0B52EE1C725"],events:[{type:7,ui:{isCollapsed:!1},targets:[{easing:4,duration:1e3,delay:0,cubicControls:[.5,.05,.1,.3],springParameters:{mass:1,stiffness:80,damping:10,velocity:0},repeat:!0,cycle:!0,rewind:!1,object:"56ABFF8B-4152-4C65-8E57-BA69A53A9A5E",state:"240FA9BD-57ED-4707-9D9C-C0B52EE1C725"}]}]},{uuid:"16001634-0C31-49A2-A2A1-1D472D6CEBF2",selectedState:1,states:["D930D406-8E56-41F2-A23E-4EE55FD1B1B8","8A00D918-4D2B-4B06-829D-B8FF0F8C74F1"],events:[{type:7,ui:{isCollapsed:!1},targets:[{easing:4,duration:1e3,delay:0,cubicControls:[.5,.05,.1,.3],springParameters:{mass:1,stiffness:80,damping:10,velocity:0},repeat:!0,cycle:!0,rewind:!1,object:"A15172CF-2A64-40D8-B05A-772FCE5B7B10",state:"8A00D918-4D2B-4B06-829D-B8FF0F8C74F1"}]}]},{uuid:"80182234-3E63-4C4D-9F42-3F56F09373E3",selectedState:0,states:["E331C32B-2DEA-42C7-9D8B-B4022E736A52","822AA811-1525-4CC8-9A4F-5E34FEC44783"],events:[{type:7,ui:{isCollapsed:!1},targets:[{easing:4,duration:1e3,delay:0,cubicControls:[.5,.05,.1,.3],springParameters:{mass:1,stiffness:80,damping:10,velocity:0},repeat:!0,cycle:!0,rewind:!1,object:"D92BCEE4-E54A-45B0-8C63-099287EF12E6",state:"822AA811-1525-4CC8-9A4F-5E34FEC44783"}]}]},{uuid:"18BEE416-9E3E-4CB3-B9F7-0E58FCEC5495"}],interactionStates:{"127E70BE-0753-450F-9EFF-383E40084911":{uuid:"127E70BE-0753-450F-9EFF-383E40084911",name:"Base State",position:[108.58256344645109,-42.482460661839525,172.5],rotation:[0,0,0,"XYZ"],scale:[1,1,1],hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],geometry:{width:345,height:345,depth:345},material:{layersList:[{id:0,type:"color",defines:{},uniforms:{f0_alpha:{value:1},f0_mode:{value:0},f0_color:{value:16735658}}},{id:1,type:"light",defines:{},uniforms:{f1_alpha:{value:1},f1_mode:{value:0}}}]}},"240FA9BD-57ED-4707-9D9C-C0B52EE1C725":{uuid:"240FA9BD-57ED-4707-9D9C-C0B52EE1C725",name:"State 1",position:[62.315010667671174,-98.29470476621546,172.1630890071301],rotation:[-3795096073784796e-32,.7504915783575619,-.15707963267948966,"XYZ"],scale:[1,1,1],hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],geometry:{width:345,height:345,depth:345},material:{layersList:[{id:0,type:"color",defines:{},uniforms:{f0_alpha:{value:1},f0_mode:{value:0},f0_color:{value:16735658}}},{id:1,type:"light",defines:{},uniforms:{f1_alpha:{value:1},f1_mode:{value:0}}}]}},"D930D406-8E56-41F2-A23E-4EE55FD1B1B8":{uuid:"D930D406-8E56-41F2-A23E-4EE55FD1B1B8",name:"Base State",position:[-5.068700688388603,191.12387874041767,79.94464607108893],rotation:[0,0,0,"XYZ"],scale:[1,1,1],hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],geometry:{width:160,height:160,depth:160},material:{layersList:[{id:0,type:"color",defines:{},uniforms:{f0_alpha:{value:1},f0_mode:{value:0},f0_color:{value:9109759}}},{id:1,type:"light",defines:{},uniforms:{f1_alpha:{value:1},f1_mode:{value:0}}}]}},"8A00D918-4D2B-4B06-829D-B8FF0F8C74F1":{uuid:"8A00D918-4D2B-4B06-829D-B8FF0F8C74F1",name:"State 1",position:[34.64250642942969,140.82499362714555,80.1500374233705],rotation:[.5358078113547309,.31880886592626434,-.18399609928796778,"XYZ"],scale:[1,1,1],hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],geometry:{width:234,height:234,depth:234},material:{layersList:[{id:0,type:"color",defines:{},uniforms:{f0_alpha:{value:1},f0_mode:{value:0},f0_color:{value:9109759}}},{id:1,type:"light",defines:{},uniforms:{f1_alpha:{value:1},f1_mode:{value:0}}}]}},"E331C32B-2DEA-42C7-9D8B-B4022E736A52":{uuid:"E331C32B-2DEA-42C7-9D8B-B4022E736A52",name:"Base State",position:[-263.8408931932238,133.31856454477858,38.91858174876785],rotation:[-.3572764720484582,-.4171854286174076,-.03878477760198327,"XYZ"],scale:[1,1,1],hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,39.81212308246242,-70.91606776844856,-114.5243921098042,1],geometry:{width:134,height:134,depth:134},material:{layersList:[{id:0,type:"color",defines:{},uniforms:{f0_alpha:{value:1},f0_mode:{value:0},f0_color:{value:16777215}}},{id:1,type:"light",defines:{},uniforms:{f1_alpha:{value:1},f1_mode:{value:0}}}]}},"822AA811-1525-4CC8-9A4F-5E34FEC44783":{uuid:"822AA811-1525-4CC8-9A4F-5E34FEC44783",name:"State 1",position:[-263.8408931932238,133.31856454477858,38.91858174876785],rotation:[-1.1031469626258799,-.03835430785747176,1.0297442586766545,"XYZ"],scale:[1,1,1],hiddenMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,39.81212308246242,-70.91606776844856,-114.5243921098042,1],geometry:{width:134,height:134,depth:134},material:{layersList:[{id:0,type:"color",defines:{},uniforms:{f0_alpha:{value:1},f0_mode:{value:0},f0_color:{value:16777215}}},{id:1,type:"light",defines:{},uniforms:{f1_alpha:{value:1},f1_mode:{value:0}}}]}}},textures:{},images:{},mainCameraIndex:5,usePrimitives:!0,bgColor:[1,1,1],bgAlpha:0,orbitDamped:!0,orbitTarget:[0,0,0],cameraType:"Orthographic",cameraRotate:!0,cameraPan:!0,cameraZoom:!1,viewMode:1,viewWidth:512,viewHeight:512,quality:"default",useOrbitControls:!0}}),l={fonts:[],images:[],models:[],animations:[]},d=function(){return a.a.createElement("div",null,a.a.createElement("h1",null,"Hi! This is an experiment."),a.a.createElement(s.Spline,{scene:h,assets:l}))};o.a.render(a.a.createElement(d,null),document.getElementById("root"))}],[[5,1,2]]]);
//# sourceMappingURL=main.0d1e5446.chunk.js.map